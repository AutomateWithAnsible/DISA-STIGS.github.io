<?xml version="1.0" encoding="UTF-8"?>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cdf="http://checklists.nist.gov/xccdf/1.1" xmlns:html="http://www.w3.org/1999/xhtml">
  <head>
    <style>
			body {
				font-family: veranda,sans-serif;
				font-size: 13px;
				margin-left: 0px;
			}

			div.content {
				position: relative;
				padding-bottom: 20px;
			}

			@page {
				size: 8.5in 11in;
				margin: 1in;
			}

			@media print
			{
				div.headerfooter {
					position: relative;
				}
			}

			@media screen {
				div.content {
					margin-top: 40px;
					margin-left: 10%;
					margin-right: 10%;
				}
			
				div.headerfooter {
					position: fixed;
					z-index: 1000;
				}
			}

			div.headerfooter {
				background-color: green;
				color: white;
				font-size: 8pt;
				font-weight: bold;
				text-align: center;
				width: 100%;
			}

			div.header {
				top: 0;
			}

			div.footer {
				bottom: 0;
				
			}

			table {
				font-size: 13px;
			}

			table, td, th {
				border: 1px solid black;
				border-collapse: collapse;
				vertical-align: top;
				padding: 5px;
				word-wrap: break-word;
			}

			th {
				font-weight: bold;
			}

			table.ruleblock {
				width: 100%;
				table-layout: fixed;
				border-top: 1px solid black;
				border-left: 1px solid black;
				border-right: 1px solid black;
				border-bottom: 0px;
			}

			td.ruleblock {
				width: 25%;
				font-weight: bold;
				font-size: 15px;
				padding: 5px;
				border-bottom: 0px;
			}
			
			tr.ruleblock {
				border-bottom: 0px;
			}

			span.ruleheader {
				font-size: 10px;
			}

			table.ruledata {
				width: 100%;
				table-layout: fixed;
			}

			th.ruledata {
				width: 15%;
				text-align: left;
				border: none;
			}

			td.ruledata {
				border: none;
			}

			span.rulerequirement {
				font-size: 15px;
				font-weight: bold;
			}

			div.rotate {
				-ms-transform:rotate(270deg); /* IE 9 */
				-moz-transform:rotate(270deg); /* Firefox */
				-webkit-transform:rotate(270deg); /* Safari and Chrome */
				-o-transform:rotate(270deg); /* Opera */
			}
			
			ul.ruledata {
			  list-style-position: inside;
			  padding-left: 0;
			}

		</style>
    <title>(U) VMware vSphere 6.5 vCenter Server for Windows Security Technical Implementation Guide</title>
  </head>
  <body>
    <div class="header headerfooter">UNCLASSIFIED</div>
    <div class="content">
      <div>
        <h1>VMware vSphere 6.5 vCenter Server for Windows Security Technical Implementation Guide</h1>
        <h2>Version 1 Release 3</h2>
        <h3>24 Apr 2020</h3>
      </div>
      <div class="toc">
        <h2>Table of Contents</h2>
        <ul>
          <li>
            <a href="#intro">Introduction</a>
            <br/>
            <ul>
              <li>
                <a href="#summary">Executive Summary</a>
              </li>
              <li>
                <a href="#authority">Authority</a>
              </li>
              <li>
                <a href="#severity">Vulnerability Severity Category Code Definitions</a>
              </li>
              <li>
                <a href="#distribution">STIG Distribution</a>
              </li>
              <li>
                <a href="#compliance">SRG Compliance Reporting</a>
              </li>
              <li>
                <a href="#revisions">Document Revisions</a>
              </li>
              <li>
                <a href="#considerations">Other Considerations</a>
              </li>
              <li>
                <a href="#disclaimer">Product Approval Disclaimer</a>
              </li>
            </ul>
          </li>
          <li>
            <a href="#catalog">Requirement Catalog</a>
            <br/>
            <ul>
              <li>
                <a href="#requirementtable">Table of Requirements</a>
              </li>
              <li>
                <a href="#requirementdetails">Requirement Details</a>
              </li>
            </ul>
          </li>
          <li>Revision History</li>
        </ul>
      </div>
      <div class="intro">
        <a name="intro">
          <h2>Introduction</h2>
        </a>
        <a name="summary">
          <h3>Executive Summary</h3>
        </a>
        <p>
The VMware vSphere 6.5 vCenter Server for Windows Security Technical Implementation Guide is published as a tool to improve the security of the Department of Defense (DoD) information systems.
			</p>
        <a name="authority">
          <h3>Authority</h3>
        </a>
        <p>
DoD Instruction (DoDI) 8500.01 requires that “all IT that receives, processes, stores, displays, 
or transmits DoD information will be […] configured […] consistent with applicable DoD cybersecurity policies, 
standards, and architectures” and tasks that Defense Information Systems Agency (DISA) “develops and maintains 
control correlation identifiers (CCIs), security requirements guides (SRGs), security technical implementation 
guides (STIGs), and mobile code risk categories and usage guides that implement and are consistent with DoD 
cybersecurity policies, standards, architectures, security controls, and validation procedures, with the 
support of the NSA/CSS, using input from stakeholders, and using automation whenever possible.” This document 
is provided under the authority of DoDI 8500.01.
			</p>
        <p>
Although the use of the principles and guidelines in these SRGs/STIGs provides an environment that contributes 
to the security requirements of DoD systems, applicable NIST SP 800-53 cybersecurity controls need to be 
applied to all systems and architectures based on the Committee on National Security Systems (CNSS) Instruction 
(CNSSI) 1253.
			</p>
        <a name="severity">
          <h3>Vulnerability Severity Category Code Definitions</h3>
        </a>
        <p>
				Severity Category Codes (referred to as CAT) are a measure of vulnerabilities used to assess a
facility or system security posture. Each security policy specified in this document is assigned a
Severity Code of CAT I, II, or III.
			</p>
        <table>
          <tr>
            <th/>
            <th>Category Code Guidelines</th>
          </tr>
          <tr>
            <th>CAT I</th>
            <td>
Any vulnerability, the exploitation of which will, directly and immediately result in loss of
Confidentiality, Availability, or Integrity.
					</td>
          </tr>
          <tr>
            <th>CAT II</th>
            <td>Any vulnerability, the exploitation of which has a potential to result in loss of Confidentiality, Availability,
or Integrity.</td>
          </tr>
          <tr>
            <th>CAT III</th>
            <td>Any vulnerability, the existence of which degrades measures to protect against loss of Confidentiality, Availability, or Integrity.</td>
          </tr>
        </table>
        <a name="distribution">
          <h3>STIG Distribution</h3>
        </a>
        <p>
Parties within the DoD and Federal Government’s computing environments can obtain the applicable STIG from the Cyber Exchange website at 
<a href="https://cyber.mil/">https://cyber.mil/</a>. This site contains the latest copies of STIGs, SRGs, and other related security information. 
Those without a Common Access Card (CAC) that has DoD Certificates can obtain the STIG from <a href="https://public.cyber.mil/">https://public.cyber.mil/</a>.
			</p>
        <a name="compliance">
          <h3>SRG Compliance Reporting</h3>
        </a>
        <p>
All technical NIST SP 800-53 requirements were considered while developing this STIG. Requirements that are applicable and configurable 
will be included in the final STIG. A report marked For Official Use Only (FOUO) will be available for those items that did not meet requirements. 
This report will be available to component Authorizing Official (AO) personnel for risk assessment purposes by request via email to: <a href="mailto:disa.stig_spt@mail.mil">disa.stig_spt@mail.mil</a>.
			</p>
        <a name="revisions">
          <h3>Document Revision Process</h3>
        </a>
        <p>
Comments or proposed revisions to this document should be sent via email to the following address: <a href="mailto:disa.stig_spt@mail.mil">disa.stig_spt@mail.mil</a>. 
DISA will coordinate all change requests with the relevant DoD organizations before inclusion in this document. Approved changes will be made in accordance with the DISA maintenance release schedule.
			</p>
        <a name="considerations">
          <h3>Other Considerations</h3>
        </a>
        <p>
DISA accepts no liability for the consequences of applying specific configuration settings made on the basis of the SRGs/STIGs. 
It must be noted that the configuration settings specified should be evaluated in a local, representative test environment before 
implementation in a production environment, especially within large user populations. The extensive variety of environments makes 
it impossible to test these configuration settings for all potential software configurations.
			</p>
        <p>
For some production environments, failure to test before implementation may lead to a loss of required functionality. Evaluating 
the risks and benefits to a system’s particular circumstances and requirements is the system owner’s responsibility. The evaluated 
risks resulting from not applying specified configuration settings must be approved by the responsible Authorizing Official. 
Furthermore, DISA implies no warranty that the application of all specified configurations will make a system 100 percent secure.
			</p>
        <p>
Security guidance is provided for the Department of Defense. While other agencies and organizations are free to use it, care must 
be given to ensure that all applicable security guidance is applied both at the device hardening level as well as the architectural 
level due to the fact that some of the settings may not be able to be configured in environments outside the DoD architecture.
			</p>
        <a name="disclaimer">
          <h3>Product Approval Disclaimer</h3>
        </a>
        <p>
The existence of a STIG does not equate to DoD approval for the procurement or use of a product.
			</p>
        <p>
STIGs provide configurable operational security guidance for products being used by the DoD. STIGs, along with vendor confidential 
documentation, also provide a basis for assessing compliance with Cybersecurity controls/control enhancements, which supports system 
Assessment and Authorization (A&amp;A) under the DoD Risk Management Framework (RMF). DoD Authorizing Officials (AOs) may request available 
vendor confidential documentation for a product that has a STIG for product evaluation and RMF purposes from <a href="mailto:disa.stig_spt@mail.mil">disa.stig_spt@mail.mil</a>. 
This documentation is not published for general access to protect the vendor’s proprietary information.
			</p>
        <p>
AOs have the purview to determine product use/approval IAW DoD policy and through RMF risk acceptance. Inputs into acquisition or pre-acquisition product selection include such processes as:
<ul><li>National Information Assurance Partnership (NIAP) evaluation for National Security Systems (NSS) (http://www.niap-ccevs.org/) IAW CNSSP #11</li><li>National Institute of Standards and Technology (NIST) Cryptographic Module Validation Program (CMVP) (http://csrc.nist.gov/groups/STM/cmvp/) IAW Federal/DoD mandated standards</li><li>DoD Unified Capabilities (UC) Approved Products List (APL) (http://www.disa.mil/network-services/ucco) IAW DoDI 8100.04</li></ul></p>
      </div>
      <div class="catalog">
        <a name="catalog">
          <h2>Requirements Catalog</h2>
        </a>
        <a name="requirementtable">
          <h3>Table of Requirements</h3>
        </a>
        <table>
          <tr>
            <th>STIG ID</th>
            <th>Group ID</th>
            <th>Rule ID</th>
            <th>Requirement</th>
            <th>Severity</th>
          </tr>
          <tr>
            <td>VCWN-65-000001</td>
            <td>V-94715</td>
            <td>
              <a href="#RULE_SV-104545r1_rule">SV-104545r1_rule</a>
            </td>
            <td>The vCenter Server for Windows must prohibit password reuse for a minimum of five generations.</td>
            <td>CAT II</td>
          </tr>
          <tr>
            <td>VCWN-65-000002</td>
            <td>V-94717</td>
            <td>
              <a href="#RULE_SV-104547r1_rule">SV-104547r1_rule</a>
            </td>
            <td>The vCenter Server for Windows must not automatically refresh client sessions.</td>
            <td>CAT II</td>
          </tr>
          <tr>
            <td>VCWN-65-000003</td>
            <td>V-94721</td>
            <td>
              <a href="#RULE_SV-104551r1_rule">SV-104551r1_rule</a>
            </td>
            <td>The vCenter Server for Windows must enforce a 60-day maximum password lifetime restriction.</td>
            <td>CAT II</td>
          </tr>
          <tr>
            <td>VCWN-65-000004</td>
            <td>V-94723</td>
            <td>
              <a href="#RULE_SV-104553r1_rule">SV-104553r1_rule</a>
            </td>
            <td>The vCenter Server for Windows must terminate management sessions after 10 minutes of inactivity.</td>
            <td>CAT II</td>
          </tr>
          <tr>
            <td>VCWN-65-000005</td>
            <td>V-94725</td>
            <td>
              <a href="#RULE_SV-104555r1_rule">SV-104555r1_rule</a>
            </td>
            <td>The vCenter Server for Windows users must have the correct roles assigned.</td>
            <td>CAT II</td>
          </tr>
          <tr>
            <td>VCWN-65-000007</td>
            <td>V-94727</td>
            <td>
              <a href="#RULE_SV-104557r1_rule">SV-104557r1_rule</a>
            </td>
            <td>The vCenter Server for Windows must manage excess capacity, bandwidth, or other redundancy to limit the effects of information-flooding types of Denial of Service (DoS) attacks by enabling Network I/O Control (NIOC).</td>
            <td>CAT II</td>
          </tr>
          <tr>
            <td>VCWN-65-000008</td>
            <td>V-94729</td>
            <td>
              <a href="#RULE_SV-104559r1_rule">SV-104559r1_rule</a>
            </td>
            <td>The vCenter Server for Windows must provide an immediate real-time alert to the SA and ISSO, at a minimum, of all audit failure events.</td>
            <td>CAT III</td>
          </tr>
          <tr>
            <td>VCWN-65-000009</td>
            <td>V-94731</td>
            <td>
              <a href="#RULE_SV-104561r1_rule">SV-104561r1_rule</a>
            </td>
            <td>The vCenter Server for Windows must use Active Directory authentication.</td>
            <td>CAT II</td>
          </tr>
          <tr>
            <td>VCWN-65-000010</td>
            <td>V-94733</td>
            <td>
              <a href="#RULE_SV-104563r1_rule">SV-104563r1_rule</a>
            </td>
            <td>The vCenter Server for Windows must limit the use of the built-in SSO administrative account.</td>
            <td>CAT II</td>
          </tr>
          <tr>
            <td>VCWN-65-000012</td>
            <td>V-94735</td>
            <td>
              <a href="#RULE_SV-104565r1_rule">SV-104565r1_rule</a>
            </td>
            <td>The vCenter Server for Windows must disable the distributed virtual switch health check.</td>
            <td>CAT III</td>
          </tr>
          <tr>
            <td>VCWN-65-000013</td>
            <td>V-94737</td>
            <td>
              <a href="#RULE_SV-104567r1_rule">SV-104567r1_rule</a>
            </td>
            <td>The vCenter Server for Windows must set the distributed port group Forged Transmits policy to reject.</td>
            <td>CAT II</td>
          </tr>
          <tr>
            <td>VCWN-65-000014</td>
            <td>V-94739</td>
            <td>
              <a href="#RULE_SV-104569r1_rule">SV-104569r1_rule</a>
            </td>
            <td>The vCenter Server for Windows must set the distributed port group MAC Address Change policy to reject.</td>
            <td>CAT I</td>
          </tr>
          <tr>
            <td>VCWN-65-000015</td>
            <td>V-94741</td>
            <td>
              <a href="#RULE_SV-104571r1_rule">SV-104571r1_rule</a>
            </td>
            <td>The vCenter Server for Windows must set the distributed port group Promiscuous Mode policy to reject.</td>
            <td>CAT II</td>
          </tr>
          <tr>
            <td>VCWN-65-000016</td>
            <td>V-94743</td>
            <td>
              <a href="#RULE_SV-104573r1_rule">SV-104573r1_rule</a>
            </td>
            <td>The vCenter Server for Windows must only send NetFlow traffic to authorized collectors.</td>
            <td>CAT II</td>
          </tr>
          <tr>
            <td>VCWN-65-000017</td>
            <td>V-94745</td>
            <td>
              <a href="#RULE_SV-104575r1_rule">SV-104575r1_rule</a>
            </td>
            <td>The vCenter Server for Windows must not override port group settings at the port level on distributed switches.</td>
            <td>CAT III</td>
          </tr>
          <tr>
            <td>VCWN-65-000018</td>
            <td>V-94747</td>
            <td>
              <a href="#RULE_SV-104577r1_rule">SV-104577r1_rule</a>
            </td>
            <td>The vCenter Server for Windows must configure all port groups to a value other than that of the native VLAN.</td>
            <td>CAT II</td>
          </tr>
          <tr>
            <td>VCWN-65-000019</td>
            <td>V-94749</td>
            <td>
              <a href="#RULE_SV-104579r1_rule">SV-104579r1_rule</a>
            </td>
            <td>The vCenter Server for Windows must configure all port groups to VLAN 4095 unless Virtual Guest Tagging (VGT) is required.</td>
            <td>CAT II</td>
          </tr>
          <tr>
            <td>VCWN-65-000020</td>
            <td>V-94751</td>
            <td>
              <a href="#RULE_SV-104581r1_rule">SV-104581r1_rule</a>
            </td>
            <td>The vCenter Server for Windows must not configure all port groups to VLAN values reserved by upstream physical switches.</td>
            <td>CAT II</td>
          </tr>
          <tr>
            <td>VCWN-65-000021</td>
            <td>V-94753</td>
            <td>
              <a href="#RULE_SV-104583r1_rule">SV-104583r1_rule</a>
            </td>
            <td>The vCenter Server for Windows must enable SSL for Network File Copy (NFC).</td>
            <td>CAT II</td>
          </tr>
          <tr>
            <td>VCWN-65-000022</td>
            <td>V-94755</td>
            <td>
              <a href="#RULE_SV-104585r1_rule">SV-104585r1_rule</a>
            </td>
            <td>The vCenter Server for Windows services must be ran using a service account instead of a built-in Windows account.</td>
            <td>CAT II</td>
          </tr>
          <tr>
            <td>VCWN-65-000023</td>
            <td>V-94757</td>
            <td>
              <a href="#RULE_SV-104587r2_rule">SV-104587r2_rule</a>
            </td>
            <td>The vCenter Server for Windows must configure the vpxuser auto-password to be changed every 30 days.</td>
            <td>CAT II</td>
          </tr>
          <tr>
            <td>VCWN-65-000024</td>
            <td>V-94759</td>
            <td>
              <a href="#RULE_SV-104589r1_rule">SV-104589r1_rule</a>
            </td>
            <td>The vCenter Server for Windows must configure the vpxuser password meets length policy.</td>
            <td>CAT II</td>
          </tr>
          <tr>
            <td>VCWN-65-000025</td>
            <td>V-94761</td>
            <td>
              <a href="#RULE_SV-104591r1_rule">SV-104591r1_rule</a>
            </td>
            <td>The vCenter Server for Windows must disable the managed object browser at all times, when not required for the purpose of troubleshooting or maintenance of managed objects.</td>
            <td>CAT III</td>
          </tr>
          <tr>
            <td>VCWN-65-000026</td>
            <td>V-94845</td>
            <td>
              <a href="#RULE_SV-104675r1_rule">SV-104675r1_rule</a>
            </td>
            <td>The vCenter Server for Windows must check the privilege re-assignment after restarts.</td>
            <td>CAT II</td>
          </tr>
          <tr>
            <td>VCWN-65-000027</td>
            <td>V-94763</td>
            <td>
              <a href="#RULE_SV-104593r1_rule">SV-104593r1_rule</a>
            </td>
            <td>The vCenter Server for Windows must minimize access to the vCenter server.</td>
            <td>CAT I</td>
          </tr>
          <tr>
            <td>VCWN-65-000028</td>
            <td>V-94765</td>
            <td>
              <a href="#RULE_SV-104595r1_rule">SV-104595r1_rule</a>
            </td>
            <td>The vCenter Server for Windows Administrators must clean up log files after failed installations.</td>
            <td>CAT II</td>
          </tr>
          <tr>
            <td>VCWN-65-000029</td>
            <td>V-94767</td>
            <td>
              <a href="#RULE_SV-104597r1_rule">SV-104597r1_rule</a>
            </td>
            <td>The vCenter Server for Windows must enable all tasks to be shown to Administrators in the Web Client.</td>
            <td>CAT II</td>
          </tr>
          <tr>
            <td>VCWN-65-000030</td>
            <td>V-94769</td>
            <td>
              <a href="#RULE_SV-104599r1_rule">SV-104599r1_rule</a>
            </td>
            <td>The vCenter Server for Windows Administrator role must be secured and assigned to specific users other than a Windows Administrator.</td>
            <td>CAT II</td>
          </tr>
          <tr>
            <td>VCWN-65-000031</td>
            <td>V-94771</td>
            <td>
              <a href="#RULE_SV-104601r1_rule">SV-104601r1_rule</a>
            </td>
            <td>The vCenter Server for Windows must restrict the connectivity between Update Manager and public patch repositories by use of a separate Update Manager Download Server.</td>
            <td>CAT III</td>
          </tr>
          <tr>
            <td>VCWN-65-000032</td>
            <td>V-94773</td>
            <td>
              <a href="#RULE_SV-104603r1_rule">SV-104603r1_rule</a>
            </td>
            <td>The vCenter Server for Windows must use a least-privileges assignment for the Update Manager database user.</td>
            <td>CAT II</td>
          </tr>
          <tr>
            <td>VCWN-65-000033</td>
            <td>V-94775</td>
            <td>
              <a href="#RULE_SV-104605r2_rule">SV-104605r2_rule</a>
            </td>
            <td>The vCenter Server for Windows must use a least-privileges assignment for the vCenter Server database user.</td>
            <td>CAT II</td>
          </tr>
          <tr>
            <td>VCWN-65-000034</td>
            <td>V-94777</td>
            <td>
              <a href="#RULE_SV-104607r1_rule">SV-104607r1_rule</a>
            </td>
            <td>The vCenter Server for Windows must use unique service accounts when applications connect to vCenter.</td>
            <td>CAT II</td>
          </tr>
          <tr>
            <td>VCWN-65-000035</td>
            <td>V-94779</td>
            <td>
              <a href="#RULE_SV-104609r1_rule">SV-104609r1_rule</a>
            </td>
            <td>vCenter Server for Windows plugins must be verified.</td>
            <td>CAT II</td>
          </tr>
          <tr>
            <td>VCWN-65-000036</td>
            <td>V-94781</td>
            <td>
              <a href="#RULE_SV-104611r1_rule">SV-104611r1_rule</a>
            </td>
            <td>The vCenter Server for Windows must produce audit records containing information to establish what type of events occurred.</td>
            <td>CAT III</td>
          </tr>
          <tr>
            <td>VCWN-65-000039</td>
            <td>V-94783</td>
            <td>
              <a href="#RULE_SV-104613r1_rule">SV-104613r1_rule</a>
            </td>
            <td>The vCenter Server for Windows passwords must be at least 15 characters in length.</td>
            <td>CAT II</td>
          </tr>
          <tr>
            <td>VCWN-65-000040</td>
            <td>V-94785</td>
            <td>
              <a href="#RULE_SV-104615r1_rule">SV-104615r1_rule</a>
            </td>
            <td>The vCenter Server for Windows passwords must contain at least one uppercase character.</td>
            <td>CAT II</td>
          </tr>
          <tr>
            <td>VCWN-65-000041</td>
            <td>V-94787</td>
            <td>
              <a href="#RULE_SV-104617r1_rule">SV-104617r1_rule</a>
            </td>
            <td>The vCenter Server for Windows passwords must contain at least one lowercase character.</td>
            <td>CAT II</td>
          </tr>
          <tr>
            <td>VCWN-65-000042</td>
            <td>V-94789</td>
            <td>
              <a href="#RULE_SV-104619r1_rule">SV-104619r1_rule</a>
            </td>
            <td>The vCenter Server for Windows passwords must contain at least one numeric character.</td>
            <td>CAT II</td>
          </tr>
          <tr>
            <td>VCWN-65-000043</td>
            <td>V-94791</td>
            <td>
              <a href="#RULE_SV-104621r1_rule">SV-104621r1_rule</a>
            </td>
            <td>The vCenter Server for Windows passwords must contain at least one special character.</td>
            <td>CAT II</td>
          </tr>
          <tr>
            <td>VCWN-65-000045</td>
            <td>V-94793</td>
            <td>
              <a href="#RULE_SV-104623r1_rule">SV-104623r1_rule</a>
            </td>
            <td>The vCenter Server for Windows must limit the maximum number of failed login attempts to three.</td>
            <td>CAT II</td>
          </tr>
          <tr>
            <td>VCWN-65-000046</td>
            <td>V-94795</td>
            <td>
              <a href="#RULE_SV-104625r1_rule">SV-104625r1_rule</a>
            </td>
            <td>The vCenter Server for Windows must set the interval for counting failed login attempts to at least 15 minutes.</td>
            <td>CAT II</td>
          </tr>
          <tr>
            <td>VCWN-65-000047</td>
            <td>V-94797</td>
            <td>
              <a href="#RULE_SV-104627r1_rule">SV-104627r1_rule</a>
            </td>
            <td>The vCenter Server for Windows must require an administrator to unlock an account locked due to excessive login failures.</td>
            <td>CAT II</td>
          </tr>
          <tr>
            <td>VCWN-65-000048</td>
            <td>V-94799</td>
            <td>
              <a href="#RULE_SV-104629r1_rule">SV-104629r1_rule</a>
            </td>
            <td>The vCenter Server for Windows must alert administrators on permission creation operations.</td>
            <td>CAT II</td>
          </tr>
          <tr>
            <td>VCWN-65-000049</td>
            <td>V-94801</td>
            <td>
              <a href="#RULE_SV-104631r2_rule">SV-104631r2_rule</a>
            </td>
            <td>The vCenter Server for Windows must alert administrators on permission deletion operations.</td>
            <td>CAT II</td>
          </tr>
          <tr>
            <td>VCWN-65-000050</td>
            <td>V-94803</td>
            <td>
              <a href="#RULE_SV-104633r1_rule">SV-104633r1_rule</a>
            </td>
            <td>The vCenter Server for Windows must alert administrators on permission update operations.</td>
            <td>CAT II</td>
          </tr>
          <tr>
            <td>VCWN-65-000051</td>
            <td>V-94805</td>
            <td>
              <a href="#RULE_SV-104635r1_rule">SV-104635r1_rule</a>
            </td>
            <td>The vCenter Server for Windows users must have the correct roles assigned.</td>
            <td>CAT II</td>
          </tr>
          <tr>
            <td>VCWN-65-000052</td>
            <td>V-94807</td>
            <td>
              <a href="#RULE_SV-104637r1_rule">SV-104637r1_rule</a>
            </td>
            <td>The vCenter Server for Windows must protect the confidentiality and integrity of transmitted information by isolating IP-based storage traffic.</td>
            <td>CAT II</td>
          </tr>
          <tr>
            <td>VCWN-65-000053</td>
            <td>V-94809</td>
            <td>
              <a href="#RULE_SV-104639r1_rule">SV-104639r1_rule</a>
            </td>
            <td>The vCenter Server for Windows must enable the vSAN Health Check.</td>
            <td>CAT II</td>
          </tr>
          <tr>
            <td>VCWN-65-000054</td>
            <td>V-94811</td>
            <td>
              <a href="#RULE_SV-104641r1_rule">SV-104641r1_rule</a>
            </td>
            <td>The vCenter Server for Windows must disable or restrict the connectivity between vSAN Health Check and public Hardware Compatibility List by use of an external proxy server.</td>
            <td>CAT II</td>
          </tr>
          <tr>
            <td>VCWN-65-000055</td>
            <td>V-94813</td>
            <td>
              <a href="#RULE_SV-104643r1_rule">SV-104643r1_rule</a>
            </td>
            <td>The vCenter Server for Windows must configure the vSAN Datastore name to a unique name.</td>
            <td>CAT II</td>
          </tr>
          <tr>
            <td>VCWN-65-000056</td>
            <td>V-94815</td>
            <td>
              <a href="#RULE_SV-104645r1_rule">SV-104645r1_rule</a>
            </td>
            <td>The vCenter Server for Windows users must have the correct roles assigned.</td>
            <td>CAT II</td>
          </tr>
          <tr>
            <td>VCWN-65-000057</td>
            <td>V-94817</td>
            <td>
              <a href="#RULE_SV-104647r1_rule">SV-104647r1_rule</a>
            </td>
            <td>The vCenter Server for Windows must enable TLS 1.2 exclusively.</td>
            <td>CAT II</td>
          </tr>
          <tr>
            <td>VCWN-65-000058</td>
            <td>V-94819</td>
            <td>
              <a href="#RULE_SV-104649r1_rule">SV-104649r1_rule</a>
            </td>
            <td>The vCenter Server for Windows reverse proxy must use DoD approved certificates.</td>
            <td>CAT II</td>
          </tr>
          <tr>
            <td>VCWN-65-000059</td>
            <td>V-94821</td>
            <td>
              <a href="#RULE_SV-104651r1_rule">SV-104651r1_rule</a>
            </td>
            <td>The vCenter Server for Windows must enable certificate based authentication.</td>
            <td>CAT II</td>
          </tr>
          <tr>
            <td>VCWN-65-000060</td>
            <td>V-94823</td>
            <td>
              <a href="#RULE_SV-104653r1_rule">SV-104653r1_rule</a>
            </td>
            <td>The vCenter Server for Windows must enable revocation checking for certificate based authentication.</td>
            <td>CAT II</td>
          </tr>
          <tr>
            <td>VCWN-65-000061</td>
            <td>V-94825</td>
            <td>
              <a href="#RULE_SV-104655r1_rule">SV-104655r1_rule</a>
            </td>
            <td>The vCenter Server for Windows must disable Password and Windows integrated authentication.</td>
            <td>CAT III</td>
          </tr>
          <tr>
            <td>VCWN-65-000062</td>
            <td>V-94827</td>
            <td>
              <a href="#RULE_SV-104657r1_rule">SV-104657r1_rule</a>
            </td>
            <td>The vCenter Server for Windows must enable Login banner for vSphere web client.</td>
            <td>CAT III</td>
          </tr>
          <tr>
            <td>VCWN-65-000063</td>
            <td>V-94829</td>
            <td>
              <a href="#RULE_SV-104659r1_rule">SV-104659r1_rule</a>
            </td>
            <td>The vCenter Server for Windows must restrict access to cryptographic role.</td>
            <td>CAT II</td>
          </tr>
          <tr>
            <td>VCWN-65-000064</td>
            <td>V-94831</td>
            <td>
              <a href="#RULE_SV-104661r1_rule">SV-104661r1_rule</a>
            </td>
            <td>The vCenter Server for Windows must restrict access to cryptographic permissions.</td>
            <td>CAT II</td>
          </tr>
          <tr>
            <td>VCWN-65-000065</td>
            <td>V-94833</td>
            <td>
              <a href="#RULE_SV-104663r1_rule">SV-104663r1_rule</a>
            </td>
            <td>The vCenter Server for Windows must have Mutual CHAP configured for vSAN iSCSI targets.</td>
            <td>CAT III</td>
          </tr>
          <tr>
            <td>VCWN-65-000066</td>
            <td>V-94835</td>
            <td>
              <a href="#RULE_SV-104665r1_rule">SV-104665r1_rule</a>
            </td>
            <td>The vCenter Server for Windows must have new Key Encryption Keys (KEKs) re-issued at regular intervals for vSAN encrypted datastore(s).</td>
            <td>CAT III</td>
          </tr>
          <tr>
            <td>VCWN-65-000067</td>
            <td>V-94837</td>
            <td>
              <a href="#RULE_SV-104667r1_rule">SV-104667r1_rule</a>
            </td>
            <td>The vCenter Server for Windows must disable the Customer Experience Improvement Program (CEIP).</td>
            <td>CAT III</td>
          </tr>
          <tr>
            <td>VCWN-65-000068</td>
            <td>V-94839</td>
            <td>
              <a href="#RULE_SV-104669r2_rule">SV-104669r2_rule</a>
            </td>
            <td>The vCenter Server for Windows must use LDAPS when adding an SSO identity source.</td>
            <td>CAT II</td>
          </tr>
          <tr>
            <td>VCWN-65-000069</td>
            <td>V-94841</td>
            <td>
              <a href="#RULE_SV-104671r2_rule">SV-104671r2_rule</a>
            </td>
            <td>The vCenter Server for Windows must use a limited privilege account when adding an LDAP identity source.</td>
            <td>CAT II</td>
          </tr>
          <tr>
            <td>VCWN-65-006000</td>
            <td>V-94853</td>
            <td>
              <a href="#RULE_SV-104683r1_rule">SV-104683r1_rule</a>
            </td>
            <td>The vCenter Server for Windows must disable SNMPv1.</td>
            <td>CAT II</td>
          </tr>
        </table>
        <a name="requirementdetails">
          <h3>Requirement Details</h3>
        </a>
        <a name="RULE_SV-104545r1_rule">
          <table class="ruleblock">
            <tr class="ruleblock">
              <td class="ruleblock"><span class="ruleheader">STIG ID:</span><br/>VCWN-65-000001</td>
              <td class="ruleblock"><span class="ruleheader">Group ID:</span><br/>V-94715</td>
              <td class="ruleblock"><span class="ruleheader">Rule ID:</span><br/>SV-104545r1_rule</td>
              <td class="ruleblock"><span class="ruleheader">Severity:</span><br/>CAT II</td>
            </tr>
          </table>
        </a>
        <table class="ruledata">
          <tr>
            <th class="ruledata">Requirement:</th>
            <td class="ruledata">
              <span class="rulerequirement">The vCenter Server for Windows must prohibit password reuse for a minimum of five generations.</span>
            </td>
          </tr>
          <tr>
            <th class="ruledata">Discussion:</th>
            <td class="ruledata">Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks. <br/>
<br/>
To meet password policy requirements, passwords need to be changed at specific policy-based intervals. <br/>
<br/>
If the information system or application allows the user to consecutively reuse their password when that password has exceeded its defined lifetime, the end result is a password that is not changed as per policy requirements.</td>
          </tr>
          <tr>
            <th class="ruledata">Check:</th>
            <td class="ruledata">From the vSphere Web Client go to Administration &gt;&gt; Single Sign-On &gt;&gt; Configuration &gt;&gt; Policies &gt;&gt; Password Policy.  View the value of the "Restrict reuse" setting.<br/>
<br/>
If the "Restrict reuse" policy is not set to "5" or more, this is a finding.</td>
          </tr>
          <tr>
            <th class="ruledata">Fix:</th>
            <td class="ruledata">From the vSphere Web Client go to Administration &gt;&gt; Single Sign-On &gt;&gt; Configuration &gt;&gt; Policies &gt;&gt; Password Policy.  Click Edit and enter "5" into the "Restrict reuse" setting and click "OK".</td>
          </tr>
          <tr>
            <th class="ruledata">References:</th>
            <td class="ruledata">
              <ul class="ruledata">
                <li>CCI-000200</li>
              </ul>
            </td>
          </tr>
        </table>
        <br/>
        <a name="RULE_SV-104547r1_rule">
          <table class="ruleblock">
            <tr class="ruleblock">
              <td class="ruleblock"><span class="ruleheader">STIG ID:</span><br/>VCWN-65-000002</td>
              <td class="ruleblock"><span class="ruleheader">Group ID:</span><br/>V-94717</td>
              <td class="ruleblock"><span class="ruleheader">Rule ID:</span><br/>SV-104547r1_rule</td>
              <td class="ruleblock"><span class="ruleheader">Severity:</span><br/>CAT II</td>
            </tr>
          </table>
        </a>
        <table class="ruledata">
          <tr>
            <th class="ruledata">Requirement:</th>
            <td class="ruledata">
              <span class="rulerequirement">The vCenter Server for Windows must not automatically refresh client sessions.</span>
            </td>
          </tr>
          <tr>
            <th class="ruledata">Discussion:</th>
            <td class="ruledata">Terminating an idle session within a short time period reduces the window of opportunity for unauthorized personnel to take control of a management session enabled on the console or console port that has been left unattended. In addition, quickly terminating an idle session will also free up resources committed by the managed network element. Automatic client session refreshes keep unused sessions online, blocking session timeouts.</td>
          </tr>
          <tr>
            <th class="ruledata">Check:</th>
            <td class="ruledata">On the system where vCenter is installed locate the "webclient.properties" file. <br/>
<br/>
Appliance: <br/>
/etc/vmware/vsphere-client/ <br/>
<br/>
Windows: <br/>
C:\ProgramData\VMware\vCenterServer\cfg\vsphere-client <br/>
<br/>
Find the "refresh.rate =" line in the "webclient.properties" file. <br/>
<br/>
If the refresh rate is not set to "-1" in the "webclient.properties" file, this is a finding.</td>
          </tr>
          <tr>
            <th class="ruledata">Fix:</th>
            <td class="ruledata">Change the refresh rate value by editing the "webclient.properties" file. <br/>
<br/>
On the system where vCenter is installed locate the "webclient.properties" file. <br/>
<br/>
Appliance: <br/>
/etc/vmware/vsphere-client/ <br/>
<br/>
Windows: <br/>
C:\ProgramData\VMware\vCenterServer\cfg\vsphere-client <br/>
<br/>
Edit the file to include the line "refresh.rate = -1" where "-1" indicates sessions are not automatically refreshed. Uncomment the line if necessary. <br/>
<br/>
After editing the file the vSphere Web Client service must be restarted.</td>
          </tr>
          <tr>
            <th class="ruledata">References:</th>
            <td class="ruledata">
              <ul class="ruledata">
                <li>CCI-001133</li>
              </ul>
            </td>
          </tr>
        </table>
        <br/>
        <a name="RULE_SV-104551r1_rule">
          <table class="ruleblock">
            <tr class="ruleblock">
              <td class="ruleblock"><span class="ruleheader">STIG ID:</span><br/>VCWN-65-000003</td>
              <td class="ruleblock"><span class="ruleheader">Group ID:</span><br/>V-94721</td>
              <td class="ruleblock"><span class="ruleheader">Rule ID:</span><br/>SV-104551r1_rule</td>
              <td class="ruleblock"><span class="ruleheader">Severity:</span><br/>CAT II</td>
            </tr>
          </table>
        </a>
        <table class="ruledata">
          <tr>
            <th class="ruledata">Requirement:</th>
            <td class="ruledata">
              <span class="rulerequirement">The vCenter Server for Windows must enforce a 60-day maximum password lifetime restriction.</span>
            </td>
          </tr>
          <tr>
            <th class="ruledata">Discussion:</th>
            <td class="ruledata">Any password, no matter how complex, can eventually be cracked. Therefore, passwords need to be changed at specific intervals. <br/>
<br/>
One method of minimizing this risk is to use complex passwords and periodically change them. If the application does not limit the lifetime of passwords and force users to change their passwords, there is the risk that the system and/or application passwords could be compromised. <br/>
<br/>
This requirement does not include emergency administration accounts which are meant for access to the application in case of failure. These accounts are not required to have maximum password lifetime restrictions.</td>
          </tr>
          <tr>
            <th class="ruledata">Check:</th>
            <td class="ruledata">From the vSphere Web Client go to Administration &gt;&gt; Single Sign-On &gt;&gt; Configuration &gt;&gt; Policies &gt;&gt; Password Policy.  View the value of the "Maximum lifetime" setting.<br/>
<br/>
If the "Maximum lifetime" policy is not set to "60", this is a finding.</td>
          </tr>
          <tr>
            <th class="ruledata">Fix:</th>
            <td class="ruledata">From the vSphere Web Client go to Administration &gt;&gt; Single Sign-On &gt;&gt; Configuration &gt;&gt; Policies &gt;&gt; Password Policy.  Click Edit and enter "60" into the "Maximum lifetime" setting and click "OK".</td>
          </tr>
          <tr>
            <th class="ruledata">References:</th>
            <td class="ruledata">
              <ul class="ruledata">
                <li>CCI-000199</li>
              </ul>
            </td>
          </tr>
        </table>
        <br/>
        <a name="RULE_SV-104553r1_rule">
          <table class="ruleblock">
            <tr class="ruleblock">
              <td class="ruleblock"><span class="ruleheader">STIG ID:</span><br/>VCWN-65-000004</td>
              <td class="ruleblock"><span class="ruleheader">Group ID:</span><br/>V-94723</td>
              <td class="ruleblock"><span class="ruleheader">Rule ID:</span><br/>SV-104553r1_rule</td>
              <td class="ruleblock"><span class="ruleheader">Severity:</span><br/>CAT II</td>
            </tr>
          </table>
        </a>
        <table class="ruledata">
          <tr>
            <th class="ruledata">Requirement:</th>
            <td class="ruledata">
              <span class="rulerequirement">The vCenter Server for Windows must terminate management sessions after 10 minutes of inactivity.</span>
            </td>
          </tr>
          <tr>
            <th class="ruledata">Discussion:</th>
            <td class="ruledata">Terminating an idle session within a short time period reduces the window of opportunity for unauthorized personnel to take control of a management session enabled on the console or console port that has been left unattended. In addition, quickly terminating an idle session will also free up resources committed by the managed network element. <br/>
<br/>
Terminating network connections associated with communications sessions includes, for example, de-allocating associated TCP/IP address/port pairs at the operating system level, or de-allocating networking assignments at the application level if multiple application sessions are using a single, operating system level network connection. This does not mean that the application terminates all sessions or network access; it only ends the inactive session and releases the resources associated with that session.</td>
          </tr>
          <tr>
            <th class="ruledata">Check:</th>
            <td class="ruledata">By default, vSphere Web Client sessions terminate after "120" minutes of idle time, requiring the user to log in again to resume using the client. You can view the timeout value by viewing the "webclient.properties" file.<br/>
<br/>
On the system where vCenter is installed locate the "webclient.properties" file.<br/>
<br/>
Appliance: <br/>
/etc/vmware/vsphere-client/<br/>
<br/>
Windows: <br/>
C:\ProgramData\VMware\vCenterServer\cfg\vsphere-client<br/>
<br/>
Find the "session.timeout =" line in the "webclient.properties" file.<br/>
<br/>
If the session timeout is not set to "10" in the "webclient.properties" file, this is a finding.</td>
          </tr>
          <tr>
            <th class="ruledata">Fix:</th>
            <td class="ruledata">Change the timeout value by editing the "webclient.properties" file.<br/>
<br/>
On the system where vCenter is installed locate the "webclient.properties" file.<br/>
<br/>
Appliance: <br/>
/etc/vmware/vsphere-client/<br/>
<br/>
Windows: <br/>
C:\ProgramData\VMware\vCenterServer\cfg\vsphere-client<br/>
<br/>
Edit the file to include the line "session.timeout = 10" where "10" is the timeout value in minutes.  Uncomment the line if necessary.<br/>
<br/>
After editing the file the vSphere Web Client service must be restarted.</td>
          </tr>
          <tr>
            <th class="ruledata">References:</th>
            <td class="ruledata">
              <ul class="ruledata">
                <li>CCI-001133</li>
              </ul>
            </td>
          </tr>
        </table>
        <br/>
        <a name="RULE_SV-104555r1_rule">
          <table class="ruleblock">
            <tr class="ruleblock">
              <td class="ruleblock"><span class="ruleheader">STIG ID:</span><br/>VCWN-65-000005</td>
              <td class="ruleblock"><span class="ruleheader">Group ID:</span><br/>V-94725</td>
              <td class="ruleblock"><span class="ruleheader">Rule ID:</span><br/>SV-104555r1_rule</td>
              <td class="ruleblock"><span class="ruleheader">Severity:</span><br/>CAT II</td>
            </tr>
          </table>
        </a>
        <table class="ruledata">
          <tr>
            <th class="ruledata">Requirement:</th>
            <td class="ruledata">
              <span class="rulerequirement">The vCenter Server for Windows users must have the correct roles assigned.</span>
            </td>
          </tr>
          <tr>
            <th class="ruledata">Discussion:</th>
            <td class="ruledata">Users and service accounts must only be assigned privileges they require. Least Privilege requires that these privileges must only be assigned if needed, to reduce risk of confidentiality, availability or integrity loss.</td>
          </tr>
          <tr>
            <th class="ruledata">Check:</th>
            <td class="ruledata">From the vSphere Web Client go to Administration &gt;&gt; Access Control &gt;&gt; Roles.  View each role and verify the users and/or groups assigned to it.<br/>
<br/>
or<br/>
<br/>
From a PowerCLI command prompt while connected to the vCenter server run the following command:<br/>
<br/>
Get-VIPermission | Sort Role | Select Role,Principal,Entity,Propagate,IsGroup | FT -Auto<br/>
<br/>
Application service account and user required privileges should be documented.<br/>
<br/>
If any user or service account has more privileges than required, this is a finding.</td>
          </tr>
          <tr>
            <th class="ruledata">Fix:</th>
            <td class="ruledata">To update a user or groups permissions to an existing role with reduced permissions do the following:<br/>
<br/>
From the vSphere Web Client go to Administration &gt;&gt; Access Control &gt;&gt; Global Permissions.  Select the user or group and click "Edit" and change the assigned role and click "OK".  If permissions are assigned on a specific object then the role must be updated where it is assigned for example at the cluster level.<br/>
<br/>
To create a new role with reduced permissions do the following:<br/>
<br/>
From the vSphere Web Client go to Administration &gt;&gt; Access Control &gt;&gt; Roles. Click the green plus sign and enter a name for the role and select only the specific permissions required.  Users can then be assigned to the newly created role.</td>
          </tr>
          <tr>
            <th class="ruledata">References:</th>
            <td class="ruledata">
              <ul class="ruledata">
                <li>CCI-001082</li>
              </ul>
            </td>
          </tr>
        </table>
        <br/>
        <a name="RULE_SV-104557r1_rule">
          <table class="ruleblock">
            <tr class="ruleblock">
              <td class="ruleblock"><span class="ruleheader">STIG ID:</span><br/>VCWN-65-000007</td>
              <td class="ruleblock"><span class="ruleheader">Group ID:</span><br/>V-94727</td>
              <td class="ruleblock"><span class="ruleheader">Rule ID:</span><br/>SV-104557r1_rule</td>
              <td class="ruleblock"><span class="ruleheader">Severity:</span><br/>CAT II</td>
            </tr>
          </table>
        </a>
        <table class="ruledata">
          <tr>
            <th class="ruledata">Requirement:</th>
            <td class="ruledata">
              <span class="rulerequirement">The vCenter Server for Windows must manage excess capacity, bandwidth, or other redundancy to limit the effects of information-flooding types of Denial of Service (DoS) attacks by enabling Network I/O Control (NIOC).</span>
            </td>
          </tr>
          <tr>
            <th class="ruledata">Discussion:</th>
            <td class="ruledata">DoS is a condition when a resource is not available for legitimate users. When this occurs, the organization either cannot accomplish its mission or must operate at degraded capacity.<br/>
<br/>
Managing excess capacity ensures that sufficient capacity is available to counter flooding attacks. Employing increased capacity and service redundancy may reduce the susceptibility to some DoS attacks. Managing excess capacity may include, for example, establishing selected usage priorities, quotas, or partitioning.</td>
          </tr>
          <tr>
            <th class="ruledata">Check:</th>
            <td class="ruledata">From the vSphere Web Client go to Networking &gt;&gt; Select a distributed switch &gt;&gt; Configure &gt;&gt; Settings &gt;&gt; Properties. View the Properties pane and verify Network I/O Control is enabled.<br/>
<br/>
or<br/>
<br/>
From a PowerCLI command prompt while connected to the vCenter server run the following command:<br/>
<br/>
Get-VDSwitch | select Name,@{N="NIOC Enabled";E={$_.ExtensionData.config.NetworkResourceManagementEnabled}}<br/>
<br/>
If Network I/O Control is disabled, this is a finding.</td>
          </tr>
          <tr>
            <th class="ruledata">Fix:</th>
            <td class="ruledata">From the vSphere Web Client go to Networking &gt;&gt; Select a distributed switch &gt;&gt; Configure &gt;&gt; Settings &gt;&gt; Properties. In the Properties pane click "Edit" and change Network I/O Control to enabled.<br/>
<br/>
or<br/>
<br/>
From a PowerCLI command prompt while connected to the vCenter server run the following command:<br/>
<br/>
(Get-VDSwitch "DVSwitch Name" | Get-View).EnableNetworkResourceManagement($true)</td>
          </tr>
          <tr>
            <th class="ruledata">References:</th>
            <td class="ruledata">
              <ul class="ruledata">
                <li>CCI-000366</li>
              </ul>
            </td>
          </tr>
        </table>
        <br/>
        <a name="RULE_SV-104559r1_rule">
          <table class="ruleblock">
            <tr class="ruleblock">
              <td class="ruleblock"><span class="ruleheader">STIG ID:</span><br/>VCWN-65-000008</td>
              <td class="ruleblock"><span class="ruleheader">Group ID:</span><br/>V-94729</td>
              <td class="ruleblock"><span class="ruleheader">Rule ID:</span><br/>SV-104559r1_rule</td>
              <td class="ruleblock"><span class="ruleheader">Severity:</span><br/>CAT III</td>
            </tr>
          </table>
        </a>
        <table class="ruledata">
          <tr>
            <th class="ruledata">Requirement:</th>
            <td class="ruledata">
              <span class="rulerequirement">The vCenter Server for Windows must provide an immediate real-time alert to the SA and ISSO, at a minimum, of all audit failure events.</span>
            </td>
          </tr>
          <tr>
            <th class="ruledata">Discussion:</th>
            <td class="ruledata">It is critical for the appropriate personnel to be aware if an ESXi host is at risk of failing to process audit logs as required. Without a real-time alert, security personnel may be unaware of an impending failure of the audit capability, and system operation may be adversely affected.<br/>
<br/>
To ensure the appropriate personnel are alerted if an audit failure occurs a vCenter alarm can be created to trigger when an ESXi host can no longer reach its syslog server.</td>
          </tr>
          <tr>
            <th class="ruledata">Check:</th>
            <td class="ruledata">From the vSphere Web Client go to Host and Clusters &gt;&gt; Select a vCenter Server &gt;&gt; Monitor &gt;&gt; Issues &gt;&gt; Alarm Definitions. Verify there is an alarm created to alert when an ESXi host can no longer reach its syslog server.<br/>
<br/>
or<br/>
<br/>
From a PowerCLI command prompt while connected to the vCenter server run the following command:<br/>
<br/>
Get-AlarmDefinition | Where {$_.ExtensionData.Info.Expression.Expression.EventTypeId -eq "esx.problem.vmsyslogd.remote.failure"} | Select Name,Enabled,@{N="EventTypeId";E={$_.ExtensionData.Info.Expression.Expression.EventTypeId}}<br/>
<br/>
If an alarm is not created to alert when syslog failures occur, this is a finding.</td>
          </tr>
          <tr>
            <th class="ruledata">Fix:</th>
            <td class="ruledata">From the vSphere Web Client go to Host and Clusters &gt;&gt; Select a vCenter Server &gt;&gt; Monitor &gt;&gt; Issues &gt;&gt; Alarm Definitions &gt;&gt; Click the green plus icon. Provide an alarm name and description, Select "Hosts" from the "Monitor" dropdown menu. Select "specific event" next to "Monitor for". Enable the alarm. Click "Next". Add a new Trigger and paste in "esx.problem.vmsyslogd.remote.failure" for the Event. Select "Alert" for the Status. Click "Next". Add an action to send an email or a trap for "green to yellow" and "yellow to red" categories, configure appropriately. Click "Finish".<br/>
<br/>
Note - This alarm will only trigger if syslog is configured for TCP or SSL connections and not UDP.</td>
          </tr>
          <tr>
            <th class="ruledata">References:</th>
            <td class="ruledata">
              <ul class="ruledata">
                <li>CCI-000139</li>
              </ul>
            </td>
          </tr>
        </table>
        <br/>
        <a name="RULE_SV-104561r1_rule">
          <table class="ruleblock">
            <tr class="ruleblock">
              <td class="ruleblock"><span class="ruleheader">STIG ID:</span><br/>VCWN-65-000009</td>
              <td class="ruleblock"><span class="ruleheader">Group ID:</span><br/>V-94731</td>
              <td class="ruleblock"><span class="ruleheader">Rule ID:</span><br/>SV-104561r1_rule</td>
              <td class="ruleblock"><span class="ruleheader">Severity:</span><br/>CAT II</td>
            </tr>
          </table>
        </a>
        <table class="ruledata">
          <tr>
            <th class="ruledata">Requirement:</th>
            <td class="ruledata">
              <span class="rulerequirement">The vCenter Server for Windows must use Active Directory authentication.</span>
            </td>
          </tr>
          <tr>
            <th class="ruledata">Discussion:</th>
            <td class="ruledata">The vCenter Server for Windows must ensure users are authenticated with an individual authenticator prior to using a group authenticator.  Using Active Directory for authentication provides more robust account management capabilities.</td>
          </tr>
          <tr>
            <th class="ruledata">Check:</th>
            <td class="ruledata">If Active Directory is not used in the environment, this is not applicable.<br/>
<br/>
Verify the Windows server hosting vCenter is joined to the domain and access to the server and to vCenter is done using Active Directory accounts.<br/>
<br/>
If the vCenter server is not joined to an Active Directory domain, this is a finding.<br/>
<br/>
If Active Directory-based accounts are not used for daily operations of the vCenter server, this is a finding.</td>
          </tr>
          <tr>
            <th class="ruledata">Fix:</th>
            <td class="ruledata">If the server hosting vCenter is not joined to the domain follow the OS specific procedures to join it to Active Directory.<br/>
<br/>
If local accounts are used for normal operations then Active Directory accounts should be created and used.</td>
          </tr>
          <tr>
            <th class="ruledata">References:</th>
            <td class="ruledata">
              <ul class="ruledata">
                <li>CCI-000770</li>
              </ul>
            </td>
          </tr>
        </table>
        <br/>
        <a name="RULE_SV-104563r1_rule">
          <table class="ruleblock">
            <tr class="ruleblock">
              <td class="ruleblock"><span class="ruleheader">STIG ID:</span><br/>VCWN-65-000010</td>
              <td class="ruleblock"><span class="ruleheader">Group ID:</span><br/>V-94733</td>
              <td class="ruleblock"><span class="ruleheader">Rule ID:</span><br/>SV-104563r1_rule</td>
              <td class="ruleblock"><span class="ruleheader">Severity:</span><br/>CAT II</td>
            </tr>
          </table>
        </a>
        <table class="ruledata">
          <tr>
            <th class="ruledata">Requirement:</th>
            <td class="ruledata">
              <span class="rulerequirement">The vCenter Server for Windows must limit the use of the built-in SSO administrative account.</span>
            </td>
          </tr>
          <tr>
            <th class="ruledata">Discussion:</th>
            <td class="ruledata">Use of the SSO administrator account should be limited as it is a shared account and individual accounts must be used wherever possible.</td>
          </tr>
          <tr>
            <th class="ruledata">Check:</th>
            <td class="ruledata">Verify the built-in SSO administrator account is only used for emergencies and situations where it is the only option due to permissions.<br/>
<br/>
If the built-in SSO administrator account is used for daily operations or there is no policy restricting its use, this is a finding.</td>
          </tr>
          <tr>
            <th class="ruledata">Fix:</th>
            <td class="ruledata">A policy should be developed to limit the use of the built-in SSO administrator account.</td>
          </tr>
          <tr>
            <th class="ruledata">References:</th>
            <td class="ruledata">
              <ul class="ruledata">
                <li>CCI-000770</li>
              </ul>
            </td>
          </tr>
        </table>
        <br/>
        <a name="RULE_SV-104565r1_rule">
          <table class="ruleblock">
            <tr class="ruleblock">
              <td class="ruleblock"><span class="ruleheader">STIG ID:</span><br/>VCWN-65-000012</td>
              <td class="ruleblock"><span class="ruleheader">Group ID:</span><br/>V-94735</td>
              <td class="ruleblock"><span class="ruleheader">Rule ID:</span><br/>SV-104565r1_rule</td>
              <td class="ruleblock"><span class="ruleheader">Severity:</span><br/>CAT III</td>
            </tr>
          </table>
        </a>
        <table class="ruledata">
          <tr>
            <th class="ruledata">Requirement:</th>
            <td class="ruledata">
              <span class="rulerequirement">The vCenter Server for Windows must disable the distributed virtual switch health check.</span>
            </td>
          </tr>
          <tr>
            <th class="ruledata">Discussion:</th>
            <td class="ruledata">Network Healthcheck is disabled by default. Once enabled, the healthcheck packets contain information on host#, vds#, port#, which an attacker would find useful. It is recommended that network healthcheck be used for troubleshooting, and turned off when troubleshooting is finished.</td>
          </tr>
          <tr>
            <th class="ruledata">Check:</th>
            <td class="ruledata">From the vSphere Web Client go to Networking &gt;&gt; Select a distributed switch &gt;&gt; Configure &gt;&gt; Settings &gt;&gt; Health Check. View the health check pane and verify both checks are disabled.<br/>
<br/>
or<br/>
<br/>
From a PowerCLI command prompt while connected to the vCenter server run the following commands:<br/>
$vds = Get-VDSwitch<br/>
$vds.ExtensionData.Config.HealthCheckConfig<br/>
<br/>
If the health check feature is enabled on distributed switches and is not on temporarily for troubleshooting purposes, this is a finding.</td>
          </tr>
          <tr>
            <th class="ruledata">Fix:</th>
            <td class="ruledata">From the vSphere Web Client go to Networking &gt;&gt; Select a distributed switch &gt;&gt; Configure &gt;&gt; Settings &gt;&gt; Health Check. Click the "Edit" button and disable both health checks.<br/>
<br/>
or<br/>
<br/>
From a PowerCLI command prompt while connected to the vCenter server run the following command:<br/>
Get-View -ViewType DistributedVirtualSwitch | ?{($_.config.HealthCheckConfig | ?{$_.enable -notmatch "False"})}| %{$_.UpdateDVSHealthCheckConfig(@((New-Object Vmware.Vim.VMwareDVSVlanMtuHealthCheckConfig -property @{enable=0}),(New-Object Vmware.Vim.VMwareDVSTeamingHealthCheckConfig -property @{enable=0})))}</td>
          </tr>
          <tr>
            <th class="ruledata">References:</th>
            <td class="ruledata">
              <ul class="ruledata">
                <li>CCI-000366</li>
              </ul>
            </td>
          </tr>
        </table>
        <br/>
        <a name="RULE_SV-104567r1_rule">
          <table class="ruleblock">
            <tr class="ruleblock">
              <td class="ruleblock"><span class="ruleheader">STIG ID:</span><br/>VCWN-65-000013</td>
              <td class="ruleblock"><span class="ruleheader">Group ID:</span><br/>V-94737</td>
              <td class="ruleblock"><span class="ruleheader">Rule ID:</span><br/>SV-104567r1_rule</td>
              <td class="ruleblock"><span class="ruleheader">Severity:</span><br/>CAT II</td>
            </tr>
          </table>
        </a>
        <table class="ruledata">
          <tr>
            <th class="ruledata">Requirement:</th>
            <td class="ruledata">
              <span class="rulerequirement">The vCenter Server for Windows must set the distributed port group Forged Transmits policy to reject.</span>
            </td>
          </tr>
          <tr>
            <th class="ruledata">Discussion:</th>
            <td class="ruledata">If the virtual machine operating system changes the MAC address, the operating system can send frames with an impersonated source MAC address at any time. This allows an operating system to stage malicious attacks on the devices in a network by impersonating a network adaptor authorized by the receiving network.<br/>
<br/>
When the Forged transmits option is set to Accept, ESXi does not compare source and effective MAC addresses.<br/>
<br/>
To protect against MAC impersonation, you can set the Forged transmits option to Reject. If you do, the host compares the source MAC address being transmitted by the guest operating system with the effective MAC address for its virtual machine adapter to see if they match. If the addresses do not match, the ESXi host drops the packet.</td>
          </tr>
          <tr>
            <th class="ruledata">Check:</th>
            <td class="ruledata">From the vSphere Web Client go to Networking &gt;&gt; Select a distributed switch &gt;&gt; Select a port group &gt;&gt; Configure &gt;&gt; Settings &gt;&gt; Policies<br/>
<br/>
Verify "Forged Transmits" is set to reject.<br/>
<br/>
or<br/>
<br/>
From a PowerCLI command prompt while connected to the vCenter server run the following commands:<br/>
Get-VDSwitch | Get-VDSecurityPolicy<br/>
Get-VDPortgroup | ?{$_.IsUplink -eq $false} | Get-VDSecurityPolicy<br/>
<br/>
If the "Forged Transmits" policy is set to accept for a non-uplink port, this is a finding.</td>
          </tr>
          <tr>
            <th class="ruledata">Fix:</th>
            <td class="ruledata">From the vSphere Web Client go to Networking &gt;&gt; Select a distributed switch &gt;&gt; Select a port group &gt;&gt; Configure &gt;&gt; Settings &gt;&gt; Policies &gt;&gt; Edit &gt;&gt; Security. Set "Forged Transmits" to reject. Click "OK".<br/>
<br/>
or<br/>
<br/>
From a PowerCLI command prompt while connected to the vCenter server run the following commands:<br/>
Get-VDSwitch | Get-VDSecurityPolicy | Set-VDSecurityPolicy -ForgedTransmits $false<br/>
Get-VDPortgroup | ?{$_.IsUplink -eq $false} | Get-VDSecurityPolicy | Set-VDSecurityPolicy -ForgedTransmits $false</td>
          </tr>
          <tr>
            <th class="ruledata">References:</th>
            <td class="ruledata">
              <ul class="ruledata">
                <li>CCI-000366</li>
              </ul>
            </td>
          </tr>
        </table>
        <br/>
        <a name="RULE_SV-104569r1_rule">
          <table class="ruleblock">
            <tr class="ruleblock">
              <td class="ruleblock"><span class="ruleheader">STIG ID:</span><br/>VCWN-65-000014</td>
              <td class="ruleblock"><span class="ruleheader">Group ID:</span><br/>V-94739</td>
              <td class="ruleblock"><span class="ruleheader">Rule ID:</span><br/>SV-104569r1_rule</td>
              <td class="ruleblock"><span class="ruleheader">Severity:</span><br/>CAT I</td>
            </tr>
          </table>
        </a>
        <table class="ruledata">
          <tr>
            <th class="ruledata">Requirement:</th>
            <td class="ruledata">
              <span class="rulerequirement">The vCenter Server for Windows must set the distributed port group MAC Address Change policy to reject.</span>
            </td>
          </tr>
          <tr>
            <th class="ruledata">Discussion:</th>
            <td class="ruledata">If the virtual machine operating system changes the MAC address, it can send frames with an impersonated source MAC address at any time. This allows it to stage malicious attacks on the devices in a network by impersonating a network adaptor authorized by the receiving network. This will prevent VMs from changing their effective MAC address. It will affect applications that require this functionality. This will also affect how a layer 2 bridge will operate. This will also affect applications that require a specific MAC address for licensing.</td>
          </tr>
          <tr>
            <th class="ruledata">Check:</th>
            <td class="ruledata">From the vSphere Web Client go to Networking &gt;&gt; Select a distributed switch &gt;&gt; Select a port group &gt;&gt; Configure &gt;&gt; Settings &gt;&gt; Policies<br/>
<br/>
Verify "MAC Address Changes" is set to reject.<br/>
<br/>
or<br/>
<br/>
From a PowerCLI command prompt while connected to the vCenter server run the following commands:<br/>
Get-VDSwitch | Get-VDSecurityPolicy<br/>
Get-VDPortgroup | ?{$_.IsUplink -eq $false} | Get-VDSecurityPolicy<br/>
<br/>
If the "MAC Address Changes" policy is set to accept, this is a finding.</td>
          </tr>
          <tr>
            <th class="ruledata">Fix:</th>
            <td class="ruledata">From the vSphere Web Client go to Networking &gt;&gt; Select a distributed switch &gt;&gt; Select a port group &gt;&gt; Configure &gt;&gt; Settings &gt;&gt; Policies &gt;&gt; Edit &gt;&gt; Security. Set "MAC Address Changes" to reject. Click "OK".<br/>
  <br/>
or<br/>
<br/>
From a PowerCLI command prompt while connected to the vCenter server run the following commands:<br/>
Get-VDSwitch | Get-VDSecurityPolicy | Set-VDSecurityPolicy -MacChanges $false<br/>
Get-VDPortgroup | ?{$_.IsUplink -eq $false} | Get-VDSecurityPolicy | Set-VDSecurityPolicy -MacChanges $false</td>
          </tr>
          <tr>
            <th class="ruledata">References:</th>
            <td class="ruledata">
              <ul class="ruledata">
                <li>CCI-000366</li>
              </ul>
            </td>
          </tr>
        </table>
        <br/>
        <a name="RULE_SV-104571r1_rule">
          <table class="ruleblock">
            <tr class="ruleblock">
              <td class="ruleblock"><span class="ruleheader">STIG ID:</span><br/>VCWN-65-000015</td>
              <td class="ruleblock"><span class="ruleheader">Group ID:</span><br/>V-94741</td>
              <td class="ruleblock"><span class="ruleheader">Rule ID:</span><br/>SV-104571r1_rule</td>
              <td class="ruleblock"><span class="ruleheader">Severity:</span><br/>CAT II</td>
            </tr>
          </table>
        </a>
        <table class="ruledata">
          <tr>
            <th class="ruledata">Requirement:</th>
            <td class="ruledata">
              <span class="rulerequirement">The vCenter Server for Windows must set the distributed port group Promiscuous Mode policy to reject.</span>
            </td>
          </tr>
          <tr>
            <th class="ruledata">Discussion:</th>
            <td class="ruledata">When promiscuous mode is enabled for a virtual switch all virtual machines connected to the Portgroup have the potential of reading all packets across that network, meaning only the virtual machines connected to that Portgroup. Promiscuous mode is disabled by default on the ESXi Server, and this is the recommended setting.</td>
          </tr>
          <tr>
            <th class="ruledata">Check:</th>
            <td class="ruledata">From the vSphere Web Client go to Networking &gt;&gt; Select a distributed switch &gt;&gt; Select a port group &gt;&gt; Configure &gt;&gt; Settings &gt;&gt; Policies<br/>
<br/>
Verify "Promiscuous Mode" is set to reject.<br/>
<br/>
or<br/>
<br/>
From a PowerCLI command prompt while connected to the vCenter server run the following commands:<br/>
Get-VDSwitch | Get-VDSecurityPolicy<br/>
Get-VDPortgroup | ?{$_.IsUplink -eq $false} | Get-VDSecurityPolicy<br/>
<br/>
If the "Promiscuous Mode" policy is set to accept, this is a finding.</td>
          </tr>
          <tr>
            <th class="ruledata">Fix:</th>
            <td class="ruledata">From the vSphere Web Client go to Networking &gt;&gt; Select a distributed switch &gt;&gt; Select a port group &gt;&gt; Configure &gt;&gt; Settings &gt;&gt; Policies &gt;&gt; Edit &gt;&gt; Security. Set "Promiscuous Mode" to reject. Click "OK".<br/>
  <br/>
or<br/>
<br/>
From a PowerCLI command prompt while connected to the vCenter server run the following commands:<br/>
Get-VDSwitch | Get-VDSecurityPolicy | Set-VDSecurityPolicy -AllowPromiscuous $false<br/>
Get-VDPortgroup | ?{$_.IsUplink -eq $false} | Get-VDSecurityPolicy | Set-VDSecurityPolicy -AllowPromiscuous $false</td>
          </tr>
          <tr>
            <th class="ruledata">References:</th>
            <td class="ruledata">
              <ul class="ruledata">
                <li>CCI-000366</li>
              </ul>
            </td>
          </tr>
        </table>
        <br/>
        <a name="RULE_SV-104573r1_rule">
          <table class="ruleblock">
            <tr class="ruleblock">
              <td class="ruleblock"><span class="ruleheader">STIG ID:</span><br/>VCWN-65-000016</td>
              <td class="ruleblock"><span class="ruleheader">Group ID:</span><br/>V-94743</td>
              <td class="ruleblock"><span class="ruleheader">Rule ID:</span><br/>SV-104573r1_rule</td>
              <td class="ruleblock"><span class="ruleheader">Severity:</span><br/>CAT II</td>
            </tr>
          </table>
        </a>
        <table class="ruledata">
          <tr>
            <th class="ruledata">Requirement:</th>
            <td class="ruledata">
              <span class="rulerequirement">The vCenter Server for Windows must only send NetFlow traffic to authorized collectors.</span>
            </td>
          </tr>
          <tr>
            <th class="ruledata">Discussion:</th>
            <td class="ruledata">The distributed virtual switch can export NetFlow information about traffic crossing the switch. NetFlow exports are not encrypted and can contain information about the virtual network making it easier for a MitM attack to be executed successfully. If NetFlow export is required, verify that all NetFlow target IP's are correct.</td>
          </tr>
          <tr>
            <th class="ruledata">Check:</th>
            <td class="ruledata">To view NetFlow Collector IPs configured on distributed switches:<br/>
From the vSphere Web Client go to Networking &gt;&gt; Select a distributed switch &gt;&gt; Configure &gt;&gt; Settings &gt;&gt; NetFlow. View the NetFlow pane and verify any collector IP addresses are valid and in use for troubleshooting.<br/>
<br/>
or<br/>
<br/>
From a PowerCLI command prompt while connected to the vCenter server run the following command:<br/>
Get-VDSwitch | select Name,@{N="NetFlowCollectorIPs";E={$_.ExtensionData.config.IpfixConfig.CollectorIpAddress}}<br/>
----<br/>
To view if NetFlow is enabled on any distributed port groups:<br/>
From the vSphere Web Client go to Networking &gt;&gt; Select a distributed port group &gt;&gt; Manage &gt;&gt; Settings &gt;&gt; Policies. Go to Monitoring and view the NetFlow status.<br/>
<br/>
or<br/>
<br/>
From a PowerCLI command prompt while connected to the vCenter server run the following command:<br/>
Get-VDPortgroup | Select Name,VirtualSwitch,@{N="NetFlowEnabled";E={$_.Extensiondata.Config.defaultPortConfig.ipfixEnabled.Value}}<br/>
<br/>
If NetFlow is configured and the collector IP is not known and is not enabled temporarily for troubleshooting purposes, this is a finding.</td>
          </tr>
          <tr>
            <th class="ruledata">Fix:</th>
            <td class="ruledata">To remove collector IPs do the following:<br/>
From the vSphere Web Client go to Networking &gt;&gt; Select a distributed switch &gt;&gt; Configure &gt;&gt; Settings &gt;&gt; NetFlow. Click edit and remove any unknown collector IPs.<br/>
<br/>
or<br/>
<br/>
From a PowerCLI command prompt while connected to the vCenter server run the following commands:<br/>
$dvs = Get-VDSwitch dvswitch | Get-View<br/>
ForEach($vs in $dvs){<br/>
$spec = New-Object VMware.Vim.VMwareDVSConfigSpec<br/>
$spec.configversion = $vs.Config.ConfigVersion<br/>
$spec.IpfixConfig = New-Object VMware.Vim.VMwareIpfixConfig<br/>
$spec.IpfixConfig.CollectorIpAddress = ""<br/>
$spec.IpfixConfig.CollectorPort = "0"<br/>
$spec.IpfixConfig.ActiveFlowTimeout = "60"<br/>
$spec.IpfixConfig.IdleFlowTimeout = "15"<br/>
$spec.IpfixConfig.SamplingRate = "0"<br/>
$spec.IpfixConfig.InternalFlowsOnly = $False<br/>
$vs.ReconfigureDvs_Task($spec)<br/>
}<br/>
<br/>
Note: This will reset the NetFlow collector configuration back to the defaults.<br/>
<br/>
To disable NetFlow on a distributed port group do the following:<br/>
From the vSphere Web Client go to Networking &gt;&gt; Select a distributed port group &gt;&gt; Manage &gt;&gt; Settings &gt;&gt; Policies. Go to Monitoring and change NetFlow to disabled.<br/>
<br/>
or<br/>
<br/>
From a PowerCLI command prompt while connected to the vCenter server run the following commands:<br/>
$pgs = Get-VDPortgroup | Get-View<br/>
ForEach($pg in $pgs){<br/>
$spec = New-Object VMware.Vim.DVPortgroupConfigSpec<br/>
$spec.configversion = $pg.Config.ConfigVersion<br/>
$spec.defaultPortConfig = New-Object VMware.Vim.VMwareDVSPortSetting<br/>
$spec.defaultPortConfig.ipfixEnabled = New-Object VMware.Vim.BoolPolicy<br/>
$spec.defaultPortConfig.ipfixEnabled.inherited = $false<br/>
$spec.defaultPortConfig.ipfixEnabled.value = $false<br/>
$pg.ReconfigureDVPortgroup_Task($spec)<br/>
}</td>
          </tr>
          <tr>
            <th class="ruledata">References:</th>
            <td class="ruledata">
              <ul class="ruledata">
                <li>CCI-000366</li>
              </ul>
            </td>
          </tr>
        </table>
        <br/>
        <a name="RULE_SV-104575r1_rule">
          <table class="ruleblock">
            <tr class="ruleblock">
              <td class="ruleblock"><span class="ruleheader">STIG ID:</span><br/>VCWN-65-000017</td>
              <td class="ruleblock"><span class="ruleheader">Group ID:</span><br/>V-94745</td>
              <td class="ruleblock"><span class="ruleheader">Rule ID:</span><br/>SV-104575r1_rule</td>
              <td class="ruleblock"><span class="ruleheader">Severity:</span><br/>CAT III</td>
            </tr>
          </table>
        </a>
        <table class="ruledata">
          <tr>
            <th class="ruledata">Requirement:</th>
            <td class="ruledata">
              <span class="rulerequirement">The vCenter Server for Windows must not override port group settings at the port level on distributed switches.</span>
            </td>
          </tr>
          <tr>
            <th class="ruledata">Discussion:</th>
            <td class="ruledata">Port-level configuration overrides are disabled by default. Once enabled, this allows for different security settings to be set from what is established at the Port-Group level. There are cases where particular VMs require unique configurations, but this should be monitored so it is only used when authorized. If overrides are not monitored, anyone who gains access to a VM with a less secure VDS configuration could surreptitiously exploit that broader access.</td>
          </tr>
          <tr>
            <th class="ruledata">Check:</th>
            <td class="ruledata">From the vSphere Web Client go to Networking &gt;&gt; Select a distributed switch &gt;&gt; Select a distributed port group &gt;&gt; Configure &gt;&gt; Settings &gt;&gt; Properties. <br/>
<br/>
View the Properties pane and verify all Override port policies are set to disabled.<br/>
<br/>
or<br/>
<br/>
From a PowerCLI command prompt while connected to the vCenter server run the following command:<br/>
Get-VDPortgroup | Get-View | <br/>
Select Name,<br/>
@{N="VlanOverrideAllowed";E={$_.Config.Policy.VlanOverrideAllowed}},<br/>
@{N="UplinkTeamingOverrideAllowed";E={$_.Config.Policy.UplinkTeamingOverrideAllowed}},<br/>
@{N="SecurityPolicyOverrideAllowed";E={$_.Config.Policy.SecurityPolicyOverrideAllowed}},<br/>
@{N="IpfixOverrideAllowed";E={$_.Config.Policy.IpfixOverrideAllowed}},<br/>
@{N="BlockOverrideAllowed";E={$_.Config.Policy.BlockOverrideAllowed}},<br/>
@{N="ShapingOverrideAllowed";E={$_.Config.Policy.ShapingOverrideAllowed}},<br/>
@{N="VendorConfigOverrideAllowed";E={$_.Config.Policy.VendorConfigOverrideAllowed}},<br/>
@{N="TrafficFilterOverrideAllowed";E={$_.Config.Policy.TrafficFilterOverrideAllowed}},<br/>
@{N="PortConfigResetAtDisconnect";E={$_.Config.Policy.PortConfigResetAtDisconnect}} | Sort Name<br/>
<br/>
Note: This was broken up into multiple lines for readability. Either paste as is into a PowerShell script or combine into one line and run.<br/>
<br/>
This does not apply to the reset port configuration on disconnect policy.<br/>
<br/>
If any port level overrides are enabled and not documented, this is a finding.</td>
          </tr>
          <tr>
            <th class="ruledata">Fix:</th>
            <td class="ruledata">From the vSphere Web Client go to Networking &gt;&gt; Select a distributed switch &gt;&gt; Select a distributed port group &gt;&gt; Configure &gt;&gt; Settings &gt;&gt; Properties. Click "Edit" and change all Override port policies to disabled.<br/>
<br/>
From a PowerCLI command prompt while connected to the vCenter server run the following commands:<br/>
$pgs = Get-VDPortgroup | Get-View<br/>
ForEach($pg in $pgs){<br/>
$spec = New-Object VMware.Vim.DVPortgroupConfigSpec<br/>
$spec.configversion = $pg.Config.ConfigVersion<br/>
$spec.Policy = New-Object VMware.Vim.VMwareDVSPortgroupPolicy<br/>
$spec.Policy.VlanOverrideAllowed = $False<br/>
$spec.Policy.UplinkTeamingOverrideAllowed = $False<br/>
$spec.Policy.SecurityPolicyOverrideAllowed = $False<br/>
$spec.Policy.IpfixOverrideAllowed = $False<br/>
$spec.Policy.BlockOverrideAllowed = $False<br/>
$spec.Policy.ShapingOverrideAllowed = $False<br/>
$spec.Policy.VendorConfigOverrideAllowed = $False<br/>
$spec.Policy.TrafficFilterOverrideAllowed = $False<br/>
$spec.Policy.PortConfigResetAtDisconnect = $True<br/>
$pg.ReconfigureDVPortgroup_Task($spec)<br/>
}</td>
          </tr>
          <tr>
            <th class="ruledata">References:</th>
            <td class="ruledata">
              <ul class="ruledata">
                <li>CCI-000366</li>
              </ul>
            </td>
          </tr>
        </table>
        <br/>
        <a name="RULE_SV-104577r1_rule">
          <table class="ruleblock">
            <tr class="ruleblock">
              <td class="ruleblock"><span class="ruleheader">STIG ID:</span><br/>VCWN-65-000018</td>
              <td class="ruleblock"><span class="ruleheader">Group ID:</span><br/>V-94747</td>
              <td class="ruleblock"><span class="ruleheader">Rule ID:</span><br/>SV-104577r1_rule</td>
              <td class="ruleblock"><span class="ruleheader">Severity:</span><br/>CAT II</td>
            </tr>
          </table>
        </a>
        <table class="ruledata">
          <tr>
            <th class="ruledata">Requirement:</th>
            <td class="ruledata">
              <span class="rulerequirement">The vCenter Server for Windows must configure all port groups to a value other than that of the native VLAN.</span>
            </td>
          </tr>
          <tr>
            <th class="ruledata">Discussion:</th>
            <td class="ruledata">ESXi does not use the concept of native VLAN. Frames with VLAN specified in the port group will have a tag, but frames with VLAN not specified in the port group are not tagged and therefore will end up as belonging to native VLAN of the physical switch. For example, frames on VLAN 1 from a Cisco physical switch will be untagged, because this is considered as the native VLAN. However, frames from ESXi specified as VLAN 1 will be tagged with a "1"; therefore, traffic from ESXi that is destined for the native VLAN will not be correctly routed (because it is tagged with a "1" instead of being untagged), and traffic from the physical switch coming from the native VLAN will not be visible (because it is not tagged). If the ESXi virtual switch port group uses the native VLAN ID, traffic from those VMs will not be visible to the native VLAN on the switch, because the switch is expecting untagged traffic.</td>
          </tr>
          <tr>
            <th class="ruledata">Check:</th>
            <td class="ruledata">From the vSphere Web Client go to Networking &gt;&gt; Select a distributed switch &gt;&gt; Select a distributed port group &gt;&gt; Configure &gt;&gt; Settings &gt;&gt; Policies. <br/>
<br/>
Review the port group VLAN tags and verify they are not set to the native VLAN ID of the attached physical switch.<br/>
<br/>
or<br/>
<br/>
From a PowerCLI command prompt while connected to the vCenter server run the following command:<br/>
Get-VDPortgroup | select Name, VlanConfiguration<br/>
<br/>
If any port group is configured with the native VLAN of the ESXi hosts attached physical switch, this is a finding.</td>
          </tr>
          <tr>
            <th class="ruledata">Fix:</th>
            <td class="ruledata">From the vSphere Web Client go to Networking &gt;&gt; Select a distributed switch &gt;&gt; Select a distributed port group &gt;&gt; Configure &gt;&gt; Settings &gt;&gt; Policies. Click "Edit" and under the VLAN section change the VLAN ID to a non-native VLAN and click "OK".<br/>
<br/>
or<br/>
<br/>
From a PowerCLI command prompt while connected to the vCenter server run the following command:<br/>
Get-VDPortgroup "portgroup name" | Set-VDVlanConfiguration -VlanId "New VLAN#"</td>
          </tr>
          <tr>
            <th class="ruledata">References:</th>
            <td class="ruledata">
              <ul class="ruledata">
                <li>CCI-000366</li>
              </ul>
            </td>
          </tr>
        </table>
        <br/>
        <a name="RULE_SV-104579r1_rule">
          <table class="ruleblock">
            <tr class="ruleblock">
              <td class="ruleblock"><span class="ruleheader">STIG ID:</span><br/>VCWN-65-000019</td>
              <td class="ruleblock"><span class="ruleheader">Group ID:</span><br/>V-94749</td>
              <td class="ruleblock"><span class="ruleheader">Rule ID:</span><br/>SV-104579r1_rule</td>
              <td class="ruleblock"><span class="ruleheader">Severity:</span><br/>CAT II</td>
            </tr>
          </table>
        </a>
        <table class="ruledata">
          <tr>
            <th class="ruledata">Requirement:</th>
            <td class="ruledata">
              <span class="rulerequirement">The vCenter Server for Windows must configure all port groups to VLAN 4095 unless Virtual Guest Tagging (VGT) is required.</span>
            </td>
          </tr>
          <tr>
            <th class="ruledata">Discussion:</th>
            <td class="ruledata">When a port group is set to VLAN 4095, this activates VGT mode. In this mode, the vSwitch passes all network frames to the guest VM without modifying the VLAN tags, leaving it up to the guest to deal with them. VLAN 4095 should be used only if the guest has been specifically configured to manage VLAN tags itself. If VGT is enabled inappropriately, it might cause denial-of-service or allow a guest VM to interact with traffic on an unauthorized VLAN.</td>
          </tr>
          <tr>
            <th class="ruledata">Check:</th>
            <td class="ruledata">From the vSphere Web Client go to Networking &gt;&gt; Select a distributed switch &gt;&gt; Select a distributed port group &gt;&gt; Configure &gt;&gt; Settings &gt;&gt; Policies. <br/>
<br/>
Review the port group VLAN tags and verify they are not set to 4095.<br/>
<br/>
or<br/>
<br/>
From a PowerCLI command prompt while connected to the vCenter server run the following command:<br/>
Get-VDPortgroup | select Name, VlanConfiguration<br/>
<br/>
If any port group is configured with VLAN 4095 and is not documented as a needed exception, this is a finding.</td>
          </tr>
          <tr>
            <th class="ruledata">Fix:</th>
            <td class="ruledata">From the vSphere Web Client go to Networking &gt;&gt; Select a distributed switch &gt;&gt; Select a distributed port group &gt;&gt; Configure &gt;&gt; Settings &gt;&gt; Policies. Click "Edit" and under the VLAN section change the VLAN ID to an appropriate VLAN ID other than "4095" and click "OK".<br/>
<br/>
or<br/>
<br/>
From a PowerCLI command prompt while connected to the vCenter server run the following command:<br/>
Get-VDPortgroup "portgroup name" | Set-VDVlanConfiguration -VlanId "New VLAN#"</td>
          </tr>
          <tr>
            <th class="ruledata">References:</th>
            <td class="ruledata">
              <ul class="ruledata">
                <li>CCI-000366</li>
              </ul>
            </td>
          </tr>
        </table>
        <br/>
        <a name="RULE_SV-104581r1_rule">
          <table class="ruleblock">
            <tr class="ruleblock">
              <td class="ruleblock"><span class="ruleheader">STIG ID:</span><br/>VCWN-65-000020</td>
              <td class="ruleblock"><span class="ruleheader">Group ID:</span><br/>V-94751</td>
              <td class="ruleblock"><span class="ruleheader">Rule ID:</span><br/>SV-104581r1_rule</td>
              <td class="ruleblock"><span class="ruleheader">Severity:</span><br/>CAT II</td>
            </tr>
          </table>
        </a>
        <table class="ruledata">
          <tr>
            <th class="ruledata">Requirement:</th>
            <td class="ruledata">
              <span class="rulerequirement">The vCenter Server for Windows must not configure all port groups to VLAN values reserved by upstream physical switches.</span>
            </td>
          </tr>
          <tr>
            <th class="ruledata">Discussion:</th>
            <td class="ruledata">Certain physical switches reserve certain VLAN IDs for internal purposes and often disallow traffic configured to these values. For example, Cisco Catalyst switches typically reserve VLANs 1001–1024 and 4094, while Nexus switches typically reserve 3968–4047 and 4094. Check with the documentation for your specific switch. Using a reserved VLAN might result in a denial of service on the network.</td>
          </tr>
          <tr>
            <th class="ruledata">Check:</th>
            <td class="ruledata">From the vSphere Web Client go to Networking &gt;&gt; Select a distributed switch &gt;&gt; Select a distributed port group &gt;&gt; Configure &gt;&gt; Settings &gt;&gt; Policies. <br/>
<br/>
Review the port group VLAN tags and verify they are not set to a reserved VLAN ID.<br/>
<br/>
or<br/>
<br/>
From a PowerCLI command prompt while connected to the vCenter server run the following command:<br/>
Get-VDPortgroup | select Name, VlanConfiguration<br/>
<br/>
If any port group is configured with a reserved VLAN ID, this is a finding.</td>
          </tr>
          <tr>
            <th class="ruledata">Fix:</th>
            <td class="ruledata">From the vSphere Web Client go to Networking &gt;&gt; Select a distributed switch &gt;&gt; Select a distributed port group &gt;&gt; Configure &gt;&gt; Settings &gt;&gt; Policies. Click "Edit" and under the VLAN section and change the VLAN ID to an unreserved VLAN ID and click "OK".<br/>
<br/>
or<br/>
<br/>
From a PowerCLI command prompt while connected to the vCenter server run the following command:<br/>
Get-VDPortgroup "portgroup name" | Set-VDVlanConfiguration -VlanId "New VLAN#"</td>
          </tr>
          <tr>
            <th class="ruledata">References:</th>
            <td class="ruledata">
              <ul class="ruledata">
                <li>CCI-000366</li>
              </ul>
            </td>
          </tr>
        </table>
        <br/>
        <a name="RULE_SV-104583r1_rule">
          <table class="ruleblock">
            <tr class="ruleblock">
              <td class="ruleblock"><span class="ruleheader">STIG ID:</span><br/>VCWN-65-000021</td>
              <td class="ruleblock"><span class="ruleheader">Group ID:</span><br/>V-94753</td>
              <td class="ruleblock"><span class="ruleheader">Rule ID:</span><br/>SV-104583r1_rule</td>
              <td class="ruleblock"><span class="ruleheader">Severity:</span><br/>CAT II</td>
            </tr>
          </table>
        </a>
        <table class="ruledata">
          <tr>
            <th class="ruledata">Requirement:</th>
            <td class="ruledata">
              <span class="rulerequirement">The vCenter Server for Windows must enable SSL for Network File Copy (NFC).</span>
            </td>
          </tr>
          <tr>
            <th class="ruledata">Discussion:</th>
            <td class="ruledata">NFC is the mechanism used to migrate or clone a VM between two ESXi hosts over the network. By default, NFC over SSL is enabled (i.e., "True") within a vSphere cluster but the value of the setting is null. Clients check the value of the setting and default to not using SSL for performance reasons if the value is null. This behavior can be changed by ensuring the setting has been explicitly created and set to "True". This will force clients to use SSL. Without this setting VM contents could potentially be sniffed if the management network is not adequately isolated and secured.</td>
          </tr>
          <tr>
            <th class="ruledata">Check:</th>
            <td class="ruledata">From the vSphere Web Client go to vCenter Inventory Lists &gt;&gt; vCenter Servers &gt;&gt; Select your vCenter Server &gt;&gt; Manage &gt;&gt; Settings &gt;&gt; Advanced Settings.  <br/>
<br/>
Verify that config.nfc.useSSL is set to "true".<br/>
<br/>
or<br/>
<br/>
From a PowerCLI command prompt while connected to the vCenter server run the following command:<br/>
Get-AdvancedSetting -Entity &lt;vcenter server name&gt; -Name config.nfc.useSSL<br/>
<br/>
Verify "config.nfc.useSSL" is set to "true".<br/>
<br/>
If the "config.nfc.useSSL" is set to a value other than "true" or does not exist, this is a finding.</td>
          </tr>
          <tr>
            <th class="ruledata">Fix:</th>
            <td class="ruledata">From the vSphere Web Client go to vCenter Inventory Lists &gt;&gt; vCenter Servers &gt;&gt; Select your vCenter Server &gt;&gt; Manage &gt;&gt; Settings &gt;&gt; Advanced Settings.  Click "Edit" and edit the "config.nfc.useSSL" value to "true" or if the value does not exist create it by entering the values in the "Key" and "Value" fields and clicking "Add".<br/>
<br/>
or<br/>
<br/>
From a PowerCLI command prompt while connected to the vCenter server run the following command:<br/>
<br/>
If the setting already exists:<br/>
Get-AdvancedSetting -Entity &lt;vcenter server name&gt; -Name config.nfc.useSSL | Set-AdvancedSetting -Value true<br/>
<br/>
If the setting does not exist:<br/>
New-AdvancedSetting -Entity &lt;vcenter server name&gt; -Name config.nfc.useSSL -Value true</td>
          </tr>
          <tr>
            <th class="ruledata">References:</th>
            <td class="ruledata">
              <ul class="ruledata">
                <li>CCI-000366</li>
              </ul>
            </td>
          </tr>
        </table>
        <br/>
        <a name="RULE_SV-104585r1_rule">
          <table class="ruleblock">
            <tr class="ruleblock">
              <td class="ruleblock"><span class="ruleheader">STIG ID:</span><br/>VCWN-65-000022</td>
              <td class="ruleblock"><span class="ruleheader">Group ID:</span><br/>V-94755</td>
              <td class="ruleblock"><span class="ruleheader">Rule ID:</span><br/>SV-104585r1_rule</td>
              <td class="ruleblock"><span class="ruleheader">Severity:</span><br/>CAT II</td>
            </tr>
          </table>
        </a>
        <table class="ruledata">
          <tr>
            <th class="ruledata">Requirement:</th>
            <td class="ruledata">
              <span class="rulerequirement">The vCenter Server for Windows services must be ran using a service account instead of a built-in Windows account.</span>
            </td>
          </tr>
          <tr>
            <th class="ruledata">Discussion:</th>
            <td class="ruledata">You can use the Microsoft Windows built-in system account or a domain user account to run vCenter Server.  The Microsoft Windows built-in system account has more permissions and rights on the server than the vCenter Server system requires, which can contribute to security problems. With a domain user account, you can enable Windows authentication for SQL Server; it also allows more granular security and logging. The installing account only needs to be a member of the Administrators group, and have permission to act as part of the operating system and log on as a service. If you are using SQL Server for the vCenter database, you must configure the SQL Server database to allow the domain account access to SQL Server.</td>
          </tr>
          <tr>
            <th class="ruledata">Check:</th>
            <td class="ruledata">This control only applies to Windows based vCenter installations.<br/>
<br/>
The following services should be set to run as a service account:<br/>
<br/>
VMware Content Library Service<br/>
VMware Inventory Service<br/>
VMware Performance Charts<br/>
VMware VirtualCenter Server<br/>
<br/>
vCenter should be installed using the service account as that will configure the services appropriately.<br/>
<br/>
If vCenter is not installed with a service account, this is a finding.<br/>
<br/>
If the services identified in this control are not running as a service account, this is a finding.</td>
          </tr>
          <tr>
            <th class="ruledata">Fix:</th>
            <td class="ruledata">For each of the following services open the services console on the vCenter server and right-click, select "Properties" on the service.  Go to the "Log On" tab and configure the service to run as a service account and restart the service.<br/>
<br/>
VMware Content Library Service<br/>
VMware Inventory Service<br/>
VMware Performance Charts<br/>
VMware VirtualCenter Server</td>
          </tr>
          <tr>
            <th class="ruledata">References:</th>
            <td class="ruledata">
              <ul class="ruledata">
                <li>CCI-000366</li>
              </ul>
            </td>
          </tr>
        </table>
        <br/>
        <a name="RULE_SV-104587r2_rule">
          <table class="ruleblock">
            <tr class="ruleblock">
              <td class="ruleblock"><span class="ruleheader">STIG ID:</span><br/>VCWN-65-000023</td>
              <td class="ruleblock"><span class="ruleheader">Group ID:</span><br/>V-94757</td>
              <td class="ruleblock"><span class="ruleheader">Rule ID:</span><br/>SV-104587r2_rule</td>
              <td class="ruleblock"><span class="ruleheader">Severity:</span><br/>CAT II</td>
            </tr>
          </table>
        </a>
        <table class="ruledata">
          <tr>
            <th class="ruledata">Requirement:</th>
            <td class="ruledata">
              <span class="rulerequirement">The vCenter Server for Windows must configure the vpxuser auto-password to be changed every 30 days.</span>
            </td>
          </tr>
          <tr>
            <th class="ruledata">Discussion:</th>
            <td class="ruledata">By default, the vpxuser password will be automatically changed by vCenter every 30 days. Ensure this setting meets your policies; if not, configure to meet password aging policies. <br/>
<br/>
Note: It is very important the password aging policy not be shorter than the default interval that is set to automatically change the vpxuser password, to preclude the possibility that vCenter might get locked out of an ESXi host.</td>
          </tr>
          <tr>
            <th class="ruledata">Check:</th>
            <td class="ruledata">Select the vCenter Server in the vSphere Web Client object hierarchy.<br/>
Click Configure.<br/>
Click Advanced Settings and enter VimPasswordExpirationInDays in the filter box.<br/>
Verify "VirtualCenter.VimPasswordExpirationInDays" is set to "30".<br/>
<br/>
or<br/>
<br/>
From a PowerCLI command prompt while connected to the vCenter server run the following command:<br/>
Get-AdvancedSetting -Entity &lt;vcenter server name&gt; -Name VirtualCenter.VimPasswordExpirationInDays and verify it is set to 30.<br/>
<br/>
If the "VirtualCenter.VimPasswordExpirationInDays" is set to a value other than "30" or does not exist, this is a finding.</td>
          </tr>
          <tr>
            <th class="ruledata">Fix:</th>
            <td class="ruledata">Select the vCenter Server in the vSphere Web Client object hierarchy.<br/>
Click Configure.<br/>
Click Advanced Settings and enter VimPasswordExpirationInDays in the filter box.<br/>
Set "VirtualCenter.VimPasswordExpirationInDays" to "30".<br/>
<br/>
or<br/>
<br/>
From a PowerCLI command prompt while connected to the vCenter server run the following command:<br/>
<br/>
If the setting already exists:<br/>
Get-AdvancedSetting -Entity &lt;vcenter server name&gt; -Name VirtualCenter.VimPasswordExpirationInDays | Set-AdvancedSetting -Value 30<br/>
<br/>
If the setting does not exist:<br/>
New-AdvancedSetting -Entity &lt;vcenter server name&gt; -Name VirtualCenter.VimPasswordExpirationInDays -Value 30</td>
          </tr>
          <tr>
            <th class="ruledata">References:</th>
            <td class="ruledata">
              <ul class="ruledata">
                <li>CCI-000366</li>
              </ul>
            </td>
          </tr>
        </table>
        <br/>
        <a name="RULE_SV-104589r1_rule">
          <table class="ruleblock">
            <tr class="ruleblock">
              <td class="ruleblock"><span class="ruleheader">STIG ID:</span><br/>VCWN-65-000024</td>
              <td class="ruleblock"><span class="ruleheader">Group ID:</span><br/>V-94759</td>
              <td class="ruleblock"><span class="ruleheader">Rule ID:</span><br/>SV-104589r1_rule</td>
              <td class="ruleblock"><span class="ruleheader">Severity:</span><br/>CAT II</td>
            </tr>
          </table>
        </a>
        <table class="ruledata">
          <tr>
            <th class="ruledata">Requirement:</th>
            <td class="ruledata">
              <span class="rulerequirement">The vCenter Server for Windows must configure the vpxuser password meets length policy.</span>
            </td>
          </tr>
          <tr>
            <th class="ruledata">Discussion:</th>
            <td class="ruledata">The vpxuser password default length is 32 characters. Ensure this setting meets site policies; if not, configure to meet password length policies. Longer passwords make brute-force password attacks more difficult. The vpxuser password is added by vCenter, meaning no manual intervention is normally required. The vpxuser password length must never be modified to less than the default length of 32 characters.</td>
          </tr>
          <tr>
            <th class="ruledata">Check:</th>
            <td class="ruledata">From the vSphere Web Client go to Host and Clusters &gt;&gt; Select a vCenter Server &gt;&gt; Configure &gt;&gt; Settings &gt;&gt; Advanced Settings. <br/>
<br/>
Verify that "config.vpxd.hostPasswordLength" is set to "32".<br/>
<br/>
or<br/>
<br/>
From a PowerCLI command prompt while connected to the vCenter server run the following command:<br/>
Get-AdvancedSetting -Entity &lt;vcenter server name&gt; -Name config.vpxd.hostPasswordLength and verify it is set to 32.<br/>
<br/>
If the "config.vpxd.hostPasswordLength" is set to a value other than "32" or does not exist, this is a finding.</td>
          </tr>
          <tr>
            <th class="ruledata">Fix:</th>
            <td class="ruledata">From the vSphere Web Client go to Host and Clusters &gt;&gt; Select a vCenter Server &gt;&gt; Configure &gt;&gt; Settings &gt;&gt; Advanced Settings. Click "Edit" and edit the "config.vpxd.hostPasswordLength" value to "32" or if the value does not exist create it by entering the values in the "Key" and "Value" fields and clicking "Add".<br/>
<br/>
or<br/>
<br/>
From a PowerCLI command prompt while connected to the vCenter server run the following command:<br/>
<br/>
If the setting already exists:<br/>
Get-AdvancedSetting -Entity &lt;vcenter server name&gt; -Name config.vpxd.hostPasswordLength | Set-AdvancedSetting -Value 32<br/>
<br/>
If the setting does not exist:<br/>
New-AdvancedSetting -Entity &lt;vcenter server name&gt; -Name config.vpxd.hostPasswordLength -Value 32</td>
          </tr>
          <tr>
            <th class="ruledata">References:</th>
            <td class="ruledata">
              <ul class="ruledata">
                <li>CCI-000366</li>
              </ul>
            </td>
          </tr>
        </table>
        <br/>
        <a name="RULE_SV-104591r1_rule">
          <table class="ruleblock">
            <tr class="ruleblock">
              <td class="ruleblock"><span class="ruleheader">STIG ID:</span><br/>VCWN-65-000025</td>
              <td class="ruleblock"><span class="ruleheader">Group ID:</span><br/>V-94761</td>
              <td class="ruleblock"><span class="ruleheader">Rule ID:</span><br/>SV-104591r1_rule</td>
              <td class="ruleblock"><span class="ruleheader">Severity:</span><br/>CAT III</td>
            </tr>
          </table>
        </a>
        <table class="ruledata">
          <tr>
            <th class="ruledata">Requirement:</th>
            <td class="ruledata">
              <span class="rulerequirement">The vCenter Server for Windows must disable the managed object browser at all times, when not required for the purpose of troubleshooting or maintenance of managed objects.</span>
            </td>
          </tr>
          <tr>
            <th class="ruledata">Discussion:</th>
            <td class="ruledata">The managed object browser provides a way to explore the object model used by the vCenter to manage the vSphere environment; it enables configurations to be changed as well. This interface is used primarily for debugging, and might potentially be used to perform malicious configuration changes or actions.</td>
          </tr>
          <tr>
            <th class="ruledata">Check:</th>
            <td class="ruledata">The Managed Object Browser (MOB) was designed to be used by SDK developers to assist in the development, programming, and debugging of objects. It is an inventory object, full-access interface, allowing attackers to determine the inventory path of an infrastructure's managed entities. <br/>
<br/>
Check the operational status of the MOB:<br/>
Determine the location of the vpxd.cfg file on the vCenter Server's Windows OS host.<br/>
Edit the file and locate the &lt;vpxd&gt; ... &lt;/vpxd&gt; element.<br/>
Ensure the following element is set. &lt;enableDebugBrowse&gt;false&lt;/enableDebugBrowse&gt; <br/>
<br/>
If the MOB is currently enabled, ask the SA if it is being used for object maintenance. <br/>
<br/>
If the "enableDebugBrowse" element is enabled (set to true), and object maintenance is not being performed, this is a finding.</td>
          </tr>
          <tr>
            <th class="ruledata">Fix:</th>
            <td class="ruledata">If the datastore browser is enabled and required for object maintenance, no fix is immediately required.<br/>
<br/>
Disable the managed object browser:<br/>
Determine the location of the vpxd.cfg file on the Windows host.<br/>
Edit the file and locate the &lt;vpxd&gt; ... &lt;/vpxd&gt; element.<br/>
Ensure the following element is set. &lt;enableDebugBrowse&gt;false&lt;/enableDebugBrowse&gt; <br/>
<br/>
Restart the vCenter Service to ensure the configuration file change(s) are in effect.</td>
          </tr>
          <tr>
            <th class="ruledata">References:</th>
            <td class="ruledata">
              <ul class="ruledata">
                <li>CCI-000366</li>
              </ul>
            </td>
          </tr>
        </table>
        <br/>
        <a name="RULE_SV-104675r1_rule">
          <table class="ruleblock">
            <tr class="ruleblock">
              <td class="ruleblock"><span class="ruleheader">STIG ID:</span><br/>VCWN-65-000026</td>
              <td class="ruleblock"><span class="ruleheader">Group ID:</span><br/>V-94845</td>
              <td class="ruleblock"><span class="ruleheader">Rule ID:</span><br/>SV-104675r1_rule</td>
              <td class="ruleblock"><span class="ruleheader">Severity:</span><br/>CAT II</td>
            </tr>
          </table>
        </a>
        <table class="ruledata">
          <tr>
            <th class="ruledata">Requirement:</th>
            <td class="ruledata">
              <span class="rulerequirement">The vCenter Server for Windows must check the privilege re-assignment after restarts.</span>
            </td>
          </tr>
          <tr>
            <th class="ruledata">Discussion:</th>
            <td class="ruledata">Check for privilege reassignment when you restart vCenter Server. If the user or user group that is assigned the Administrator role on the root folder cannot be verified as a valid user or group during a restart, the role is removed from that user or group. In its place, vCenter Server grants the Administrator role to the vCenter Single Sign-On account administrator@vsphere.local. This account can then act as the administrator.<br/>
<br/>
Reestablish a named administrator account and assign the Administrator role to that account to avoid using the anonymous administrator@vsphere.local account.</td>
          </tr>
          <tr>
            <th class="ruledata">Check:</th>
            <td class="ruledata">After the Windows server hosting the vCenter Server has been rebooted, a vCenter Server user or member of the user group granted the administrator role must log in and verify the role permissions remain intact. <br/>
<br/>
If the user and/or user group granted vCenter administrator role permissions cannot be verified as intact, this is a finding.</td>
          </tr>
          <tr>
            <th class="ruledata">Fix:</th>
            <td class="ruledata">As the SSO Administrator, log in to the vCenter Server and restore a legitimate administrator account per site-specific user/group/role requirements.</td>
          </tr>
          <tr>
            <th class="ruledata">References:</th>
            <td class="ruledata">
              <ul class="ruledata">
                <li>CCI-000366</li>
              </ul>
            </td>
          </tr>
        </table>
        <br/>
        <a name="RULE_SV-104593r1_rule">
          <table class="ruleblock">
            <tr class="ruleblock">
              <td class="ruleblock"><span class="ruleheader">STIG ID:</span><br/>VCWN-65-000027</td>
              <td class="ruleblock"><span class="ruleheader">Group ID:</span><br/>V-94763</td>
              <td class="ruleblock"><span class="ruleheader">Rule ID:</span><br/>SV-104593r1_rule</td>
              <td class="ruleblock"><span class="ruleheader">Severity:</span><br/>CAT I</td>
            </tr>
          </table>
        </a>
        <table class="ruledata">
          <tr>
            <th class="ruledata">Requirement:</th>
            <td class="ruledata">
              <span class="rulerequirement">The vCenter Server for Windows must minimize access to the vCenter server.</span>
            </td>
          </tr>
          <tr>
            <th class="ruledata">Discussion:</th>
            <td class="ruledata">After someone has logged in to the vCenter Server system, it becomes more difficult to prevent what they can do. In general, logging in to the vCenter Server system should be limited to very privileged administrators, and then only for the purpose of administering vCenter Server or the host OS. Anyone logged in to the vCenter Server can potentially cause harm, either intentionally or unintentionally, by altering settings and modifying processes. They also have potential access to vCenter credentials, such as the SSL certificate.</td>
          </tr>
          <tr>
            <th class="ruledata">Check:</th>
            <td class="ruledata">Login to the vCenter server and verify the only local administrators group contains users and/or groups that contain vCenter Administrators.<br/>
<br/>
If the local administrators group contains users and/or groups that are not vCenter Administrators such as "Domain Admins", this is a finding.</td>
          </tr>
          <tr>
            <th class="ruledata">Fix:</th>
            <td class="ruledata">Remove all unnecessary users and/or groups from the local administrators group of the vCenter server.</td>
          </tr>
          <tr>
            <th class="ruledata">References:</th>
            <td class="ruledata">
              <ul class="ruledata">
                <li>CCI-000366</li>
              </ul>
            </td>
          </tr>
        </table>
        <br/>
        <a name="RULE_SV-104595r1_rule">
          <table class="ruleblock">
            <tr class="ruleblock">
              <td class="ruleblock"><span class="ruleheader">STIG ID:</span><br/>VCWN-65-000028</td>
              <td class="ruleblock"><span class="ruleheader">Group ID:</span><br/>V-94765</td>
              <td class="ruleblock"><span class="ruleheader">Rule ID:</span><br/>SV-104595r1_rule</td>
              <td class="ruleblock"><span class="ruleheader">Severity:</span><br/>CAT II</td>
            </tr>
          </table>
        </a>
        <table class="ruledata">
          <tr>
            <th class="ruledata">Requirement:</th>
            <td class="ruledata">
              <span class="rulerequirement">The vCenter Server for Windows Administrators must clean up log files after failed installations.</span>
            </td>
          </tr>
          <tr>
            <th class="ruledata">Discussion:</th>
            <td class="ruledata">In certain cases, if the vCenter installation fails, a log file (with a name of the form “hs_err_pidXXXX”) is created that contains the database password in plain text. An attacker who breaks into the vCenter Server could potentially steal this password and access the vCenter Database.</td>
          </tr>
          <tr>
            <th class="ruledata">Check:</th>
            <td class="ruledata">If at any time a vCenter Server installation fails, only the log files of format "hs_err_pid...." should be identified on the Windows host and deleted securely before putting the host into production. Determine if a site policy exists for handling failed installation cleanup of the Windows host prior to deployment. Using the Windows host search function, determine the existence of any log files of format "hs_err_pid".<br/>
<br/>
If a file name of the format "hs_err_pid" is found, this is a finding.<br/>
<br/>
If a site policy does not exist and/or is not followed, this is a finding.</td>
          </tr>
          <tr>
            <th class="ruledata">Fix:</th>
            <td class="ruledata">Develop a site policy for handling failed installation cleanup of the Windows host prior to deployment. Using the Windows host search function, determine the existence of any log files of format "hs_err_pid" and remove them.</td>
          </tr>
          <tr>
            <th class="ruledata">References:</th>
            <td class="ruledata">
              <ul class="ruledata">
                <li>CCI-000366</li>
              </ul>
            </td>
          </tr>
        </table>
        <br/>
        <a name="RULE_SV-104597r1_rule">
          <table class="ruleblock">
            <tr class="ruleblock">
              <td class="ruleblock"><span class="ruleheader">STIG ID:</span><br/>VCWN-65-000029</td>
              <td class="ruleblock"><span class="ruleheader">Group ID:</span><br/>V-94767</td>
              <td class="ruleblock"><span class="ruleheader">Rule ID:</span><br/>SV-104597r1_rule</td>
              <td class="ruleblock"><span class="ruleheader">Severity:</span><br/>CAT II</td>
            </tr>
          </table>
        </a>
        <table class="ruledata">
          <tr>
            <th class="ruledata">Requirement:</th>
            <td class="ruledata">
              <span class="rulerequirement">The vCenter Server for Windows must enable all tasks to be shown to Administrators in the Web Client.</span>
            </td>
          </tr>
          <tr>
            <th class="ruledata">Discussion:</th>
            <td class="ruledata">By default not all tasks are shown in the web client to administrators and only that user's tasks will be shown.  Enabling all tasks to be shown will allow the administrator to potentially see any malicious activity they may miss with the view disabled.</td>
          </tr>
          <tr>
            <th class="ruledata">Check:</th>
            <td class="ruledata">Verify the "webclient.properties" file contains the line "show.allusers.tasks = true".<br/>
<br/>
The default location for the "webclient.properties" file are:<br/>
<br/>
Appliance: <br/>
/etc/vmware/vsphere-client/ <br/>
<br/>
Windows: <br/>
C:\ProgramData\VMware\vCenterServer\cfg\vsphere-client\<br/>
<br/>
If "show.allusers.tasks" is not set to "true", this is a finding.</td>
          </tr>
          <tr>
            <th class="ruledata">Fix:</th>
            <td class="ruledata">Edit the "webclient.properties" file to set the "show.allusers.tasks" value to "true".<br/>
<br/>
The default location for the "webclient.properties" file are:<br/>
<br/>
Appliance: <br/>
/etc/vmware/vsphere-client/ <br/>
<br/>
Windows: <br/>
C:\ProgramData\VMware\vCenterServer\cfg\vsphere-client\<br/>
<br/>
After editing the file the vSphere Web Client service will need to be restarted.</td>
          </tr>
          <tr>
            <th class="ruledata">References:</th>
            <td class="ruledata">
              <ul class="ruledata">
                <li>CCI-000366</li>
              </ul>
            </td>
          </tr>
        </table>
        <br/>
        <a name="RULE_SV-104599r1_rule">
          <table class="ruleblock">
            <tr class="ruleblock">
              <td class="ruleblock"><span class="ruleheader">STIG ID:</span><br/>VCWN-65-000030</td>
              <td class="ruleblock"><span class="ruleheader">Group ID:</span><br/>V-94769</td>
              <td class="ruleblock"><span class="ruleheader">Rule ID:</span><br/>SV-104599r1_rule</td>
              <td class="ruleblock"><span class="ruleheader">Severity:</span><br/>CAT II</td>
            </tr>
          </table>
        </a>
        <table class="ruledata">
          <tr>
            <th class="ruledata">Requirement:</th>
            <td class="ruledata">
              <span class="rulerequirement">The vCenter Server for Windows Administrator role must be secured and assigned to specific users other than a Windows Administrator.</span>
            </td>
          </tr>
          <tr>
            <th class="ruledata">Discussion:</th>
            <td class="ruledata">By default, vCenter Server grants full administrative rights to the local administrator's account, which can be accessed by domain administrators. Separation of duties dictates that full vCenter Administrative rights should be granted only to those administrators who are required to have it. This privilege should not be granted to any group whose membership is not strictly controlled. Therefore, administrative rights should be removed from the local Windows server to users who are not vCenter administrators.</td>
          </tr>
          <tr>
            <th class="ruledata">Check:</th>
            <td class="ruledata">If enhanced linked mode is used then local windows authentication is not available to vCenter, this is not applicable.<br/>
<br/>
Under the computer management console for windows view the local administrators group and verify only vCenter administrators have access to the vCenter server.<br/>
<br/>
Other groups and users that are not vCenter administrators should be removed from the local administrators group such as Domain Admins.<br/>
<br/>
If there are any groups or users present in the local administrators group of the vCenter server, this is a finding.</td>
          </tr>
          <tr>
            <th class="ruledata">Fix:</th>
            <td class="ruledata">Under the computer management console for windows view the local administrators group and remove any users or groups that do not fit the criteria defined in the check content.</td>
          </tr>
          <tr>
            <th class="ruledata">References:</th>
            <td class="ruledata">
              <ul class="ruledata">
                <li>CCI-000366</li>
              </ul>
            </td>
          </tr>
        </table>
        <br/>
        <a name="RULE_SV-104601r1_rule">
          <table class="ruleblock">
            <tr class="ruleblock">
              <td class="ruleblock"><span class="ruleheader">STIG ID:</span><br/>VCWN-65-000031</td>
              <td class="ruleblock"><span class="ruleheader">Group ID:</span><br/>V-94771</td>
              <td class="ruleblock"><span class="ruleheader">Rule ID:</span><br/>SV-104601r1_rule</td>
              <td class="ruleblock"><span class="ruleheader">Severity:</span><br/>CAT III</td>
            </tr>
          </table>
        </a>
        <table class="ruledata">
          <tr>
            <th class="ruledata">Requirement:</th>
            <td class="ruledata">
              <span class="rulerequirement">The vCenter Server for Windows must restrict the connectivity between Update Manager and public patch repositories by use of a separate Update Manager Download Server.</span>
            </td>
          </tr>
          <tr>
            <th class="ruledata">Discussion:</th>
            <td class="ruledata">The Update Manager Download Service (UMDS) is an optional module of the Update Manager. UMDS downloads upgrades for virtual appliances, patch metadata, patch binaries, and notifications that would not otherwise be available to the Update Manager server. For security reasons and deployment restrictions, the Update Manager must be installed in a secured network that is disconnected from the Internet. The Update Manager requires access to patch information to function properly. UMDS must be installed on a separate system that has Internet access to download upgrades, patch binaries, and patch metadata, and then export the downloads to a portable media drive so that they become accessible to the Update Manager server.</td>
          </tr>
          <tr>
            <th class="ruledata">Check:</th>
            <td class="ruledata">Check the following conditions:<br/>
The Update Manager must be configured to use the Update Manager Download Server. <br/>
The use of physical media to transfer update files to the Update Manager server (air gap model example: separate Update Manager Download Server which may source vendor patches externally via the Internet versus an internal, organization defined source) must be enforced with site policies.<br/>
<br/>
Verify the Update Manager download source is not the Internet. <br/>
To verify download settings, from the vSphere Client/vCenter Server system, click "Update Manager" under "Solutions and Applications".<br/>
On the "Configuration tab", under "Settings", click "Download Settings". In the "Download Sources" pane, verify "Direct connection to Internet" is not selected.<br/>
<br/>
If "Direct connection to Internet" is configured, this is a finding.<br/>
<br/>
If all of the above conditions are not met, this is a finding.</td>
          </tr>
          <tr>
            <th class="ruledata">Fix:</th>
            <td class="ruledata">Configure the Update Manager Server to use a separate Update Manager Download Server; the use of physical media to transfer updated files to the Update Manager server (air gap model) must be enforced and documented with organization policies. Configure the Update Manager Download Server and enable the Download Service. Patches must not be directly accessible to the Update Manager Server application from the Internet.<br/>
<br/>
To configure a Web server or local disk repository as a download source (i.e., "Direct connection to Internet" must not be selected as the source), from the vSphere Client/vCenter Server system, click "Update Manager" under "Solutions and Applications". On the "Configuration" tab, under "Settings", click "Download Settings". In the "Download Sources" pane, select "Use a shared repository". Enter the &lt;site-specific&gt; path or the URL to the shared repository. Click "Validate URL" to validate the path. Click "Apply".</td>
          </tr>
          <tr>
            <th class="ruledata">References:</th>
            <td class="ruledata">
              <ul class="ruledata">
                <li>CCI-000366</li>
              </ul>
            </td>
          </tr>
        </table>
        <br/>
        <a name="RULE_SV-104603r1_rule">
          <table class="ruleblock">
            <tr class="ruleblock">
              <td class="ruleblock"><span class="ruleheader">STIG ID:</span><br/>VCWN-65-000032</td>
              <td class="ruleblock"><span class="ruleheader">Group ID:</span><br/>V-94773</td>
              <td class="ruleblock"><span class="ruleheader">Rule ID:</span><br/>SV-104603r1_rule</td>
              <td class="ruleblock"><span class="ruleheader">Severity:</span><br/>CAT II</td>
            </tr>
          </table>
        </a>
        <table class="ruledata">
          <tr>
            <th class="ruledata">Requirement:</th>
            <td class="ruledata">
              <span class="rulerequirement">The vCenter Server for Windows must use a least-privileges assignment for the Update Manager database user.</span>
            </td>
          </tr>
          <tr>
            <th class="ruledata">Discussion:</th>
            <td class="ruledata">Least-privileges mitigate attacks if the Update Manager database account is compromised. The VMware Update Manager requires certain privileges for the database user in order to install, and the installer will automatically check for these. The privileges on the VUM database user must be reduced for normal operation.</td>
          </tr>
          <tr>
            <th class="ruledata">Check:</th>
            <td class="ruledata">Verify only the following permissions are allowed to the VUM database user.<br/>
<br/>
For Oracle DB normal operation, only the following permissions are required. <br/>
grant connect to vumAdmin<br/>
grant resource to vumAdmin<br/>
grant create any job to vumAdmin<br/>
grant create view to vumAdmin<br/>
grant create any sequence to vumAdmin<br/>
grant create any table to vumAdmin<br/>
grant lock any table to vumAdmin<br/>
grant create procedure to vumAdmin<br/>
grant create type to vumAdmin<br/>
grant execute on dbms_lock to vumAdmin<br/>
grant unlimited tablespace to vumAdmin<br/>
# To ensure space limitation is not an issue<br/>
<br/>
For SQL DB normal operation, make sure that the database user has either a sysadmin server role or the db_owner fixed database role on the Update Manager database and the MSDB database.<br/>
<br/>
The db_owner role on the MSDB database is required for installation and upgrade only.<br/>
<br/>
If the above vendor database-dependent permissions are not strictly adhered to, this is a finding.</td>
          </tr>
          <tr>
            <th class="ruledata">Fix:</th>
            <td class="ruledata">For Oracle DB normal runtime operation, set the following permissions. <br/>
grant connect to vumAdmin<br/>
grant resource to vumAdmin<br/>
grant create any job to vumAdmin<br/>
grant create view to vumAdmin<br/>
grant create any sequence to vumAdmin<br/>
grant create any table to vumAdmin<br/>
grant lock any table to vumAdmin<br/>
grant create procedure to vumAdmin<br/>
grant create type to vumAdmin<br/>
grant execute on dbms_lock to vumAdmin<br/>
grant unlimited tablespace to vumAdmin<br/>
# To ensure space limitation is not an issue<br/>
<br/>
For SQL DB normal operation, make sure that the database user has either a sysadmin server role or the db_owner fixed database role on the Update Manager database and the MSDB database.<br/>
<br/>
The db_owner role on the MSDB database is required for installation and upgrade only.<br/>
<br/>
Note: While current, it is always best to check both the latest VMware Update Manager Administration Guide and the vendor database documentation for any updates to these configurations.</td>
          </tr>
          <tr>
            <th class="ruledata">References:</th>
            <td class="ruledata">
              <ul class="ruledata">
                <li>CCI-000366</li>
              </ul>
            </td>
          </tr>
        </table>
        <br/>
        <a name="RULE_SV-104605r2_rule">
          <table class="ruleblock">
            <tr class="ruleblock">
              <td class="ruleblock"><span class="ruleheader">STIG ID:</span><br/>VCWN-65-000033</td>
              <td class="ruleblock"><span class="ruleheader">Group ID:</span><br/>V-94775</td>
              <td class="ruleblock"><span class="ruleheader">Rule ID:</span><br/>SV-104605r2_rule</td>
              <td class="ruleblock"><span class="ruleheader">Severity:</span><br/>CAT II</td>
            </tr>
          </table>
        </a>
        <table class="ruledata">
          <tr>
            <th class="ruledata">Requirement:</th>
            <td class="ruledata">
              <span class="rulerequirement">The vCenter Server for Windows must use a least-privileges assignment for the vCenter Server database user.</span>
            </td>
          </tr>
          <tr>
            <th class="ruledata">Discussion:</th>
            <td class="ruledata">Least-privileges mitigates attacks if the vCenter database account is compromised. vCenter requires very specific privileges on the database. Privileges normally required only for installation and upgrade must be removed for/during normal operation. These privileges may be reinstated if/when any future upgrade must be performed.</td>
          </tr>
          <tr>
            <th class="ruledata">Check:</th>
            <td class="ruledata">Verify only the following permissions are allowed on the vCenter database for the following roles and users. <br/>
<br/>
vCenter database administrator role used only for initial setup and periodic maintenance of the database: <br/>
Schema permissions ALTER, REFERENCES, and INSERT. <br/>
Permissions CREATE TABLE, ALTER TABLE, VIEW, and CREATE PROCEDURES. <br/>
<br/>
vCenter database user role: <br/>
SELECT, INSERT, DELETE, UPDATE, and EXECUTE. <br/>
EXECUTE permissions on sp_add_job, sp_delete_job, sp_add_jobstep, sp_update_job, sp_add_jobserver, sp_add_jobschedule, and sp_add_category stored procedures. <br/>
SELECT permission on syscategories, sysjobsteps, sysjobs_view, and sysjobs tables. <br/>
<br/>
vCenter database user: <br/>
VIEW SERVER STATE and VIEW ANY DEFINITIONS. <br/>
<br/>
Equivalent permissions must be set for Non-MS databases. <br/>
<br/>
If the above database permissions are not set correctly, this is a finding.</td>
          </tr>
          <tr>
            <th class="ruledata">Fix:</th>
            <td class="ruledata">Configure correct permissions and roles for SQL: <br/>
<br/>
Grant these privileges to a vCenter database administrator role used only for initial setup and periodic maintenance of the database: <br/>
Schema permissions ALTER, REFERENCES, and INSERT. <br/>
Permissions CREATE TABLE, ALTER TABLE, VIEW, and CREATE PROCEDURES. <br/>
<br/>
Grant these privileges to a vCenter database user role: <br/>
SELECT, INSERT, DELETE, UPDATE, and EXECUTE. <br/>
EXECUTE permissions on sp_add_job, sp_delete_job, sp_add_jobstep, sp_update_job, sp_add_jobserver, sp_add_jobschedule, and sp_add_category stored procedures. <br/>
SELECT permission on syscategories, sysjobsteps, sysjobs_view, and sysjobs tables. <br/>
<br/>
Grant the permissions VIEW SERVER STATE and VIEW ANY DEFINITIONS to the vCenter database user.</td>
          </tr>
          <tr>
            <th class="ruledata">References:</th>
            <td class="ruledata">
              <ul class="ruledata">
                <li>CCI-000366</li>
              </ul>
            </td>
          </tr>
        </table>
        <br/>
        <a name="RULE_SV-104607r1_rule">
          <table class="ruleblock">
            <tr class="ruleblock">
              <td class="ruleblock"><span class="ruleheader">STIG ID:</span><br/>VCWN-65-000034</td>
              <td class="ruleblock"><span class="ruleheader">Group ID:</span><br/>V-94777</td>
              <td class="ruleblock"><span class="ruleheader">Rule ID:</span><br/>SV-104607r1_rule</td>
              <td class="ruleblock"><span class="ruleheader">Severity:</span><br/>CAT II</td>
            </tr>
          </table>
        </a>
        <table class="ruledata">
          <tr>
            <th class="ruledata">Requirement:</th>
            <td class="ruledata">
              <span class="rulerequirement">The vCenter Server for Windows must use unique service accounts when applications connect to vCenter.</span>
            </td>
          </tr>
          <tr>
            <th class="ruledata">Discussion:</th>
            <td class="ruledata">In order to not violate non-repudiation (i.e., deny the authenticity of who is connecting to vCenter), when applications need to connect to vCenter they should use unique service accounts.</td>
          </tr>
          <tr>
            <th class="ruledata">Check:</th>
            <td class="ruledata">Verify that each external application that connects to vCenter has a unique service account dedicated to that application.  For example there should be separate accounts for Log Insight, Operations Manager, or anything else that requires an account to access vCenter.<br/>
<br/>
If any application shares a service account that is used to connect to vCenter, this is a finding.</td>
          </tr>
          <tr>
            <th class="ruledata">Fix:</th>
            <td class="ruledata">For applications sharing service accounts create a new service account to assign to the application so that no application shares a service account with another.<br/>
<br/>
When standing up a new application that requires access to vCenter always create a new service account prior to installation and grant only the permissions needed for that application.</td>
          </tr>
          <tr>
            <th class="ruledata">References:</th>
            <td class="ruledata">
              <ul class="ruledata">
                <li>CCI-000366</li>
              </ul>
            </td>
          </tr>
        </table>
        <br/>
        <a name="RULE_SV-104609r1_rule">
          <table class="ruleblock">
            <tr class="ruleblock">
              <td class="ruleblock"><span class="ruleheader">STIG ID:</span><br/>VCWN-65-000035</td>
              <td class="ruleblock"><span class="ruleheader">Group ID:</span><br/>V-94779</td>
              <td class="ruleblock"><span class="ruleheader">Rule ID:</span><br/>SV-104609r1_rule</td>
              <td class="ruleblock"><span class="ruleheader">Severity:</span><br/>CAT II</td>
            </tr>
          </table>
        </a>
        <table class="ruledata">
          <tr>
            <th class="ruledata">Requirement:</th>
            <td class="ruledata">
              <span class="rulerequirement">vCenter Server for Windows plugins must be verified.</span>
            </td>
          </tr>
          <tr>
            <th class="ruledata">Discussion:</th>
            <td class="ruledata">The vCenter Server includes a vSphere Client extensibility framework, which provides the ability to extend the vSphere Client with menu selections or toolbar icons that provide access to vCenter Server add-on components or external, Web-based functionality. vSphere Client plugins or extensions run at the same privilege level as the user. Malicious extensions might masquerade as useful add-ons while compromising the system by stealing credentials or incorrectly configuring the system.</td>
          </tr>
          <tr>
            <th class="ruledata">Check:</th>
            <td class="ruledata">Verify the vSphere Client used by administrators includes only authorized extensions from trusted sources.<br/>
<br/>
From the vSphere Web Client go to Administration &gt;&gt; Solutions &gt;&gt; Client Plug-Ins. View the Installed/Available Plug-ins list and verify they are all identified as authorized VMware, Third-party (Partner) and/or site-specific (locally developed and site) approved plug-ins.<br/>
<br/>
If any Installed/Available plug-ins in the viewable list cannot be verified as vSphere Client plug-ins and/or authorized extensions from trusted sources, this is a finding.</td>
          </tr>
          <tr>
            <th class="ruledata">Fix:</th>
            <td class="ruledata">From the vSphere Web Client go to Administration &gt;&gt; Solutions &gt;&gt; Client Plug-Ins and right click the unknown plug-in and click disable then proceed to remove the plug-in.<br/>
<br/>
To remove plug-ins do the following:<br/>
<br/>
If you have vCenter Server in linked mode, perform this procedure on the vCenter Server that is used to install the plug-in initially, then restart the vCenter Server services on the linked vCenter Server.<br/>
<br/>
In a web browser, navigate to http://vCenter_Server_name_or_IP/mob.<br/>
<br/>
Where vCenter_Server_name_or_IP/mob is the name of your vCenter Server or its IP address.<br/>
<br/>
Click Content.<br/>
<br/>
Click ExtensionManager.<br/>
<br/>
Select and copy the name of the plug-in you want to remove from the list of values under Properties. For a list of default plug-ins, see the Additional Information section of this article.<br/>
<br/>
Click UnregisterExtension. A new window appears.<br/>
<br/>
Paste the name of the plug-in and click Invoke Method. This removes the plug-in.<br/>
<br/>
Close the window.<br/>
<br/>
Refresh the Managed Object Type:ManagedObjectReference:ExtensionManager window to verify that the plug-in is removed successfully.<br/>
<br/>
Note: If the plug-in still appears, you may have to restart the vSphere Client.<br/>
<br/>
Note: You may have to enable the Managed Object Browser (MOB) temporarily if previously disabled.</td>
          </tr>
          <tr>
            <th class="ruledata">References:</th>
            <td class="ruledata">
              <ul class="ruledata">
                <li>CCI-000366</li>
              </ul>
            </td>
          </tr>
        </table>
        <br/>
        <a name="RULE_SV-104611r1_rule">
          <table class="ruleblock">
            <tr class="ruleblock">
              <td class="ruleblock"><span class="ruleheader">STIG ID:</span><br/>VCWN-65-000036</td>
              <td class="ruleblock"><span class="ruleheader">Group ID:</span><br/>V-94781</td>
              <td class="ruleblock"><span class="ruleheader">Rule ID:</span><br/>SV-104611r1_rule</td>
              <td class="ruleblock"><span class="ruleheader">Severity:</span><br/>CAT III</td>
            </tr>
          </table>
        </a>
        <table class="ruledata">
          <tr>
            <th class="ruledata">Requirement:</th>
            <td class="ruledata">
              <span class="rulerequirement">The vCenter Server for Windows must produce audit records containing information to establish what type of events occurred.</span>
            </td>
          </tr>
          <tr>
            <th class="ruledata">Discussion:</th>
            <td class="ruledata">Without establishing what types of events occurred, it would be difficult to establish, correlate, and investigate the events leading up to an outage or attack.</td>
          </tr>
          <tr>
            <th class="ruledata">Check:</th>
            <td class="ruledata">From the vSphere Web Client go to Host and Clusters &gt;&gt; Select a vCenter Server &gt;&gt; Configure &gt;&gt; Settings &gt;&gt; Advanced Settings. Verify that "config.log.level" value is set to "info".<br/>
<br/>
or<br/>
<br/>
From a PowerCLI command prompt while connected to the vCenter server run the following command:<br/>
Get-AdvancedSetting -Entity &lt;vcenter server name&gt; -Name config.log.level and verify it is set to "info".<br/>
<br/>
If the "config.log.level" value is not set to "info" or does not exist, this is a finding.</td>
          </tr>
          <tr>
            <th class="ruledata">Fix:</th>
            <td class="ruledata">From the vSphere Web Client go to Host and Clusters &gt;&gt; Select a vCenter Server &gt;&gt; Configure &gt;&gt; Settings &gt;&gt; Advanced Settings. Click "Edit" and edit the "config.log.level" setting to "info" or if the value does not exist create it by entering the values in the "Key" and "Value" fields and clicking "Add".<br/>
<br/>
or<br/>
<br/>
From a PowerCLI command prompt while connected to the vCenter server run the following command:<br/>
<br/>
If the setting already exists:<br/>
Get-AdvancedSetting -Entity &lt;vcenter server name&gt; -Name config.log.level | Set-AdvancedSetting -Value info<br/>
<br/>
If the setting does not exist:<br/>
New-AdvancedSetting -Entity &lt;vcenter server name&gt; -Name config.log.level -Value info</td>
          </tr>
          <tr>
            <th class="ruledata">References:</th>
            <td class="ruledata">
              <ul class="ruledata">
                <li>CCI-002702</li>
              </ul>
            </td>
          </tr>
        </table>
        <br/>
        <a name="RULE_SV-104613r1_rule">
          <table class="ruleblock">
            <tr class="ruleblock">
              <td class="ruleblock"><span class="ruleheader">STIG ID:</span><br/>VCWN-65-000039</td>
              <td class="ruleblock"><span class="ruleheader">Group ID:</span><br/>V-94783</td>
              <td class="ruleblock"><span class="ruleheader">Rule ID:</span><br/>SV-104613r1_rule</td>
              <td class="ruleblock"><span class="ruleheader">Severity:</span><br/>CAT II</td>
            </tr>
          </table>
        </a>
        <table class="ruledata">
          <tr>
            <th class="ruledata">Requirement:</th>
            <td class="ruledata">
              <span class="rulerequirement">The vCenter Server for Windows passwords must be at least 15 characters in length.</span>
            </td>
          </tr>
          <tr>
            <th class="ruledata">Discussion:</th>
            <td class="ruledata">The shorter the password, the lower the number of possible combinations that need to be tested before the password is compromised.<br/>
<br/>
Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks. Password length is one factor of several that helps to determine strength and how long it takes to crack a password. The shorter the password, the lower the number of possible combinations that need to be tested before the password is compromised. <br/>
<br/>
Use of more characters in a password helps to exponentially increase the time and/or resources required to compromise the password.</td>
          </tr>
          <tr>
            <th class="ruledata">Check:</th>
            <td class="ruledata">From the vSphere Web Client go to Administration &gt;&gt; Single Sign-On &gt;&gt; Configuration &gt;&gt; Policies &gt;&gt; Password Policy. <br/>
<br/>
View the values of the password format requirements. <br/>
<br/>
The following password requirement should be set at a minimum: <br/>
Minimum Length: 15 <br/>
<br/>
If this password policy is not configured as stated, this is a finding.</td>
          </tr>
          <tr>
            <th class="ruledata">Fix:</th>
            <td class="ruledata">From the vSphere Web Client go to Administration &gt;&gt; Single Sign-On &gt;&gt; Configuration &gt;&gt; Policies &gt;&gt; Password Policy. Click "Edit". Set the Minimum Length to "15" and click "OK".</td>
          </tr>
          <tr>
            <th class="ruledata">References:</th>
            <td class="ruledata">
              <ul class="ruledata">
                <li>CCI-000205</li>
              </ul>
            </td>
          </tr>
        </table>
        <br/>
        <a name="RULE_SV-104615r1_rule">
          <table class="ruleblock">
            <tr class="ruleblock">
              <td class="ruleblock"><span class="ruleheader">STIG ID:</span><br/>VCWN-65-000040</td>
              <td class="ruleblock"><span class="ruleheader">Group ID:</span><br/>V-94785</td>
              <td class="ruleblock"><span class="ruleheader">Rule ID:</span><br/>SV-104615r1_rule</td>
              <td class="ruleblock"><span class="ruleheader">Severity:</span><br/>CAT II</td>
            </tr>
          </table>
        </a>
        <table class="ruledata">
          <tr>
            <th class="ruledata">Requirement:</th>
            <td class="ruledata">
              <span class="rulerequirement">The vCenter Server for Windows passwords must contain at least one uppercase character.</span>
            </td>
          </tr>
          <tr>
            <th class="ruledata">Discussion:</th>
            <td class="ruledata">To enforce the use of complex passwords, minimum numbers of characters of different classes are mandated. The use of complex passwords reduces the ability of attackers to successfully obtain valid passwords using guessing or exhaustive search techniques. Complexity requirements increase the password search space by requiring users to construct passwords from a larger character set than they may otherwise use.</td>
          </tr>
          <tr>
            <th class="ruledata">Check:</th>
            <td class="ruledata">From the vSphere Web Client go to Administration &gt;&gt; Single Sign-On &gt;&gt; Configuration &gt;&gt; Policies &gt;&gt; Password Policy. <br/>
<br/>
View the values of the password format requirements. <br/>
<br/>
The following password requirement should be set at a minimum: <br/>
Upper-case Characters: At least 1 <br/>
<br/>
If this password complexity policy is not configured as stated, this is a finding.</td>
          </tr>
          <tr>
            <th class="ruledata">Fix:</th>
            <td class="ruledata">From the vSphere Web Client go to Administration &gt;&gt; Single Sign-On &gt;&gt; Configuration &gt;&gt; Policies &gt;&gt; Password Policy. Click "Edit". Set Upper-case Characters to at least "1" and click "OK".</td>
          </tr>
          <tr>
            <th class="ruledata">References:</th>
            <td class="ruledata">
              <ul class="ruledata">
                <li>CCI-000192</li>
              </ul>
            </td>
          </tr>
        </table>
        <br/>
        <a name="RULE_SV-104617r1_rule">
          <table class="ruleblock">
            <tr class="ruleblock">
              <td class="ruleblock"><span class="ruleheader">STIG ID:</span><br/>VCWN-65-000041</td>
              <td class="ruleblock"><span class="ruleheader">Group ID:</span><br/>V-94787</td>
              <td class="ruleblock"><span class="ruleheader">Rule ID:</span><br/>SV-104617r1_rule</td>
              <td class="ruleblock"><span class="ruleheader">Severity:</span><br/>CAT II</td>
            </tr>
          </table>
        </a>
        <table class="ruledata">
          <tr>
            <th class="ruledata">Requirement:</th>
            <td class="ruledata">
              <span class="rulerequirement">The vCenter Server for Windows passwords must contain at least one lowercase character.</span>
            </td>
          </tr>
          <tr>
            <th class="ruledata">Discussion:</th>
            <td class="ruledata">To enforce the use of complex passwords, minimum numbers of characters of different classes are mandated. The use of complex passwords reduces the ability of attackers to successfully obtain valid passwords using guessing or exhaustive search techniques. Complexity requirements increase the password search space by requiring users to construct passwords from a larger character set than they may otherwise use.</td>
          </tr>
          <tr>
            <th class="ruledata">Check:</th>
            <td class="ruledata">From the vSphere Web Client go to Administration &gt;&gt; Single Sign-On &gt;&gt; Configuration &gt;&gt; Policies &gt;&gt; Password Policy. <br/>
<br/>
View the values of the password format requirements. <br/>
<br/>
The following password requirement should be set at a minimum: <br/>
Lower-case Characters: At least 1 <br/>
<br/>
If this password complexity policy is not configured as stated, this is a finding.</td>
          </tr>
          <tr>
            <th class="ruledata">Fix:</th>
            <td class="ruledata">From the vSphere Web Client go to Administration &gt;&gt; Single Sign-On &gt;&gt; Configuration &gt;&gt; Policies &gt;&gt; Password Policy. Click "Edit". Set Lower-case Characters to at least "1" and click "OK".</td>
          </tr>
          <tr>
            <th class="ruledata">References:</th>
            <td class="ruledata">
              <ul class="ruledata">
                <li>CCI-000193</li>
              </ul>
            </td>
          </tr>
        </table>
        <br/>
        <a name="RULE_SV-104619r1_rule">
          <table class="ruleblock">
            <tr class="ruleblock">
              <td class="ruleblock"><span class="ruleheader">STIG ID:</span><br/>VCWN-65-000042</td>
              <td class="ruleblock"><span class="ruleheader">Group ID:</span><br/>V-94789</td>
              <td class="ruleblock"><span class="ruleheader">Rule ID:</span><br/>SV-104619r1_rule</td>
              <td class="ruleblock"><span class="ruleheader">Severity:</span><br/>CAT II</td>
            </tr>
          </table>
        </a>
        <table class="ruledata">
          <tr>
            <th class="ruledata">Requirement:</th>
            <td class="ruledata">
              <span class="rulerequirement">The vCenter Server for Windows passwords must contain at least one numeric character.</span>
            </td>
          </tr>
          <tr>
            <th class="ruledata">Discussion:</th>
            <td class="ruledata">To enforce the use of complex passwords, minimum numbers of characters of different classes are mandated. The use of complex passwords reduces the ability of attackers to successfully obtain valid passwords using guessing or exhaustive search techniques. Complexity requirements increase the password search space by requiring users to construct passwords from a larger character set than they may otherwise use.</td>
          </tr>
          <tr>
            <th class="ruledata">Check:</th>
            <td class="ruledata">From the vSphere Web Client go to Administration &gt;&gt; Single Sign-On &gt;&gt; Configuration &gt;&gt; Policies &gt;&gt; Password Policy. <br/>
<br/>
View the values of the password format requirements. <br/>
<br/>
The following password requirement should be set at a minimum: <br/>
Numeric Characters: At least 1 <br/>
<br/>
If this password complexity policy is not configured as stated, this is a finding.</td>
          </tr>
          <tr>
            <th class="ruledata">Fix:</th>
            <td class="ruledata">From the vSphere Web Client go to Administration &gt;&gt; Single Sign-On &gt;&gt; Configuration &gt;&gt; Policies &gt;&gt; Password Policy. Click "Edit". Set Numeric Characters to at least "1" and click "OK".</td>
          </tr>
          <tr>
            <th class="ruledata">References:</th>
            <td class="ruledata">
              <ul class="ruledata">
                <li>CCI-000194</li>
              </ul>
            </td>
          </tr>
        </table>
        <br/>
        <a name="RULE_SV-104621r1_rule">
          <table class="ruleblock">
            <tr class="ruleblock">
              <td class="ruleblock"><span class="ruleheader">STIG ID:</span><br/>VCWN-65-000043</td>
              <td class="ruleblock"><span class="ruleheader">Group ID:</span><br/>V-94791</td>
              <td class="ruleblock"><span class="ruleheader">Rule ID:</span><br/>SV-104621r1_rule</td>
              <td class="ruleblock"><span class="ruleheader">Severity:</span><br/>CAT II</td>
            </tr>
          </table>
        </a>
        <table class="ruledata">
          <tr>
            <th class="ruledata">Requirement:</th>
            <td class="ruledata">
              <span class="rulerequirement">The vCenter Server for Windows passwords must contain at least one special character.</span>
            </td>
          </tr>
          <tr>
            <th class="ruledata">Discussion:</th>
            <td class="ruledata">To enforce the use of complex passwords, minimum numbers of characters of different classes are mandated. The use of complex passwords reduces the ability of attackers to successfully obtain valid passwords using guessing or exhaustive search techniques. Complexity requirements increase the password search space by requiring users to construct passwords from a larger character set than they may otherwise use.</td>
          </tr>
          <tr>
            <th class="ruledata">Check:</th>
            <td class="ruledata">From the vSphere Web Client go to Administration &gt;&gt; Single Sign-On &gt;&gt; Configuration &gt;&gt; Policies &gt;&gt; Password Policy. <br/>
<br/>
View the values of the password format requirements. <br/>
<br/>
The following password requirements should be set at a minimum: <br/>
Special Characters: At least 1 <br/>
<br/>
If this password complexity policy is not configured as stated, this is a finding.</td>
          </tr>
          <tr>
            <th class="ruledata">Fix:</th>
            <td class="ruledata">From the vSphere Web Client go to Administration &gt;&gt; Single Sign-On &gt;&gt; Configuration &gt;&gt; Policies &gt;&gt; Password Policy. Click "Edit". Set Special Characters to at least "1" and click "OK".</td>
          </tr>
          <tr>
            <th class="ruledata">References:</th>
            <td class="ruledata">
              <ul class="ruledata">
                <li>CCI-001619</li>
              </ul>
            </td>
          </tr>
        </table>
        <br/>
        <a name="RULE_SV-104623r1_rule">
          <table class="ruleblock">
            <tr class="ruleblock">
              <td class="ruleblock"><span class="ruleheader">STIG ID:</span><br/>VCWN-65-000045</td>
              <td class="ruleblock"><span class="ruleheader">Group ID:</span><br/>V-94793</td>
              <td class="ruleblock"><span class="ruleheader">Rule ID:</span><br/>SV-104623r1_rule</td>
              <td class="ruleblock"><span class="ruleheader">Severity:</span><br/>CAT II</td>
            </tr>
          </table>
        </a>
        <table class="ruledata">
          <tr>
            <th class="ruledata">Requirement:</th>
            <td class="ruledata">
              <span class="rulerequirement">The vCenter Server for Windows must limit the maximum number of failed login attempts to three.</span>
            </td>
          </tr>
          <tr>
            <th class="ruledata">Discussion:</th>
            <td class="ruledata">By limiting the number of failed login attempts, the risk of unauthorized access via user password guessing, otherwise known as brute-forcing, is reduced. Limits are imposed by locking the account.</td>
          </tr>
          <tr>
            <th class="ruledata">Check:</th>
            <td class="ruledata">From the vSphere Web Client go to Administration &gt;&gt; Single Sign-On &gt;&gt; Configuration &gt;&gt; Policies &gt;&gt; Lockout Policy. <br/>
<br/>
View the values for the lockout policies. <br/>
<br/>
The following lockout policy should be set at follows: <br/>
Maximum number of failed login attempts: 3 <br/>
<br/>
If this account lockout policy is not configured as stated, this is a finding.</td>
          </tr>
          <tr>
            <th class="ruledata">Fix:</th>
            <td class="ruledata">From the vSphere Web Client go to Administration &gt;&gt; Single Sign-On &gt;&gt; Configuration &gt;&gt; Policies &gt;&gt; Lockout Policy. Click "Edit". Set the Maximum number of failed login attempts to "3" and click "OK".</td>
          </tr>
          <tr>
            <th class="ruledata">References:</th>
            <td class="ruledata">
              <ul class="ruledata">
                <li>CCI-002238</li>
              </ul>
            </td>
          </tr>
        </table>
        <br/>
        <a name="RULE_SV-104625r1_rule">
          <table class="ruleblock">
            <tr class="ruleblock">
              <td class="ruleblock"><span class="ruleheader">STIG ID:</span><br/>VCWN-65-000046</td>
              <td class="ruleblock"><span class="ruleheader">Group ID:</span><br/>V-94795</td>
              <td class="ruleblock"><span class="ruleheader">Rule ID:</span><br/>SV-104625r1_rule</td>
              <td class="ruleblock"><span class="ruleheader">Severity:</span><br/>CAT II</td>
            </tr>
          </table>
        </a>
        <table class="ruledata">
          <tr>
            <th class="ruledata">Requirement:</th>
            <td class="ruledata">
              <span class="rulerequirement">The vCenter Server for Windows must set the interval for counting failed login attempts to at least 15 minutes.</span>
            </td>
          </tr>
          <tr>
            <th class="ruledata">Discussion:</th>
            <td class="ruledata">By limiting the number of failed login attempts, the risk of unauthorized access via user password guessing, otherwise known as brute-forcing, is reduced. Limits are imposed by locking the account.</td>
          </tr>
          <tr>
            <th class="ruledata">Check:</th>
            <td class="ruledata">From the vSphere Web Client go to Administration &gt;&gt; Single Sign-On &gt;&gt; Configuration &gt;&gt; Policies &gt;&gt; Lockout Policy. <br/>
<br/>
View the values for the lockout policies. <br/>
<br/>
The following lockout policy should be set at follows: <br/>
Time interval between failures: 900 seconds <br/>
<br/>
If this lockout policy is not configured as stated, this is a finding.</td>
          </tr>
          <tr>
            <th class="ruledata">Fix:</th>
            <td class="ruledata">From the vSphere Web Client go to Administration &gt;&gt; Single Sign-On &gt;&gt; Configuration &gt;&gt; Policies &gt;&gt; Lockout Policy. Click "Edit". Set the Time interval between failures to "900" and click "OK".</td>
          </tr>
          <tr>
            <th class="ruledata">References:</th>
            <td class="ruledata">
              <ul class="ruledata">
                <li>CCI-002238</li>
              </ul>
            </td>
          </tr>
        </table>
        <br/>
        <a name="RULE_SV-104627r1_rule">
          <table class="ruleblock">
            <tr class="ruleblock">
              <td class="ruleblock"><span class="ruleheader">STIG ID:</span><br/>VCWN-65-000047</td>
              <td class="ruleblock"><span class="ruleheader">Group ID:</span><br/>V-94797</td>
              <td class="ruleblock"><span class="ruleheader">Rule ID:</span><br/>SV-104627r1_rule</td>
              <td class="ruleblock"><span class="ruleheader">Severity:</span><br/>CAT II</td>
            </tr>
          </table>
        </a>
        <table class="ruledata">
          <tr>
            <th class="ruledata">Requirement:</th>
            <td class="ruledata">
              <span class="rulerequirement">The vCenter Server for Windows must require an administrator to unlock an account locked due to excessive login failures.</span>
            </td>
          </tr>
          <tr>
            <th class="ruledata">Discussion:</th>
            <td class="ruledata">By limiting the number of failed login attempts, the risk of unauthorized access via user password guessing, otherwise known as brute-forcing, is reduced. Limits are imposed by locking the account.</td>
          </tr>
          <tr>
            <th class="ruledata">Check:</th>
            <td class="ruledata">From the vSphere Web Client go to Administration &gt;&gt; Single Sign-On &gt;&gt; Configuration &gt;&gt; Policies &gt;&gt; Lockout Policy. <br/>
<br/>
View the values for the lockout policies. <br/>
<br/>
The following lockout policy should be set at follows: <br/>
Unlock time: 0 <br/>
<br/>
If this account lockout policy is not configured as stated, this is a finding.</td>
          </tr>
          <tr>
            <th class="ruledata">Fix:</th>
            <td class="ruledata">From the vSphere Web Client go to Administration &gt;&gt; Single Sign-On &gt;&gt; Configuration &gt;&gt; Policies &gt;&gt; Lockout Policy. Click "Edit". Set the Unlock time to "0" and click "OK".</td>
          </tr>
          <tr>
            <th class="ruledata">References:</th>
            <td class="ruledata">
              <ul class="ruledata">
                <li>CCI-002238</li>
              </ul>
            </td>
          </tr>
        </table>
        <br/>
        <a name="RULE_SV-104629r1_rule">
          <table class="ruleblock">
            <tr class="ruleblock">
              <td class="ruleblock"><span class="ruleheader">STIG ID:</span><br/>VCWN-65-000048</td>
              <td class="ruleblock"><span class="ruleheader">Group ID:</span><br/>V-94799</td>
              <td class="ruleblock"><span class="ruleheader">Rule ID:</span><br/>SV-104629r1_rule</td>
              <td class="ruleblock"><span class="ruleheader">Severity:</span><br/>CAT II</td>
            </tr>
          </table>
        </a>
        <table class="ruledata">
          <tr>
            <th class="ruledata">Requirement:</th>
            <td class="ruledata">
              <span class="rulerequirement">The vCenter Server for Windows must alert administrators on permission creation operations.</span>
            </td>
          </tr>
          <tr>
            <th class="ruledata">Discussion:</th>
            <td class="ruledata">If personnel are not notified of permission events, they will not be aware of possible unsecure situations.</td>
          </tr>
          <tr>
            <th class="ruledata">Check:</th>
            <td class="ruledata">From the vSphere Web Client go to Host and Clusters &gt;&gt; Select a vCenter Server &gt;&gt; Monitor &gt;&gt; Issues &gt;&gt; Alarm Definitions. <br/>
<br/>
Verify there is an alarm created to alert on permission additions.<br/>
<br/>
or<br/>
<br/>
From a PowerCLI command prompt while connected to the vCenter server run the following command:<br/>
Get-AlarmDefinition | Where {$_.ExtensionData.Info.Expression.Expression.EventTypeId -eq "vim.event.PermissionAddedEvent"} | Select Name,Enabled,@{N="EventTypeId";E={$_.ExtensionData.Info.Expression.Expression.EventTypeId}}<br/>
<br/>
If an alarm is not created to alert on permission addition events, this is a finding.</td>
          </tr>
          <tr>
            <th class="ruledata">Fix:</th>
            <td class="ruledata">From the vSphere Web Client select the vCenter server at the top of the hierarchy and go to &gt;&gt; Alarms &gt;&gt; Definitions. Right-click in the empty space and select "New Alarm". On the "General" tab provide an alarm name and description, Select "vCenter Server" for alarm type and "Monitor for specific events occurring on this object", check "Enable this alarm". On the "Triggers" tab, click "Add" for a trigger and in the event column enter "vim.event.PermissionAddedEvent" and click "OK".</td>
          </tr>
          <tr>
            <th class="ruledata">References:</th>
            <td class="ruledata">
              <ul class="ruledata">
                <li>CCI-001294</li>
              </ul>
            </td>
          </tr>
        </table>
        <br/>
        <a name="RULE_SV-104631r2_rule">
          <table class="ruleblock">
            <tr class="ruleblock">
              <td class="ruleblock"><span class="ruleheader">STIG ID:</span><br/>VCWN-65-000049</td>
              <td class="ruleblock"><span class="ruleheader">Group ID:</span><br/>V-94801</td>
              <td class="ruleblock"><span class="ruleheader">Rule ID:</span><br/>SV-104631r2_rule</td>
              <td class="ruleblock"><span class="ruleheader">Severity:</span><br/>CAT II</td>
            </tr>
          </table>
        </a>
        <table class="ruledata">
          <tr>
            <th class="ruledata">Requirement:</th>
            <td class="ruledata">
              <span class="rulerequirement">The vCenter Server for Windows must alert administrators on permission deletion operations.</span>
            </td>
          </tr>
          <tr>
            <th class="ruledata">Discussion:</th>
            <td class="ruledata">If personnel are not notified of permission events, they will not be aware of possible unsecure situations.</td>
          </tr>
          <tr>
            <th class="ruledata">Check:</th>
            <td class="ruledata">From the vSphere Web Client go to Host and Clusters &gt;&gt; Select a vCenter Server &gt;&gt; Monitor &gt;&gt; Issues &gt;&gt; Alarm Definitions. <br/>
<br/>
Verify there is an alarm created to alert on permission additions.<br/>
<br/>
or<br/>
<br/>
From a PowerCLI command prompt while connected to the vCenter server run the following command:<br/>
Get-AlarmDefinition | Where {$_.ExtensionData.Info.Expression.Expression.EventTypeId -eq "vim.event.PermissionRemovedEvent"} | Select Name,Enabled,@{N="EventTypeId";E={$_.ExtensionData.Info.Expression.Expression.EventTypeId}}<br/>
<br/>
If an alarm is not created to alert on permission addition events, this is a finding.</td>
          </tr>
          <tr>
            <th class="ruledata">Fix:</th>
            <td class="ruledata">From the vSphere Web Client select the vCenter server at the top of the hierarchy and go to &gt;&gt; Alarms &gt;&gt; Definitions. Right-click in the empty space and select "New Alarm". On the "General" tab provide an alarm name and description, Select "vCenter Server" for alarm type and "Monitor for specific events occurring on this object", check "Enable this alarm". On the "Triggers" tab, click "Add" for a trigger and in the event column enter "vim.event.PermissionRemovedEvent" and click "OK".</td>
          </tr>
          <tr>
            <th class="ruledata">References:</th>
            <td class="ruledata">
              <ul class="ruledata">
                <li>CCI-001294</li>
              </ul>
            </td>
          </tr>
        </table>
        <br/>
        <a name="RULE_SV-104633r1_rule">
          <table class="ruleblock">
            <tr class="ruleblock">
              <td class="ruleblock"><span class="ruleheader">STIG ID:</span><br/>VCWN-65-000050</td>
              <td class="ruleblock"><span class="ruleheader">Group ID:</span><br/>V-94803</td>
              <td class="ruleblock"><span class="ruleheader">Rule ID:</span><br/>SV-104633r1_rule</td>
              <td class="ruleblock"><span class="ruleheader">Severity:</span><br/>CAT II</td>
            </tr>
          </table>
        </a>
        <table class="ruledata">
          <tr>
            <th class="ruledata">Requirement:</th>
            <td class="ruledata">
              <span class="rulerequirement">The vCenter Server for Windows must alert administrators on permission update operations.</span>
            </td>
          </tr>
          <tr>
            <th class="ruledata">Discussion:</th>
            <td class="ruledata">If personnel are not notified of permission events, they will not be aware of possible unsecure situations.</td>
          </tr>
          <tr>
            <th class="ruledata">Check:</th>
            <td class="ruledata">"From the vSphere Web Client go to Host and Clusters &gt;&gt; Select a vCenter Server &gt;&gt; Monitor &gt;&gt; Issues &gt;&gt; Alarm Definitions. <br/>
<br/>
Verify there is an alarm created to alert on permission additions.<br/>
<br/>
or<br/>
<br/>
From a PowerCLI command prompt while connected to the vCenter server run the following command:<br/>
Get-AlarmDefinition | Where {$_.ExtensionData.Info.Expression.Expression.EventTypeId -eq ""vim.event.PermissionUpdatedEvent""} | Select Name,Enabled,@{N=""EventTypeId"";E={$_.ExtensionData.Info.Expression.Expression.EventTypeId}}<br/>
<br/>
If an alarm is not created to alert on permission addition events, this is a finding."</td>
          </tr>
          <tr>
            <th class="ruledata">Fix:</th>
            <td class="ruledata">From the vSphere Web Client select the vCenter server at the top of the hierarchy and go to &gt;&gt; Alarms &gt;&gt; Definitions. Right-click in the empty space and select "New Alarm". On the "General" tab provide an alarm name and description, Select "vCenter Server" for alarm type and "Monitor for specific events occurring on this object", check "Enable this alarm". On the "Triggers" tab, click "Add" for a trigger and in the event column enter "vim.event.PermissionUpdatedEvent" and click "OK".</td>
          </tr>
          <tr>
            <th class="ruledata">References:</th>
            <td class="ruledata">
              <ul class="ruledata">
                <li>CCI-001294</li>
              </ul>
            </td>
          </tr>
        </table>
        <br/>
        <a name="RULE_SV-104635r1_rule">
          <table class="ruleblock">
            <tr class="ruleblock">
              <td class="ruleblock"><span class="ruleheader">STIG ID:</span><br/>VCWN-65-000051</td>
              <td class="ruleblock"><span class="ruleheader">Group ID:</span><br/>V-94805</td>
              <td class="ruleblock"><span class="ruleheader">Rule ID:</span><br/>SV-104635r1_rule</td>
              <td class="ruleblock"><span class="ruleheader">Severity:</span><br/>CAT II</td>
            </tr>
          </table>
        </a>
        <table class="ruledata">
          <tr>
            <th class="ruledata">Requirement:</th>
            <td class="ruledata">
              <span class="rulerequirement">The vCenter Server for Windows users must have the correct roles assigned.</span>
            </td>
          </tr>
          <tr>
            <th class="ruledata">Discussion:</th>
            <td class="ruledata">Users and service accounts must only be assigned privileges they require. Least Privilege requires that these privileges must only be assigned if needed, to reduce risk of confidentiality, availability or integrity loss.</td>
          </tr>
          <tr>
            <th class="ruledata">Check:</th>
            <td class="ruledata">From the vSphere Web Client go to Administration &gt;&gt; Access Control &gt;&gt; Roles.  <br/>
<br/>
View each role and verify the users and/or groups assigned to it.<br/>
<br/>
or<br/>
<br/>
From a PowerCLI command prompt while connected to the vCenter server run the following command:<br/>
Get-VIPermission | Sort Role | Select Role,Principal,Entity,Propagate,IsGroup | FT -Auto<br/>
<br/>
Application service account and user required privileges should be documented.<br/>
<br/>
If any user or service account has more privileges than required, this is a finding.</td>
          </tr>
          <tr>
            <th class="ruledata">Fix:</th>
            <td class="ruledata">To create a new role with specific permissions do the following:<br/>
<br/>
From the vSphere Web Client go to Administration &gt;&gt; Access Control &gt;&gt; Roles. Click the green plus sign and enter a name for the role and select only the specific permissions required.  Users can then be assigned to the newly created role.</td>
          </tr>
          <tr>
            <th class="ruledata">References:</th>
            <td class="ruledata">
              <ul class="ruledata">
                <li>CCI-001084</li>
              </ul>
            </td>
          </tr>
        </table>
        <br/>
        <a name="RULE_SV-104637r1_rule">
          <table class="ruleblock">
            <tr class="ruleblock">
              <td class="ruleblock"><span class="ruleheader">STIG ID:</span><br/>VCWN-65-000052</td>
              <td class="ruleblock"><span class="ruleheader">Group ID:</span><br/>V-94807</td>
              <td class="ruleblock"><span class="ruleheader">Rule ID:</span><br/>SV-104637r1_rule</td>
              <td class="ruleblock"><span class="ruleheader">Severity:</span><br/>CAT II</td>
            </tr>
          </table>
        </a>
        <table class="ruledata">
          <tr>
            <th class="ruledata">Requirement:</th>
            <td class="ruledata">
              <span class="rulerequirement">The vCenter Server for Windows must protect the confidentiality and integrity of transmitted information by isolating IP-based storage traffic.</span>
            </td>
          </tr>
          <tr>
            <th class="ruledata">Discussion:</th>
            <td class="ruledata">Virtual machines might share virtual switches and VLANs with the IP-based storage configurations. IP-based storage includes vSAN, iSCSI, and NFS. This configuration might expose IP-based storage traffic to unauthorized virtual machine users. IP-based storage frequently is not encrypted. It can be viewed by anyone with access to this network. To restrict unauthorized users from viewing the IP-based storage traffic, the IP-based storage network must be logically separated from the production traffic. Configuring the IP-based storage adaptors on separate VLANs or network segments from other VMkernels and Virtual Machines will limit unauthorized users from viewing the traffic.</td>
          </tr>
          <tr>
            <th class="ruledata">Check:</th>
            <td class="ruledata">If IP-based storage is not used, this is not applicable.<br/>
<br/>
IP-Based storage (iSCSI, NFS, vSAN) VMkernel port groups must be in a dedicated VLAN that can be on a common standard or distributed virtual switch that is logically separated from other traffic types. The check for this will be unique per environment. From the vSphere Client select the ESXi host and go to Configure &gt;&gt; Networking &gt;&gt; VMkernel adapters and review the VLANs associated with any IP-Based storage VMkernels and verify they are dedicated for that purpose and are logically separated from other functions.<br/>
<br/>
If any IP-Based storage networks are not isolated from other traffic types, this is a finding.</td>
          </tr>
          <tr>
            <th class="ruledata">Fix:</th>
            <td class="ruledata">Configuration of an IP-Based VMkernel will be unique to each environment but for example to modify the IP address and VLAN information to the correct network on a standard switch for an iSCSI VMkernel do the following:<br/>
<br/>
From the vSphere Web Client select the ESXi host and go to Configure &gt;&gt; Networking &gt;&gt; VMkernel adapters. Select the Storage VMkernel (for any IP-based storage) and click the pencil icon &gt;&gt; On the Port properties tab uncheck everything (unless vSAN). On the IP Settings tab &gt;&gt; Enter the appropriate IP address and subnet information and click OK. Set the appropriate VLAN ID &gt;&gt; Configure &gt;&gt; Networking &gt;&gt; Virtual switches. Select the Storage portgroup (ISCSI, NFS, vSAN) and click the pencil icon &gt;&gt; On the properties tab, enter the appropriate VLAN ID and click OK.</td>
          </tr>
          <tr>
            <th class="ruledata">References:</th>
            <td class="ruledata">
              <ul class="ruledata">
                <li>CCI-000366</li>
              </ul>
            </td>
          </tr>
        </table>
        <br/>
        <a name="RULE_SV-104639r1_rule">
          <table class="ruleblock">
            <tr class="ruleblock">
              <td class="ruleblock"><span class="ruleheader">STIG ID:</span><br/>VCWN-65-000053</td>
              <td class="ruleblock"><span class="ruleheader">Group ID:</span><br/>V-94809</td>
              <td class="ruleblock"><span class="ruleheader">Rule ID:</span><br/>SV-104639r1_rule</td>
              <td class="ruleblock"><span class="ruleheader">Severity:</span><br/>CAT II</td>
            </tr>
          </table>
        </a>
        <table class="ruledata">
          <tr>
            <th class="ruledata">Requirement:</th>
            <td class="ruledata">
              <span class="rulerequirement">The vCenter Server for Windows must enable the vSAN Health Check.</span>
            </td>
          </tr>
          <tr>
            <th class="ruledata">Discussion:</th>
            <td class="ruledata">The vSAN Health Check is used for additional alerting capabilities, performance stress testing prior to production usage, and verifying that the underlying hardware officially is supported by being in compliance with the vSAN Hardware Compatibility Guide</td>
          </tr>
          <tr>
            <th class="ruledata">Check:</th>
            <td class="ruledata">If no clusters are enabled for vSAN, this is not applicable.<br/>
<br/>
From the vSphere Web Client go to Host and Clusters &gt;&gt; Select a vSAN Enabled Cluster &gt;&gt; Manage &gt;&gt; Configure &gt;&gt; Virtual SAN &gt;&gt; Health and Performance. Review the "Health Service Status" and verify that it is set to "Enabled".<br/>
<br/>
If vSAN is enabled and there is no vSAN health check installed or the vSAN Health Check is disabled, this is a finding.</td>
          </tr>
          <tr>
            <th class="ruledata">Fix:</th>
            <td class="ruledata">From the vSphere Web Client go to Host and Clusters &gt;&gt; Select a vSAN Enabled Cluster &gt;&gt; Manage &gt;&gt; Configure &gt;&gt; Virtual SAN &gt;&gt; Health and Performance &gt;&gt; "Health Service" and click "Edit Settings". Select the check box for "Turn On Periodical Health Check" and configure the time interval as necessary.</td>
          </tr>
          <tr>
            <th class="ruledata">References:</th>
            <td class="ruledata">
              <ul class="ruledata">
                <li>CCI-000366</li>
              </ul>
            </td>
          </tr>
        </table>
        <br/>
        <a name="RULE_SV-104641r1_rule">
          <table class="ruleblock">
            <tr class="ruleblock">
              <td class="ruleblock"><span class="ruleheader">STIG ID:</span><br/>VCWN-65-000054</td>
              <td class="ruleblock"><span class="ruleheader">Group ID:</span><br/>V-94811</td>
              <td class="ruleblock"><span class="ruleheader">Rule ID:</span><br/>SV-104641r1_rule</td>
              <td class="ruleblock"><span class="ruleheader">Severity:</span><br/>CAT II</td>
            </tr>
          </table>
        </a>
        <table class="ruledata">
          <tr>
            <th class="ruledata">Requirement:</th>
            <td class="ruledata">
              <span class="rulerequirement">The vCenter Server for Windows must disable or restrict the connectivity between vSAN Health Check and public Hardware Compatibility List by use of an external proxy server.</span>
            </td>
          </tr>
          <tr>
            <th class="ruledata">Discussion:</th>
            <td class="ruledata">The vSAN Health Check is able to download the hardware compatibility list from VMware in order to check compliance against the underlying vSAN Cluster hosts. To ensure the vCenter server is not directly downloading content from the internet this functionality must be disabled or if this feature is necessary an external proxy server must be configured.</td>
          </tr>
          <tr>
            <th class="ruledata">Check:</th>
            <td class="ruledata">If no clusters are enabled for vSAN, this is not applicable.<br/>
<br/>
From the vSphere Web Client go to Host and Clusters &gt;&gt; Select a vSAN Enabled Cluster &gt;&gt; Manage &gt;&gt; Configure &gt;&gt; Virtual SAN &gt;&gt; General &gt;&gt; Internet Connectivity &gt;&gt; Edit<br/>
<br/>
If the HCL internet download is not required then ensure that "Enable Internet access for this cluster" is disabled. <br/>
<br/>
If this "Enable Internet access for this cluster" is enabled, this is a finding.<br/>
<br/>
If the HCL internet download is required then ensure that "Enable Internet access for this cluster" is enabled and that a proxy host is configured. <br/>
<br/>
If "Enable Internet access for this cluster" is disabled or a proxy is not configured, this is a finding.</td>
          </tr>
          <tr>
            <th class="ruledata">Fix:</th>
            <td class="ruledata">From the vSphere Web Client go to Host and Clusters &gt;&gt; Select a vSAN Enabled Cluster &gt;&gt; Manage &gt;&gt; Configure &gt;&gt; Virtual SAN &gt;&gt; General &gt;&gt; Internet Connectivity &gt;&gt; Edit<br/>
<br/>
If the HCL internet download is not required then ensure that "Enable Internet access for this cluster" is disabled.<br/>
<br/>
If the HCL internet download is required then ensure that "Enable Internet access for this cluster" is enabled and that a proxy host is appropriately configured.</td>
          </tr>
          <tr>
            <th class="ruledata">References:</th>
            <td class="ruledata">
              <ul class="ruledata">
                <li>CCI-000366</li>
              </ul>
            </td>
          </tr>
        </table>
        <br/>
        <a name="RULE_SV-104643r1_rule">
          <table class="ruleblock">
            <tr class="ruleblock">
              <td class="ruleblock"><span class="ruleheader">STIG ID:</span><br/>VCWN-65-000055</td>
              <td class="ruleblock"><span class="ruleheader">Group ID:</span><br/>V-94813</td>
              <td class="ruleblock"><span class="ruleheader">Rule ID:</span><br/>SV-104643r1_rule</td>
              <td class="ruleblock"><span class="ruleheader">Severity:</span><br/>CAT II</td>
            </tr>
          </table>
        </a>
        <table class="ruledata">
          <tr>
            <th class="ruledata">Requirement:</th>
            <td class="ruledata">
              <span class="rulerequirement">The vCenter Server for Windows must configure the vSAN Datastore name to a unique name.</span>
            </td>
          </tr>
          <tr>
            <th class="ruledata">Discussion:</th>
            <td class="ruledata">A vSAN Datastore name by default is "vsanDatastore". If more than one vSAN cluster is present in vCenter both datastores will have the same name by default, potentially leading to confusion and manually misplaced workloads.</td>
          </tr>
          <tr>
            <th class="ruledata">Check:</th>
            <td class="ruledata">If no clusters are enabled for vSAN, this is not applicable.<br/>
<br/>
From the vSphere Web Client go to Host and Clusters &gt;&gt; Select a vSAN Enabled Cluster &gt;&gt; Datastores. Review the datastores. <br/>
<br/>
Identify any datastores with "vsan" as the datastore type.<br/>
<br/>
or<br/>
<br/>
From a PowerCLI command prompt while connected to the vCenter server run the following command:<br/>
If($(Get-Cluster | where {$_.VsanEnabled} | Measure).Count -gt 0){<br/>
Write-Host "vSAN Enabled Cluster found"<br/>
Get-Cluster | where {$_.VsanEnabled} | Get-Datastore | where {$_.type -match "vsan"}<br/>
}<br/>
else{<br/>
Write-Host "vSAN is not enabled, this finding is not applicable"<br/>
}<br/>
<br/>
If vSAN is Enabled and the datastore is named "vsanDatastore", this is a finding.</td>
          </tr>
          <tr>
            <th class="ruledata">Fix:</th>
            <td class="ruledata">From the vSphere Web Client go to Host and Clusters &gt;&gt; Select a vSAN Enabled Cluster &gt;&gt; Datastores. Right-click on the datastore named "vsanDatastore" and select "Rename". Rename the datastore based on operational naming standards.<br/>
<br/>
or<br/>
<br/>
From a PowerCLI command prompt while connected to the vCenter server run the following command:<br/>
If($(Get-Cluster | where {$_.VsanEnabled} | Measure).Count -gt 0){<br/>
Write-Host "vSAN Enabled Cluster found"<br/>
$Clusters = Get-Cluster | where {$_.VsanEnabled} <br/>
Foreach ($clus in $clusters){<br/>
 $clus | Get-Datastore | where {$_.type -match "vsan"} | Set-Datastore -Name $(($clus.name) + "_vSAN_Datastore")<br/>
}<br/>
}<br/>
else{<br/>
Write-Host "vSAN is not enabled, this finding is not applicable"<br/>
}</td>
          </tr>
          <tr>
            <th class="ruledata">References:</th>
            <td class="ruledata">
              <ul class="ruledata">
                <li>CCI-000366</li>
              </ul>
            </td>
          </tr>
        </table>
        <br/>
        <a name="RULE_SV-104645r1_rule">
          <table class="ruleblock">
            <tr class="ruleblock">
              <td class="ruleblock"><span class="ruleheader">STIG ID:</span><br/>VCWN-65-000056</td>
              <td class="ruleblock"><span class="ruleheader">Group ID:</span><br/>V-94815</td>
              <td class="ruleblock"><span class="ruleheader">Rule ID:</span><br/>SV-104645r1_rule</td>
              <td class="ruleblock"><span class="ruleheader">Severity:</span><br/>CAT II</td>
            </tr>
          </table>
        </a>
        <table class="ruledata">
          <tr>
            <th class="ruledata">Requirement:</th>
            <td class="ruledata">
              <span class="rulerequirement">The vCenter Server for Windows users must have the correct roles assigned.</span>
            </td>
          </tr>
          <tr>
            <th class="ruledata">Discussion:</th>
            <td class="ruledata">Users and service accounts must only be assigned privileges they require. Least Privilege requires that these privileges must only be assigned if needed, to reduce risk of confidentiality, availability or integrity loss.</td>
          </tr>
          <tr>
            <th class="ruledata">Check:</th>
            <td class="ruledata">From the vSphere Web Client go to Administration &gt;&gt; Access Control &gt;&gt; Roles.  <br/>
<br/>
View each role and verify the users and/or groups assigned to it.<br/>
<br/>
or<br/>
<br/>
From a PowerCLI command prompt while connected to the vCenter server run the following command:<br/>
Get-VIPermission | Sort Role | Select Role,Principal,Entity,Propagate,IsGroup | FT -Auto<br/>
<br/>
Application service account and user required privileges should be documented.<br/>
<br/>
If any user or service account has more privileges than required, this is a finding.</td>
          </tr>
          <tr>
            <th class="ruledata">Fix:</th>
            <td class="ruledata">To update a user or groups permissions to an existing role with reduced permissions do the following:<br/>
<br/>
From the vSphere Web Client go to Administration &gt;&gt; Access Control &gt;&gt; Global Permissions.  Select the user or group and click "Edit" and change the assigned role and click "OK".  If permissions are assigned on a specific object then the role must be updated where it is assigned for example at the cluster level.<br/>
<br/>
To create a new role with reduced permissions do the following:<br/>
<br/>
From the vSphere Web Client go to Administration &gt;&gt; Access Control &gt;&gt; Roles. Click the green plus sign and enter a name for the role and select only the specific permissions required.  Users can then be assigned to the newly created role.</td>
          </tr>
          <tr>
            <th class="ruledata">References:</th>
            <td class="ruledata">
              <ul class="ruledata">
                <li>CCI-000366</li>
              </ul>
            </td>
          </tr>
        </table>
        <br/>
        <a name="RULE_SV-104647r1_rule">
          <table class="ruleblock">
            <tr class="ruleblock">
              <td class="ruleblock"><span class="ruleheader">STIG ID:</span><br/>VCWN-65-000057</td>
              <td class="ruleblock"><span class="ruleheader">Group ID:</span><br/>V-94817</td>
              <td class="ruleblock"><span class="ruleheader">Rule ID:</span><br/>SV-104647r1_rule</td>
              <td class="ruleblock"><span class="ruleheader">Severity:</span><br/>CAT II</td>
            </tr>
          </table>
        </a>
        <table class="ruledata">
          <tr>
            <th class="ruledata">Requirement:</th>
            <td class="ruledata">
              <span class="rulerequirement">The vCenter Server for Windows must enable TLS 1.2 exclusively.</span>
            </td>
          </tr>
          <tr>
            <th class="ruledata">Discussion:</th>
            <td class="ruledata">TLS 1.0 and 1.1 are deprecated protocols with well published shortcomings and vulnerabilities. TLS 1.2 should be disabled on all interfaces and TLS 1.1 and 1.0 disabled where supported. Mandating TLS 1.2 may break third party integrations and add-ons to vSphere. Test these integrations carefully after implementing TLS 1.2 and roll back where appropriate. On interfaces where required functionality is broken with TLS 1.2 this finding is N/A until such time as the third party software supports TLS 1.2.<br/>
<br/>
Make sure you modify TLS settings in the following order: 1. Platform Services Controls (if applicable), 2. vCenter, 3. ESXi</td>
          </tr>
          <tr>
            <th class="ruledata">Check:</th>
            <td class="ruledata">Download the VMware TLS Reconfigurator utility from my.vmware.com. Follow installation instructions for your vCenter platform according to VMware KB 2147469.<br/>
<br/>
Appliance:<br/>
1. /usr/lib/vmware-vSphereTlsReconfigurator/VcTlsReconfigurator/reconfigureVc backup<br/>
2. /usr/lib/vmware-vSphereTlsReconfigurator/VcTlsReconfigurator/reconfigureVc scan<br/>
<br/>
Windows:<br/>
1. Open a command prompt and cd to C:\Program Files\VMware\CIS\vSphereTlsReconfigurator\VcTlsReconfigurator<br/>
2. Enter command "reconfigureVc scan" and press "Enter"<br/>
<br/>
If the output indicates versions of TLS other than 1.2 are enabled, this is a finding.</td>
          </tr>
          <tr>
            <th class="ruledata">Fix:</th>
            <td class="ruledata">Download the VMware TLS Reconfigurator utility from my.vmware.com. Follow installation instructions for your vCenter platform according to VMware KB 2147469. Run the following commands.<br/>
<br/>
Appliance:<br/>
1. /usr/lib/vmware-vSphereTlsReconfigurator/VcTlsReconfigurator/reconfigureVc backup<br/>
2. /usr/lib/vmware-vSphereTlsReconfigurator/VcTlsReconfigurator/reconfigureVc update -p TLS1.2<br/>
<br/>
Windows:<br/>
1. Open a command prompt and cd to C:\Program Files\VMware\CIS\vSphereTlsReconfigurator\VcTlsReconfigurator<br/>
2. Enter command "reconfigureVc backup" and press "Enter"<br/>
3. Enter command "reconfigureVc update -p TLS1.2" and press "Enter"<br/>
<br/>
vCenter services will be restarted as part of the reconfiguration, the OS will not be restarted. You can add the --no-restart flag to restart services at a later time. Changes will not take effect until all services are restarted or the machine is rebooted.</td>
          </tr>
          <tr>
            <th class="ruledata">References:</th>
            <td class="ruledata">
              <ul class="ruledata">
                <li>CCI-000366</li>
              </ul>
            </td>
          </tr>
        </table>
        <br/>
        <a name="RULE_SV-104649r1_rule">
          <table class="ruleblock">
            <tr class="ruleblock">
              <td class="ruleblock"><span class="ruleheader">STIG ID:</span><br/>VCWN-65-000058</td>
              <td class="ruleblock"><span class="ruleheader">Group ID:</span><br/>V-94819</td>
              <td class="ruleblock"><span class="ruleheader">Rule ID:</span><br/>SV-104649r1_rule</td>
              <td class="ruleblock"><span class="ruleheader">Severity:</span><br/>CAT II</td>
            </tr>
          </table>
        </a>
        <table class="ruledata">
          <tr>
            <th class="ruledata">Requirement:</th>
            <td class="ruledata">
              <span class="rulerequirement">The vCenter Server for Windows reverse proxy must use DoD approved certificates.</span>
            </td>
          </tr>
          <tr>
            <th class="ruledata">Discussion:</th>
            <td class="ruledata">The default self-signed, VMCA issued vCenter reverse proxy certificate must be replaced with a DoD approved certificate. The use of a DoD certificate on the vCenter reverse proxy assures clients that the service they are connecting to is legitimate and properly secured.</td>
          </tr>
          <tr>
            <th class="ruledata">Check:</th>
            <td class="ruledata">From the vCenter server (and external PSC if appropriate) run the following command<br/>
<br/>
Appliance:<br/>
/usr/lib/vmware-vmafd/bin/vecs-cli entry getcert --store machine_ssl_cert --alias __MACHINE_CERT --text|grep Issuer<br/>
<br/>
Windows:<br/>
"C:\Program Files\VMware\vCenter Server\vmafdd\vecs-cli.exe" entry getcert --store machine_ssl_cert --alias __MACHINE_CERT --text|find "Issuer"<br/>
<br/>
If the issuer is not a DoD approved certificate authority, this is a finding.</td>
          </tr>
          <tr>
            <th class="ruledata">Fix:</th>
            <td class="ruledata">Obtain a DoD issued certificate and private key for each vCenter and external PSC in the system, following the below requirements:<br/>
<br/>
Key size: 2048 bits or more (PEM encoded)<br/>
CRT format (Base-64)<br/>
x509 version 3<br/>
SubjectAltName must contain DNS Name=&lt;machine_FQDN&gt;<br/>
Contains the following Key Usages: Digital Signature, Non Repudiation, Key Encipherment<br/>
<br/>
Verify that the issued certificate includes the full issuing chain. If it does not, concatenate the Base-64 intermediates and root onto the issued machine ssl cert.<br/>
<br/>
Export the entire certificate issuing chain up to the root in Base-64 format, concatenate the individual certs into one file that will be used in the next steps when prompted for the signing certificate.<br/>
<br/>
Run the certificate-manager tool:<br/>
<br/>
Appliance:<br/>
/usr/lib/vmware-vmca/bin/certificate-manager<br/>
<br/>
Windows:<br/>
C:\Program Files\VMware\vCenter Server\vmcad\certificate-manager.bat<br/>
<br/>
Select option "1" to replace the machine ssl certificate. Select option "2" to specify existing certificate and private key. Supply the information as prompted remembering the signing certificate file built up previously.</td>
          </tr>
          <tr>
            <th class="ruledata">References:</th>
            <td class="ruledata">
              <ul class="ruledata">
                <li>CCI-000366</li>
              </ul>
            </td>
          </tr>
        </table>
        <br/>
        <a name="RULE_SV-104651r1_rule">
          <table class="ruleblock">
            <tr class="ruleblock">
              <td class="ruleblock"><span class="ruleheader">STIG ID:</span><br/>VCWN-65-000059</td>
              <td class="ruleblock"><span class="ruleheader">Group ID:</span><br/>V-94821</td>
              <td class="ruleblock"><span class="ruleheader">Rule ID:</span><br/>SV-104651r1_rule</td>
              <td class="ruleblock"><span class="ruleheader">Severity:</span><br/>CAT II</td>
            </tr>
          </table>
        </a>
        <table class="ruledata">
          <tr>
            <th class="ruledata">Requirement:</th>
            <td class="ruledata">
              <span class="rulerequirement">The vCenter Server for Windows must enable certificate based authentication.</span>
            </td>
          </tr>
          <tr>
            <th class="ruledata">Discussion:</th>
            <td class="ruledata">The vCenter 6.5 Web Client portal is capable of CAC authentication. This capability must be enabled and properly configured.</td>
          </tr>
          <tr>
            <th class="ruledata">Check:</th>
            <td class="ruledata">See supplemental document.<br/>
<br/>
Ensure CAC Authentication occurs upon login to vCenter.  Otherwise, this is a finding.</td>
          </tr>
          <tr>
            <th class="ruledata">Fix:</th>
            <td class="ruledata">Configure CAC Authentication per supplemental document.</td>
          </tr>
          <tr>
            <th class="ruledata">References:</th>
            <td class="ruledata">
              <ul class="ruledata">
                <li>CCI-000366</li>
              </ul>
            </td>
          </tr>
        </table>
        <br/>
        <a name="RULE_SV-104653r1_rule">
          <table class="ruleblock">
            <tr class="ruleblock">
              <td class="ruleblock"><span class="ruleheader">STIG ID:</span><br/>VCWN-65-000060</td>
              <td class="ruleblock"><span class="ruleheader">Group ID:</span><br/>V-94823</td>
              <td class="ruleblock"><span class="ruleheader">Rule ID:</span><br/>SV-104653r1_rule</td>
              <td class="ruleblock"><span class="ruleheader">Severity:</span><br/>CAT II</td>
            </tr>
          </table>
        </a>
        <table class="ruledata">
          <tr>
            <th class="ruledata">Requirement:</th>
            <td class="ruledata">
              <span class="rulerequirement">The vCenter Server for Windows must enable revocation checking for certificate based authentication.</span>
            </td>
          </tr>
          <tr>
            <th class="ruledata">Discussion:</th>
            <td class="ruledata">The system must establish the validity of the user supplied identity certificate using OCSP and/or CRL revocation checking.</td>
          </tr>
          <tr>
            <th class="ruledata">Check:</th>
            <td class="ruledata">1. Login to the Platform Services Controller web interface with administrator@vsphere.local from<br/>
<br/>
https://&lt;FQDN or IP of PSC&gt;/psc<br/>
<br/>
In an embedded deployment the Platform Services Controller host name or IP address is the same as the vCenter Server host name or IP address.<br/>
<br/>
If you specified a different SSO domain during installation, log in as administrator@&lt;mydomain&gt;.<br/>
<br/>
2. Browse to Single Sign-On &gt; Configuration.<br/>
<br/>
3. Click the "Smart Card Configuration" tab<br/>
<br/>
4. Click the "Certificate Revocation Settings" tab<br/>
<br/>
If "Revocation Check" does not show as enabled, this is a finding.</td>
          </tr>
          <tr>
            <th class="ruledata">Fix:</th>
            <td class="ruledata">1. Login to the Platform Services Controller web interface with administrator@vsphere.local from<br/>
<br/>
https://&lt;FQDN or IP of PSC&gt;/psc<br/>
<br/>
In an embedded deployment the Platform Services Controller host name or IP address is the same as the vCenter Server host name or IP address.<br/>
<br/>
If you specified a different SSO domain during installation, log in as administrator@&lt;mydomain&gt;.<br/>
<br/>
2. Browse to Single Sign-On &gt; Configuration.<br/>
<br/>
3. Click the "Smart Card Configuration" tab<br/>
<br/>
4. Click the "Certificate Revocation Settings" tab<br/>
<br/>
5. Click the "Enable Revocation Check" button<br/>
<br/>
By default the PSC will use the CRL from the certificate to check revocation check status. OCSP with CRL fallback is recommended but this setting is site specific and should be configured appropriately.</td>
          </tr>
          <tr>
            <th class="ruledata">References:</th>
            <td class="ruledata">
              <ul class="ruledata">
                <li>CCI-000366</li>
              </ul>
            </td>
          </tr>
        </table>
        <br/>
        <a name="RULE_SV-104655r1_rule">
          <table class="ruleblock">
            <tr class="ruleblock">
              <td class="ruleblock"><span class="ruleheader">STIG ID:</span><br/>VCWN-65-000061</td>
              <td class="ruleblock"><span class="ruleheader">Group ID:</span><br/>V-94825</td>
              <td class="ruleblock"><span class="ruleheader">Rule ID:</span><br/>SV-104655r1_rule</td>
              <td class="ruleblock"><span class="ruleheader">Severity:</span><br/>CAT III</td>
            </tr>
          </table>
        </a>
        <table class="ruledata">
          <tr>
            <th class="ruledata">Requirement:</th>
            <td class="ruledata">
              <span class="rulerequirement">The vCenter Server for Windows must disable Password and Windows integrated authentication.</span>
            </td>
          </tr>
          <tr>
            <th class="ruledata">Discussion:</th>
            <td class="ruledata">All forms of authentication other than CAC must be disabled. Password authentication can be temporarily re-enabled for emergency access to the local SSO domain accounts but it must be disable as soon as CAC authentication is functional.</td>
          </tr>
          <tr>
            <th class="ruledata">Check:</th>
            <td class="ruledata">1. Login to the Platform Services Controller web interface with administrator@vsphere.local from<br/>
<br/>
https://&lt;FQDN or IP of PSC&gt;/psc<br/>
<br/>
In an embedded deployment the Platform Services Controller host name or IP address is the same as the vCenter Server host name or IP address.<br/>
<br/>
If you specified a different SSO domain during installation, log in as administrator@&lt;mydomain&gt;.<br/>
<br/>
2. Browse to Single Sign-On &gt;&gt; Configuration.<br/>
<br/>
3. Click the "Smart Card Configuration" tab, click the "Edit" button next to “Authentication Configuration”.<br/>
<br/>
If the selection box next to “Password and Windows session authentication” is checked, this is a finding.</td>
          </tr>
          <tr>
            <th class="ruledata">Fix:</th>
            <td class="ruledata">1. Login to the Platform Services Controller web interface with administrator@vsphere.local from<br/>
<br/>
https://&lt;FQDN or IP of PSC&gt;/psc<br/>
<br/>
In an embedded deployment the Platform Services Controller host name or IP address is the same as the vCenter Server host name or IP address.<br/>
<br/>
If you specified a different SSO domain during installation, log in as administrator@&lt;mydomain&gt;.<br/>
<br/>
2. Browse to Single Sign-On &gt;&gt; Configuration.<br/>
<br/>
3. Click the "Smart Card Configuration" tab, click the "Edit" button next to “Authentication Configuration”.<br/>
<br/>
4. Check the box next to “Password and Windows session authentication”. Click "OK".<br/>
<br/>
To re-enable password authentication for troubleshooting run the following command from the PSC:<br/>
<br/>
/opt/vmware/bin/sso-config.sh -set_authn_policy -pwdAuthn true -winAuthn false -certAuthn false -securIDAuthn false -t vsphere.local</td>
          </tr>
          <tr>
            <th class="ruledata">References:</th>
            <td class="ruledata">
              <ul class="ruledata">
                <li>CCI-000366</li>
              </ul>
            </td>
          </tr>
        </table>
        <br/>
        <a name="RULE_SV-104657r1_rule">
          <table class="ruleblock">
            <tr class="ruleblock">
              <td class="ruleblock"><span class="ruleheader">STIG ID:</span><br/>VCWN-65-000062</td>
              <td class="ruleblock"><span class="ruleheader">Group ID:</span><br/>V-94827</td>
              <td class="ruleblock"><span class="ruleheader">Rule ID:</span><br/>SV-104657r1_rule</td>
              <td class="ruleblock"><span class="ruleheader">Severity:</span><br/>CAT III</td>
            </tr>
          </table>
        </a>
        <table class="ruledata">
          <tr>
            <th class="ruledata">Requirement:</th>
            <td class="ruledata">
              <span class="rulerequirement">The vCenter Server for Windows must enable Login banner for vSphere web client.</span>
            </td>
          </tr>
          <tr>
            <th class="ruledata">Discussion:</th>
            <td class="ruledata">The required legal notice must be configured for the vCenter web client.</td>
          </tr>
          <tr>
            <th class="ruledata">Check:</th>
            <td class="ruledata">1. Login to the Platform Services Controller web interface with administrator@vsphere.local from<br/>
<br/>
https://&lt;FQDN or IP of PSC&gt;/psc<br/>
<br/>
In an embedded deployment the Platform Services Controller host name or IP address is the same as the vCenter Server host name or IP address.<br/>
<br/>
If you specified a different SSO domain during installation, log in as administrator@&lt;mydomain&gt;.<br/>
<br/>
2. Browse to Single Sign-On &gt;&gt; Configuration.<br/>
<br/>
3. Click the "Login Banner" tab, click the "Edit" button.<br/>
<br/>
If selection boxes next to "Status" or "Checkbox Consent" are not checked or if the Message is not configured to the standard DoD User Agreement, this is a finding.<br/>
<br/>
Note: Supplementary Information: DoD Logon Banner<br/>
"You are accessing a U.S. Government (USG) Information System (IS) that is provided for USG-authorized use only.<br/>
By using this IS (which includes any device attached to this IS), you consent to the following conditions:<br/>
-The USG routinely intercepts and monitors communications on this IS for purposes including, but not limited to, penetration testing, COMSEC monitoring, network operations and defense, personnel misconduct (PM), law enforcement (LE), and counterintelligence (CI) investigations.<br/>
-At any time, the USG may inspect and seize data stored on this IS.<br/>
-Communications using, or data stored on, this IS are not private, are subject to routine monitoring, interception, and search, and may be disclosed or used for any USG-authorized purpose.<br/>
-This IS includes security measures (e.g., authentication and access controls) to protect USG interests--not for your personal benefit or privacy.<br/>
-Notwithstanding the above, using this IS does not constitute consent to PM, LE or CI investigative searching or monitoring of the content of privileged communications, or work product, related to personal representation or services by attorneys, psychotherapists, or clergy, and their assistants. Such communications and work product are private and confidential. See User Agreement for details."</td>
          </tr>
          <tr>
            <th class="ruledata">Fix:</th>
            <td class="ruledata">1. Login to the Platform Services Controller web interface with administrator@vsphere.local from<br/>
<br/>
https://&lt;FQDN or IP of PSC&gt;/psc<br/>
<br/>
In an embedded deployment the Platform Services Controller host name or IP address is the same as the vCenter Server host name or IP address.<br/>
<br/>
If you specified a different SSO domain during installation, log in as administrator@&lt;mydomain&gt;.<br/>
<br/>
2. Browse to Single Sign-On &gt;&gt; Configuration.<br/>
<br/>
3. Click the "Login Banner" tab, click the "Edit" button.<br/>
<br/>
4. Check the box next to "Status".<br/>
<br/>
5. Check the box next to "Checkbox Consent".<br/>
<br/>
6. Configure the Title and Message to the standard DoD User Agreement</td>
          </tr>
          <tr>
            <th class="ruledata">References:</th>
            <td class="ruledata">
              <ul class="ruledata">
                <li>CCI-000366</li>
              </ul>
            </td>
          </tr>
        </table>
        <br/>
        <a name="RULE_SV-104659r1_rule">
          <table class="ruleblock">
            <tr class="ruleblock">
              <td class="ruleblock"><span class="ruleheader">STIG ID:</span><br/>VCWN-65-000063</td>
              <td class="ruleblock"><span class="ruleheader">Group ID:</span><br/>V-94829</td>
              <td class="ruleblock"><span class="ruleheader">Rule ID:</span><br/>SV-104659r1_rule</td>
              <td class="ruleblock"><span class="ruleheader">Severity:</span><br/>CAT II</td>
            </tr>
          </table>
        </a>
        <table class="ruledata">
          <tr>
            <th class="ruledata">Requirement:</th>
            <td class="ruledata">
              <span class="rulerequirement">The vCenter Server for Windows must restrict access to cryptographic role.</span>
            </td>
          </tr>
          <tr>
            <th class="ruledata">Discussion:</th>
            <td class="ruledata">vSphere 6.5 modifies the built-in "Administrator" role to add permission to perform cryptographic operations such as KMS operations and encrypting and decrypting virtual machine disks.  This role must be reserved for cryptographic administrators where VM encryption and/or vSAN encryption is in use.  A new built-in role called "No Cryptography Administrator" has been added to provide all administrative permissions except cryptographic operations. Permissions must be restricted such that normal vSphere administrators are assigned the "No Cryptography Administrator" role or more restrictive. The "Administrator" role must be tightly controlled and must not be applied to administrators who will not be doing cryptographic work. Catastrophic data loss can result from a poorly administered cryptography.</td>
          </tr>
          <tr>
            <th class="ruledata">Check:</th>
            <td class="ruledata">From the vSphere Web Client go to Administration &gt;&gt; Access Control &gt;&gt; Roles<br/>
<br/>
or<br/>
<br/>
From a PowerCLI command prompt while connected to the vCenter server run the following command:<br/>
Get-VIPermission | Where {$_.Role -eq "Admin"} | Select Role,Principal,Entity,Propagate,IsGroup | FT -Auto<br/>
<br/>
If there are any users other than Solution Users with the "Administrator" role that are not explicitly designated for cryptographic operations, this is a finding. </td>
          </tr>
          <tr>
            <th class="ruledata">Fix:</th>
            <td class="ruledata">From the vSphere Web Client go to Administration &gt;&gt; Access Control &gt;&gt; Roles<br/>
<br/>
Move any accounts not explicitly designated for cryptographic operations, other than Solution Users, to other roles such as "No Cryptography Administrator".</td>
          </tr>
          <tr>
            <th class="ruledata">References:</th>
            <td class="ruledata">
              <ul class="ruledata">
                <li>CCI-000366</li>
              </ul>
            </td>
          </tr>
        </table>
        <br/>
        <a name="RULE_SV-104661r1_rule">
          <table class="ruleblock">
            <tr class="ruleblock">
              <td class="ruleblock"><span class="ruleheader">STIG ID:</span><br/>VCWN-65-000064</td>
              <td class="ruleblock"><span class="ruleheader">Group ID:</span><br/>V-94831</td>
              <td class="ruleblock"><span class="ruleheader">Rule ID:</span><br/>SV-104661r1_rule</td>
              <td class="ruleblock"><span class="ruleheader">Severity:</span><br/>CAT II</td>
            </tr>
          </table>
        </a>
        <table class="ruledata">
          <tr>
            <th class="ruledata">Requirement:</th>
            <td class="ruledata">
              <span class="rulerequirement">The vCenter Server for Windows must restrict access to cryptographic permissions.</span>
            </td>
          </tr>
          <tr>
            <th class="ruledata">Discussion:</th>
            <td class="ruledata">These permissions must be reserved for cryptographic administrators where VM encryption and/or vSAN encryption is in use. Catastrophic data loss can result from a poorly administered cryptography.</td>
          </tr>
          <tr>
            <th class="ruledata">Check:</th>
            <td class="ruledata">From the vSphere Web Client go to Administration &gt;&gt; Access Control &gt;&gt; Roles<br/>
<br/>
Highlight each role and click the pencil button if it is enabled. Verify that only the "Administrator" and any site-specific cryptographic group(s) have the following permissions:<br/>
<br/>
Cryptographic Operations privileges<br/>
Global.Diagnostics<br/>
Host.Inventory.Add host to cluster<br/>
Host.Inventory.Add standalone host<br/>
Host.Local operations.Manage user groups<br/>
<br/>
or<br/>
<br/>
From a PowerCLI command prompt while connected to the vCenter server run the following command:<br/>
$roles = Get-VIRole<br/>
ForEach($role in $roles){<br/>
    $privileges = $role.PrivilegeList<br/>
    If($privileges -match "Crypto*" -or $privileges -match "Global.Diagnostics" -or $privileges -match "Host.Inventory.Add*" -or $privileges -match "Host.Local operations.Manage user groups"){<br/>
    Write-Host "$role has Cryptographic privileges"<br/>
    }<br/>
}<br/>
<br/>
If any role other than "Administrator" or any site-specific group(s) have any of these permissions, this is a finding.</td>
          </tr>
          <tr>
            <th class="ruledata">Fix:</th>
            <td class="ruledata">From the vSphere Web Client go to Administration &gt;&gt; Access Control &gt;&gt; Roles<br/>
<br/>
Highlight each role and click the pencil button if it is enabled. Remove the following permissions from any group other than Administrator and any site-specific cryptographic group(s):<br/>
<br/>
Cryptographic Operations privileges<br/>
Global.Diagnostics<br/>
Host.Inventory.Add host to cluster<br/>
Host.Inventory.Add standalone host<br/>
Host.Local operations.Manage user groups</td>
          </tr>
          <tr>
            <th class="ruledata">References:</th>
            <td class="ruledata">
              <ul class="ruledata">
                <li>CCI-000366</li>
              </ul>
            </td>
          </tr>
        </table>
        <br/>
        <a name="RULE_SV-104663r1_rule">
          <table class="ruleblock">
            <tr class="ruleblock">
              <td class="ruleblock"><span class="ruleheader">STIG ID:</span><br/>VCWN-65-000065</td>
              <td class="ruleblock"><span class="ruleheader">Group ID:</span><br/>V-94833</td>
              <td class="ruleblock"><span class="ruleheader">Rule ID:</span><br/>SV-104663r1_rule</td>
              <td class="ruleblock"><span class="ruleheader">Severity:</span><br/>CAT III</td>
            </tr>
          </table>
        </a>
        <table class="ruledata">
          <tr>
            <th class="ruledata">Requirement:</th>
            <td class="ruledata">
              <span class="rulerequirement">The vCenter Server for Windows must have Mutual CHAP configured for vSAN iSCSI targets.</span>
            </td>
          </tr>
          <tr>
            <th class="ruledata">Discussion:</th>
            <td class="ruledata">When enabled vSphere performs bidirectional authentication of both the iSCSI target and host. There is a potential for a MitM attack when not authenticating both the iSCSI target and host in which an attacker might impersonate either side of the connection to steal data. Bidirectional authentication mitigates this risk.</td>
          </tr>
          <tr>
            <th class="ruledata">Check:</th>
            <td class="ruledata">If no clusters are enabled for vSAN or if vSAN is enabled but iSCSI is not enabled, this is not applicable.<br/>
<br/>
From the vSphere Web Client go to Host and Clusters &gt;&gt; Select a Cluster &gt;&gt; Configure &gt;&gt; Virtual SAN &gt;&gt; iSCSI Targets<br/>
<br/>
For each iSCSI Target select the item and click the pencil icon to open the edit dialog. <br/>
<br/>
If the Authentication method is not set to "Mutual CHAP" and fully configured, this is a finding.</td>
          </tr>
          <tr>
            <th class="ruledata">Fix:</th>
            <td class="ruledata">From the vSphere Web Client go to Host and Clusters &gt;&gt; Select a Cluster &gt;&gt; Configure &gt;&gt; Virtual SAN &gt;&gt; iSCSI Targets<br/>
<br/>
For each iSCSI Target select the item and click the pencil icon to open the edit dialog. Change the "Authentication" field to "Mutual CHAP" and configure the incoming and outgoing users and secrets appropriately.</td>
          </tr>
          <tr>
            <th class="ruledata">References:</th>
            <td class="ruledata">
              <ul class="ruledata">
                <li>CCI-000366</li>
              </ul>
            </td>
          </tr>
        </table>
        <br/>
        <a name="RULE_SV-104665r1_rule">
          <table class="ruleblock">
            <tr class="ruleblock">
              <td class="ruleblock"><span class="ruleheader">STIG ID:</span><br/>VCWN-65-000066</td>
              <td class="ruleblock"><span class="ruleheader">Group ID:</span><br/>V-94835</td>
              <td class="ruleblock"><span class="ruleheader">Rule ID:</span><br/>SV-104665r1_rule</td>
              <td class="ruleblock"><span class="ruleheader">Severity:</span><br/>CAT III</td>
            </tr>
          </table>
        </a>
        <table class="ruledata">
          <tr>
            <th class="ruledata">Requirement:</th>
            <td class="ruledata">
              <span class="rulerequirement">The vCenter Server for Windows must have new Key Encryption Keys (KEKs) re-issued at regular intervals for vSAN encrypted datastore(s).</span>
            </td>
          </tr>
          <tr>
            <th class="ruledata">Discussion:</th>
            <td class="ruledata">The Key Encryption Key (KEK) for a vSAN encrypted datastore is generated by the Key Management Server (KMS) and serves as a wrapper and lock around the Disk Encryption Key (DEK). The DEK is generated by the host and is used to encrypt and decrypt the datastore. A shallow re-key is a procedure in which the KMS issues a new KEK to the ESXi host which re-wraps the DEK but does not change the DEK or any data on disk. This operation must be done on a regular, site defined interval and can be viewed as similar in criticality to changing an administrative password. Should the KMS itself somehow be compromised, a standing operational procedure to re-key will put a time limit on the usefulness of any stolen KMS data.</td>
          </tr>
          <tr>
            <th class="ruledata">Check:</th>
            <td class="ruledata">Interview the SA to determine that a procedure has been put in place to perform a shallow re-key of all vSAN encrypted datastores at regular, site defined intervals.<br/>
<br/>
VMware recommends a 60-day re-key task but this interval must be defined by the SA and the ISSO.<br/>
<br/>
If vSAN encryption is not in use, this is not a finding.</td>
          </tr>
          <tr>
            <th class="ruledata">Fix:</th>
            <td class="ruledata">If vSAN encryption is in use, ensure that a regular re-key procedure is in place.</td>
          </tr>
          <tr>
            <th class="ruledata">References:</th>
            <td class="ruledata">
              <ul class="ruledata">
                <li>CCI-000366</li>
              </ul>
            </td>
          </tr>
        </table>
        <br/>
        <a name="RULE_SV-104667r1_rule">
          <table class="ruleblock">
            <tr class="ruleblock">
              <td class="ruleblock"><span class="ruleheader">STIG ID:</span><br/>VCWN-65-000067</td>
              <td class="ruleblock"><span class="ruleheader">Group ID:</span><br/>V-94837</td>
              <td class="ruleblock"><span class="ruleheader">Rule ID:</span><br/>SV-104667r1_rule</td>
              <td class="ruleblock"><span class="ruleheader">Severity:</span><br/>CAT III</td>
            </tr>
          </table>
        </a>
        <table class="ruledata">
          <tr>
            <th class="ruledata">Requirement:</th>
            <td class="ruledata">
              <span class="rulerequirement">The vCenter Server for Windows must disable the Customer Experience Improvement Program (CEIP).</span>
            </td>
          </tr>
          <tr>
            <th class="ruledata">Discussion:</th>
            <td class="ruledata">The VMware Customer Experience Improvement Program (CEIP) sends VMware anonymized system information that is used to improve the quality, reliability, and functionality of VMware products and services. For confidentiality purposes this feature must be disabled.</td>
          </tr>
          <tr>
            <th class="ruledata">Check:</th>
            <td class="ruledata">From the vSphere Web Client go to Administration &gt;&gt; Deployment &gt;&gt; Customer Experience Improvement Program<br/>
<br/>
If Customer Experience Improvement Program is Enabled, this is a finding.</td>
          </tr>
          <tr>
            <th class="ruledata">Fix:</th>
            <td class="ruledata">From the vSphere Web Client go to Administration &gt;&gt; Deployment &gt;&gt; Customer Experience Improvement Program<br/>
<br/>
Click the "Leave" button</td>
          </tr>
          <tr>
            <th class="ruledata">References:</th>
            <td class="ruledata">
              <ul class="ruledata">
                <li>CCI-000366</li>
              </ul>
            </td>
          </tr>
        </table>
        <br/>
        <a name="RULE_SV-104669r2_rule">
          <table class="ruleblock">
            <tr class="ruleblock">
              <td class="ruleblock"><span class="ruleheader">STIG ID:</span><br/>VCWN-65-000068</td>
              <td class="ruleblock"><span class="ruleheader">Group ID:</span><br/>V-94839</td>
              <td class="ruleblock"><span class="ruleheader">Rule ID:</span><br/>SV-104669r2_rule</td>
              <td class="ruleblock"><span class="ruleheader">Severity:</span><br/>CAT II</td>
            </tr>
          </table>
        </a>
        <table class="ruledata">
          <tr>
            <th class="ruledata">Requirement:</th>
            <td class="ruledata">
              <span class="rulerequirement">The vCenter Server for Windows must use LDAPS when adding an SSO identity source.</span>
            </td>
          </tr>
          <tr>
            <th class="ruledata">Discussion:</th>
            <td class="ruledata">LDAP (Lightweight Directory Access Protocol) is an industry standard protocol for querying directory services such as Active Directory. This protocol can operate in clear text or over an SSL/TLS encrypted tunnel. To protect confidentiality of LDAP communications the LDAPS option must be selected when adding an LDAP identity source in vSphere SSO.</td>
          </tr>
          <tr>
            <th class="ruledata">Check:</th>
            <td class="ruledata">Note: This requirement is applicable for Active Directory over LDAP connections and Not Applicable when the vCenter or PSC server is joined to AD and using integrated windows authentication.<br/>
<br/>
From the vSphere Web Client go to Administration &gt;&gt; Single Sign-On &gt;&gt; Configuration. <br/>
<br/>
Click the "Identity Sources" tab.<br/>
<br/>
For each identity source of type "Active Directory", highlight the item and click the pencil icon to open the edit dialog. <br/>
<br/>
If the LDAPs box at the bottom is not checked, this is a finding.</td>
          </tr>
          <tr>
            <th class="ruledata">Fix:</th>
            <td class="ruledata">From the vSphere Web Client go to Administration &gt;&gt; Single Sign-On &gt;&gt; Configuration. <br/>
<br/>
Click the "Identity Sources" tab.<br/>
<br/>
For each identity source of type "Active Directory" where LDAPS is not configured, highlight the item and click the pencil icon to open the edit dialog. Check the box at the bottom for LDAPS and click "Next". Click the green plus button to upload the trusted DC certificate or click the magnifying glass to extract the certificate from the DC directly. Click "Next". Click "Finish".</td>
          </tr>
          <tr>
            <th class="ruledata">References:</th>
            <td class="ruledata">
              <ul class="ruledata">
                <li>CCI-000366</li>
              </ul>
            </td>
          </tr>
        </table>
        <br/>
        <a name="RULE_SV-104671r2_rule">
          <table class="ruleblock">
            <tr class="ruleblock">
              <td class="ruleblock"><span class="ruleheader">STIG ID:</span><br/>VCWN-65-000069</td>
              <td class="ruleblock"><span class="ruleheader">Group ID:</span><br/>V-94841</td>
              <td class="ruleblock"><span class="ruleheader">Rule ID:</span><br/>SV-104671r2_rule</td>
              <td class="ruleblock"><span class="ruleheader">Severity:</span><br/>CAT II</td>
            </tr>
          </table>
        </a>
        <table class="ruledata">
          <tr>
            <th class="ruledata">Requirement:</th>
            <td class="ruledata">
              <span class="rulerequirement">The vCenter Server for Windows must use a limited privilege account when adding an LDAP identity source.</span>
            </td>
          </tr>
          <tr>
            <th class="ruledata">Discussion:</th>
            <td class="ruledata">When adding an LDAP identity source to vSphere SSO the account used to bind to AD must be minimally privileged. This account only requires read rights to the base DN specified. Any other permissions inside or outside of that OU are unnecessary and violate least privilege.</td>
          </tr>
          <tr>
            <th class="ruledata">Check:</th>
            <td class="ruledata">Note: This requirement is applicable for Active Directory over LDAP connections and Not Applicable when the vCenter or PSC server is joined to AD and using integrated windows authentication.<br/>
<br/>
From the vSphere Web Client go to Administration &gt;&gt; Single Sign-On &gt;&gt; Configuration. <br/>
<br/>
Click the "Identity Sources" tab.<br/>
<br/>
For each identity source with of type "Active Directory", highlight the item and click the pencil icon to open the edit dialog. <br/>
<br/>
If the account that is configured to bind to the LDAP server is not one with minimal privileges, this is a finding.</td>
          </tr>
          <tr>
            <th class="ruledata">Fix:</th>
            <td class="ruledata">From the vSphere Web Client go to Administration &gt;&gt; Single Sign-On &gt;&gt; Configuration. <br/>
<br/>
Click the "Identity Sources" tab.<br/>
<br/>
For each identity source that has been configured with a highly privileged AD account, highlight the item and click the pencil icon to open the edit dialog. Change the username and password to one with read only rights to the base DN and complete the dialog.</td>
          </tr>
          <tr>
            <th class="ruledata">References:</th>
            <td class="ruledata">
              <ul class="ruledata">
                <li>CCI-000366</li>
              </ul>
            </td>
          </tr>
        </table>
        <br/>
        <a name="RULE_SV-104683r1_rule">
          <table class="ruleblock">
            <tr class="ruleblock">
              <td class="ruleblock"><span class="ruleheader">STIG ID:</span><br/>VCWN-65-006000</td>
              <td class="ruleblock"><span class="ruleheader">Group ID:</span><br/>V-94853</td>
              <td class="ruleblock"><span class="ruleheader">Rule ID:</span><br/>SV-104683r1_rule</td>
              <td class="ruleblock"><span class="ruleheader">Severity:</span><br/>CAT II</td>
            </tr>
          </table>
        </a>
        <table class="ruledata">
          <tr>
            <th class="ruledata">Requirement:</th>
            <td class="ruledata">
              <span class="rulerequirement">The vCenter Server for Windows must disable SNMPv1.</span>
            </td>
          </tr>
          <tr>
            <th class="ruledata">Discussion:</th>
            <td class="ruledata">SNMPv3 supports commercial-grade security, including authentication, authorization, access control, and privacy while previous versions of the protocol contained well-known security weaknesses that were easily exploited. SNMPv3 can be configured for identification and cryptographically based authentication. <br/>
<br/>
SNMPv3 is not supported in vCenter Server for Windows.</td>
          </tr>
          <tr>
            <th class="ruledata">Check:</th>
            <td class="ruledata">NOTE: For the vCenter 6.5 Server Appliance, this requirement is Not Applicable.<br/>
<br/>
In the vSphere Web Client go to a vCenter Server instance.<br/>
Click the Configure tab &gt;&gt; Settings &gt;&gt; General.<br/>
On the vCenter Server Settings central pane, click Edit.<br/>
Click SNMP receivers to edit their settings.<br/>
Ensure no information for SNMP receivers are entered.  If there are SNMP receivers configured, this is a finding.</td>
          </tr>
          <tr>
            <th class="ruledata">Fix:</th>
            <td class="ruledata">In the vSphere Web Client go to a vCenter Server instance.<br/>
Click the Configure tab &gt;&gt; Settings &gt;&gt; General.<br/>
On the vCenter Server Settings central pane, click Edit.<br/>
Click SNMP receivers to edit their settings.<br/>
Remove any SNMP receivers that exist.</td>
          </tr>
          <tr>
            <th class="ruledata">References:</th>
            <td class="ruledata">
              <ul class="ruledata">
                <li>CCI-001967</li>
              </ul>
            </td>
          </tr>
        </table>
        <br/>
      </div>
    </div>
    <div class="footer headerfooter">UNCLASSIFIED</div>
  </body>
</html>
